/*!
 * {
 *   "buildtime": "2019-07-19 15:01:49",
 *   "workspace": "F:\\project\\x-book4\\js",
 *   "username": "Administrator",
 *   "hostname": "PC201608171616",
 *   "platform": "win32",
 *   "git": {
 *     "branch": "master",
 *     "hash": "b17f442a6",
 *     "message": [
 *       "commit b17f442a62eb78bc9ab78ffe68e3afb76c3e3548",
 *       "Author: YangZai <552396385@qq.com>",
 *       "Date:   Fri Jul 19 14:48:13 2019 +0800",
 *       "    xxxxxx"
 *     ],
 *     "user": "YangZai",
 *     "email": "552396385@qq.com",
 *     "remote": [
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (fetch)",
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (push)"
 *     ]
 *   }
 * }
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{1306:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getAllInfo=void 0;var a,r=c(i(5));e.getAllInfo=(a=function(t){return function(){var o=t.apply(this,arguments);return new Promise(function(n,s){return function e(t,i){try{var a=o[t](i),r=a.value}catch(t){return void s(t)}if(!a.done)return Promise.resolve(r).then(function(t){e("next",t)},function(t){e("throw",t)});n(r)}("next")})}}(r.default.mark(function t(e){var i;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i={},t.next=3,d({id:e}).then(function(t){return t.data});case 3:return i=t.sent,t.next=6,(0,s.getList)({course_id:e}).then(function(t){return t.data});case 6:return i.course_period_list=t.sent,t.next=9,(0,o.getList)({id:e}).then(function(t){return t.data});case 9:return i.examination_paper_list=t.sent,t.next=12,f({id:e}).then(function(t){return t.data});case 12:return i.price=t.sent,t.abrupt("return",i);case 14:case"end":return t.stop()}},t,this)})),function(t){return a.apply(this,arguments)});e.getList=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)(restUrl_publish+"/api/course",t)},e.save=function(t){var e=t.id,i=p(t,["id"]);if(e)return(0,n.request_put)(restUrl_publish+"/api/course/"+e,i);return(0,n.request_post)(restUrl_publish+"/api/course",i).then(function(t){return(0,l.createProListener)({res_id:t.data.id,res_type:t.data.type_name,res_name:t.data.name,res_cover:t.data.img_src,res_covers:"",res_exp:t.data.abs,res_author:"",res_author_id:"",res_Interpreter:"",res_Interpreter_id:"",res_lables:"",res_money:"",res_isbn:"",res_isbn_ext:""}),t})},e.getInfo=d,e.del=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)(restUrl_publish+"/api/course/delete",t)},e.urgentDigital=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_put)(restUrl_publish+"/api/course/urgent",t)},e.audits=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_put)(restUrl_publish+"/api/course/audits",t)},e.issuance=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.id,i=p(t,["id"]),a=u.default.compile(restUrl_publish+"/api/comproduct/:id/issuance");return(0,n.request_put)(a({id:e}),i).then(function(t){return(0,l.suance)({id:e,info:t.data}),t})},e.addGroup=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)(restUrl_publish+"/api/course/groups",t)},e.modifyGroup=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=u.default.compile(restUrl_publish+"/api/course/:id/groups");return(0,n.request_put)(e(t),t)},e.deleteGroup=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_delete)(restUrl_publish+"/api/course/groups/"+t.id[0],t)},e.listGroup=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)(restUrl_publish+"/api/course/groups",t)},e.moveGroup=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t.rel_id=t.id,delete t.id,(0,n.request_put)(restUrl_publish+"/api/groups/course",t)},e.getPrice=f,e.savePrice=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)(restUrl_publish+"/api/course/save_price",t)},e.keyword=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)(restUrl_publish+"/api/data_fast/key",t)},e.fastPlan=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)(restUrl_publish+"/api/course_period/teaching_plan/fast",t)},e.dataFast=function i(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)(restUrl_publish+"/api/course/audits/fast",a).then(function(t){return 2==t.data.data?new Promise(function(t,e){setTimeout(function(){t(i(a))},2e3)}):t})};var n=i(7),s=i(701),o=i(453),u=c(i(9)),l=(i(1024),i(85));function c(t){return t&&t.__esModule?t:{default:t}}function p(t,e){var i={};for(var a in t)0<=e.indexOf(a)||Object.prototype.hasOwnProperty.call(t,a)&&(i[a]=t[a]);return i}function d(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=u.default.compile(restUrl_publish+"/api/course/:id");return(0,n.request_get)(e(t))}function f(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=u.default.compile(restUrl_publish+"/api/course/setting_info/:id");return(0,n.request_get)(e(t))}},1307:function(t,e,i){"use strict";var a=i(905);i.n(a).a},1352:function(t,e,i){"use strict";function a(){var i=this,t=i.$createElement,a=i._self._c||t;return a("div",{staticClass:"index clearfix"},[a("Top",{attrs:{currentPlant:"X-PUBLISH"}}),a("Menu"),a("div",{staticClass:"mainRight"},[a("div",{staticClass:"contentWrap"},[a("div",{staticClass:"contentLeft"},[a("div",{staticClass:"maindata"},[a("div",{staticClass:"serachWrap"},[a("div",{staticClass:"title"}),a("form",{staticClass:"clearfix",attrs:{id:"mainForm"}},[a("span",{staticClass:"group-inline"},[a("el-input",{attrs:{placeholder:"课程名称",name:"name",clearable:""},model:{value:i.searchQuery.name,callback:function(t){i.$set(i.searchQuery,"name",t)},expression:"searchQuery.name"}})],1),a("span",{staticClass:"group-inline"},[a("TimePick",{attrs:{inputsName:["start_time","end_time"]}})],1),a("span",{staticClass:"group-inline"},[a("select",{staticClass:"form-control",staticStyle:{width:"110px"},attrs:{placeholder:"状态",name:"status"}},[a("option",{attrs:{value:""}},[i._v("审核状态")]),i._l(i.status,function(t,e){return a("option",{domProps:{value:e}},[i._v(i._s(t))])})],2)]),a("span",{staticClass:"group-inline"},[a("el-button",{attrs:{size:"mediu",type:"primary",icon:"el-icon-search",plain:""},on:{click:i.query}},[i._v("搜索")]),a("el-button",{attrs:{size:"mediu",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return i.opneDetailDialog("info")}}},[i._v("新建")])],1)])]),a("div",{staticClass:"tableWrap"},[a("div",{staticClass:"tableTop"},[a("div",{staticClass:"title vel-line"},[a("span",[i._v("全部 "),i.page?a("span",{staticClass:"totalNum"},[i._v("("+i._s(i.page.total)+")")]):i._e()]),a("div",{staticClass:"btns"},[a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return i.auditsPass()}}},[i._v("审核")]),a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:i.urgentDigital}},[i._v("加急审核")]),a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:i.moveToOther}},[i._v("移动分组")]),a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return i.delChoosen(!1)}}},[i._v("删除")])],1)])]),a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{staticClass:"allBtn"},[a("input",{attrs:{type:"checkbox"},on:{click:function(t){return i.checkAll(t)}}})]),a("th",[i._v("名称")]),a("th",[i._v("所属用户")]),a("th",{attrs:{width:"80"}},[i._v("审核状态")]),a("th",{attrs:{width:"70"}},[i._v("分发状态")]),a("th",{staticClass:"time"},[i._v("分发时间")]),a("th",{staticClass:"operate"},[i._v("操作")])])]),i.list?a("tbody",i._l(i.list,function(e){return a("tr",[a("td",[a("input",{ref:"ids",refInFor:!0,attrs:{type:"checkbox",name:"ids"},domProps:{value:e.id}})]),a("td",[a("img",{staticClass:"cover-photo",attrs:{src:e.img_src}}),a("div",{staticClass:"th-name bookName",attrs:{title:e.name}},[i._v(i._s(e.name))])]),a("td",[i._v(i._s(e.owner_name))]),a("td",{class:i.getColor(e.status)},[i._v(i._s(e.status))]),a("td",[i._v(i._s(e.release_status_name||"-"))]),a("td",[i._v(i._s(e.release_time||"-"))]),a("td",[a("div",{staticClass:"btns"},[a("Icon",{attrs:{size:"mini",title:"详情",type:"icon-detail",plain:""},on:{click:function(t){return i.opneDetailDialog("info",e)}}}),1!=e.audits_status?a("Icon",{attrs:{size:"mini",title:"审核",type:"icon-menu-publish",plain:""},on:{click:function(t){return i.auditsPass(e.id)}}}):i._e(),3==e.audits_status?a("Icon",{attrs:{size:"mini",title:"分发",type:"icon-fenfa",plain:""},on:{click:function(t){return i.opnePublishDialog(e)}}}):i._e(),1!=e.audits_status?a("Icon",{attrs:{size:"mini",title:"删除",type:"icon-delete",plain:""},on:{click:function(t){return i.delChoosen(e.id)}}}):i._e()],1)])])}),0):i._e()]),i.page?a("div",{staticClass:"pageWrap"},[a("el-pagination",{attrs:{small:!1,background:"","current-page":i.page.num,"page-sizes":[10,50,100],"page-size":i.page.offset,layout:"total, sizes,prev, pager, next, jumper",total:i.page.total},on:{"size-change":i.handleSizeChange,"current-change":i.handleCurrentChange}})],1):i._e()]),a("div",{staticClass:"gruopList"},[a("GroupList",{attrs:{groupList:i.groupList,currGroup:i.currGroup},on:{addGroup:i.addGroup,updateGroup:i.updateGroup,delGroup:i.delGroup,groupChange:i.groupChange}})],1)])])])]),a("div",{staticClass:"dialogs"},[a("Examine",{attrs:{examineDialog:i.examineDialog},on:{"update:examineDialog":function(t){i.examineDialog=t},"update:examine-dialog":function(t){i.examineDialog=t},saveExamine:i.saveExamine}}),i.publishDialog?a("Dispense",{attrs:{publishDialog:i.publishDialog,item:i.detailData},on:{"update:publishDialog":function(t){i.publishDialog=t},"update:publish-dialog":function(t){i.publishDialog=t},dispenseOk:i.dispenseOk}}):i._e(),a("el-dialog",{staticClass:"no-footer",attrs:{center:!1,visible:i.detailDialog,"close-on-click-modal":!1,top:"50px",width:"1200px"},on:{"update:visible":function(t){i.detailDialog=t},close:i.getList}},[a("div",{staticClass:"content",attrs:{slot:"title"},slot:"title"},[i.detailDialog?a("Detail",{attrs:{type:i.detailDialoaType,detailDialog:i.detailDialog,detailData:i.detailData,services:i.services,hourSever:i.hourSever,exerciseSever:i.exerciseSever,media:2,readOnly:i.readOnly},on:{saveok:i.saveOk,Knowledgeclick:i.KnowledgeClick,"update:detailDialog":function(t){i.detailDialog=t},"update:detail-dialog":function(t){i.detailDialog=t}}}):i._e()],1)]),a("el-dialog",{attrs:{center:!1,visible:i.moveToOtherDiaolog,"close-on-click-modal":!1,title:"移动分组",width:"500px"},on:{"update:visible":function(t){i.moveToOtherDiaolog=t}}},[a("div",{staticClass:"group"},[a("div",{staticClass:"label"},[i._v("移动到")]),a("select",{ref:"moveToId",staticClass:"form-control",attrs:{placeholder:"请选择"}},i._l(i.groupList,function(t,e){return t.id!=i.currGroup&&""!=t.id?a("option",{domProps:{value:t.id,textContent:i._s(t.name)}}):i._e()}),0)]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:function(t){i.moveToOtherDiaolog=!1}}},[i._v("返回")]),a("el-button",{attrs:{type:"primary"},on:{click:i.moveToSubmit}},[i._v(" 确定")])],1)])],1)],1)}var r=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return r})},356:function(t,e,i){"use strict";i.r(e);var a=i(1352),r=i(903);for(var n in r)"default"!==n&&function(t){i.d(e,t,function(){return r[t]})}(n);i(1307);var s=i(0),o=Object(s.a)(r.default,a.a,a.b,!1,null,"c39bca5a",null);e.default=o.exports},375:function(t,e,i){"use strict";i.r(e);var a=i(376),r=i.n(a);for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);e.default=r.a},376:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["groupList","currGroup"],data:function(){return{newGroupDialogOpen:!1,updateGroupDialogOpen:!1,currEditGroup:null}},created:function(){},computed:{},methods:{groupChange:function(t){this.$emit("groupChange",t)},addGroupDialog:function(){},delGroup:function(e){var i=this;this.$confirm("是否删除分组:"+e.name).then(function(t){dir(t),i.$emit("delGroup",e.id)}).catch(function(t){dir(t)})},updateGroupDialog:function(t){this.updateGroupDialogOpen=!0,this.currEditGroup=t},addGroup:function(){if(this.$refs.addGroupForm.valiAll()){var t=document.querySelector("#addGroupForm");this.$emit("addGroup",t),this.newGroupDialogOpen=!1}},updateGroup:function(){if(this.$refs.updateGroupForm.valiAll()){var t=document.querySelector("#updateGroupForm");this.$emit("updateGroup",t),this.updateGroupDialogOpen=!1}}}}},377:function(t,e,i){},384:function(t,e,i){"use strict";i.r(e);var a=i(386),r=i(375);for(var n in r)"default"!==n&&function(t){i.d(e,t,function(){return r[t]})}(n);i(385);var s=i(0),o=Object(s.a)(r.default,a.a,a.b,!1,null,"82bd0f98",null);e.default=o.exports},385:function(t,e,i){"use strict";var a=i(377);i.n(a).a},386:function(t,e,i){"use strict";function a(){var i=this,t=i.$createElement,a=i._self._c||t;return a("div",{staticClass:"div"},[a("div",{staticClass:"groupWrap"},[a("div",{staticClass:"list"},[a("ul",i._l(i.groupList,function(e){return a("li",{staticClass:"licontent",class:{red:e.id==i.currGroup}},[a("div",{staticClass:"name ellipsis",attrs:{title:e.name+"("+e.num+")"},on:{click:function(t){return i.groupChange(e.id)}}},[a("span",{staticClass:"title"},[i._v(i._s(e.name))]),a("span",[i._v(i._s("("+e.num+")"))])]),""!=e.id&&"non"!=e.id?a("div",{staticClass:"btns"},[a("span",{on:{click:function(t){return i.updateGroupDialog(e)}}},[a("i",{staticClass:"el-icon-edit"})]),a("span",{on:{click:function(t){return i.delGroup(e)}}},[a("i",{staticClass:"el-icon-delete"})])]):i._e()])}),0)]),a("div",{staticClass:"addGroupBtnWrap"},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){i.newGroupDialogOpen=!0}}},[a("i",{staticClass:"el-icon-plus"},[i._v("新建分组")])])],1)]),a("div",{staticClass:"dialogs"},[i.newGroupDialogOpen?a("el-dialog",{attrs:{title:"新增",visible:i.newGroupDialogOpen,width:"500px"},on:{"update:visible":function(t){i.newGroupDialogOpen=t}}},[a("div",{staticClass:"formWrap"},[a("VaForm",{ref:"addGroupForm"},[a("form",{attrs:{id:"addGroupForm"}},[a("div",{staticClass:"group"},[a("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"}],staticClass:"form-control",attrs:{name:"name"}})])])])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:function(t){i.newGroupDialogOpen=!1}}},[i._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:i.addGroup}},[i._v("确定")])],1)]):i._e(),i.updateGroupDialogOpen?a("el-dialog",{attrs:{title:"修改",visible:i.updateGroupDialogOpen,width:"500px"},on:{"update:visible":function(t){i.updateGroupDialogOpen=t}}},[a("div",{staticClass:"formWrap"},[a("VaForm",{ref:"updateGroupForm"},[i.currEditGroup?a("form",{attrs:{id:"updateGroupForm"}},[a("div",{staticClass:"group"},[a("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"}],staticClass:"form-control",attrs:{name:"name"},domProps:{value:i.currEditGroup.name}}),a("input",{staticClass:"hide",attrs:{name:"id"},domProps:{value:i.currEditGroup.id}})])]):i._e()])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:function(t){i.updateGroupDialogOpen=!1}}},[i._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:i.updateGroup}},[i._v("确定")])],1)]):i._e()],1)])}var r=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return r})},903:function(t,e,i){"use strict";i.r(e);var a=i(904),r=i.n(a);for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);e.default=r.a},904:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=m(i(5)),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t},r=m(i(84)),n=m(i(396)),s=m(i(158)),u=m(i(157)),l=m(i(384)),c=m(i(613)),p=m(i(421)),d=i(126),f=h(i(1306)),v=h(i(701)),g=h(i(453));function h(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function m(t){return t&&t.__esModule?t:{default:t}}e.default={mixins:[d.main],components:{Menu:s.default,Top:u.default,GroupList:l.default,Detail:c.default,Dispense:n.default},data:function(){return{services:f,hourSever:v,exerciseSever:g,list:null,page:null,groupList:null,detailDialog:!1,detailDialoaType:"info",detailData:{},publishDialog:!1,moveToOtherDiaolog:!1,moveIds:null,toId:null,status:p.default}},methods:{getList:function(t,e,i){var a=0<arguments.length&&void 0!==t?t:this.page&&this.page.num||1,r=this,n=1<arguments.length&&void 0!==e?e:this.page&&this.page.offset||10,s=2<arguments.length&&void 0!==i?i:null;f.getList(o({pageNum:a,pageOffset:n,group_id:this.currGroup},s)).then(function(t){r.list=t.data,r.page=t.page})},urgentDigital:function(){for(var e=this,t=this.getChecked(),i=0,a=t.length;i<a;i++)for(var r=0,n=this.list.length;r<n;r++)if(this.list[r].id==t[i]&&1!=this.list[r].audits_status)return void this.$message.error("只能勾选待审核数据");t&&this.services.urgentDigital({id:t}).then(function(t){return e.$message.success("已提交加急审核")})},opnePublishDialog:function(t){this.detailData=t,this.publishDialog=!0},delChoosens:function(t){var a=this,i=[];if(t)i.push(t);else{var e=Array.from(document.querySelectorAll('input[name="ids"]:checked'));if(e.forEach(function(t){i.push(t.value)}),!e.length)return void this.$message.error("请先选中!")}0<i.length&&this.$confirm("是否删除?").then(function(t){var e=(0,r.default)(document.querySelector("#mainForm"),{hash:!0});a.services.del({id:i}).then(function(t){a.getList(a.page.num,a.page.offset,e),a.getGroupList()}).catch(function(t){var e=t.payload;for(var i in e.messages){a.$message.error(e.messages[i]);break}})}).catch(function(t){})},KnowledgeClick:function(t){this.detailDialoaType=t},saveOk:function(t){this.detailData.id||(this.detailData=t),this.getList(),this.getGroupList()},clear:function(){document.getElementById("text").value=""},opneDetailDialog:function(t,e){var i=this;return function(t){return function(){var o=t.apply(this,arguments);return new Promise(function(n,s){return function e(t,i){try{var a=o[t](i),r=a.value}catch(t){return void s(t)}if(!a.done)return Promise.resolve(r).then(function(t){e("next",t)},function(t){e("throw",t)});n(r)}("next")})}}(a.default.mark(function t(){return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i.detailData={},e)return t.next=4,f.getAllInfo(e.id).then(function(t){i.readOnly=!(!e||1!=e.audits_status),i.detailData=t});t.next=4;break;case 4:i.detailDialog=!0;case 5:case"end":return t.stop()}},t,i)}))()}}}},905:function(t,e,i){}}]);