/*!
 * {
 *   "buildtime": "2019-07-19 15:01:49",
 *   "workspace": "F:\\project\\x-book4\\js",
 *   "username": "Administrator",
 *   "hostname": "PC201608171616",
 *   "platform": "win32",
 *   "git": {
 *     "branch": "master",
 *     "hash": "b17f442a6",
 *     "message": [
 *       "commit b17f442a62eb78bc9ab78ffe68e3afb76c3e3548",
 *       "Author: YangZai <552396385@qq.com>",
 *       "Date:   Fri Jul 19 14:48:13 2019 +0800",
 *       "    xxxxxx"
 *     ],
 *     "user": "YangZai",
 *     "email": "552396385@qq.com",
 *     "remote": [
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (fetch)",
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (push)"
 *     ]
 *   }
 * }
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{1333:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={};i.getData=function(t){return new Promise(function(e,o){var i={};(function(r){var s=null;return new Promise(function(e,t){if(r.src)if(/^data\:/i.test(r.src))s=function(t){t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var e=atob(t),o=e.length,i=new ArrayBuffer(o),r=new Uint8Array(i),s=0;s<o;s++)r[s]=e.charCodeAt(s);return i}(r.src),e(s);else if(/^blob\:/i.test(r.src)){var o=new FileReader;o.onload=function(t){s=t.target.result,e(s)},function(t,e){var o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="blob",o.onload=function(t){200!=this.status&&0!==this.status||e(this.response)},o.send()}(r.src,function(t){o.readAsArrayBuffer(t)})}else{var i=new XMLHttpRequest;i.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";s=i.response,e(s),i=null},i.open("GET",r.src,!0),i.responseType="arraybuffer",i.send(null)}else t("img error")})})(t).then(function(t){i.arrayBuffer=t,i.orientation=function(t){var e,o,i,r,s,n,c,a,h,p=new DataView(t),u=p.byteLength;if(255===p.getUint8(0)&&216===p.getUint8(1))for(a=2;a<u;){if(255===p.getUint8(a)&&225===p.getUint8(a+1)){n=a;break}a++}n&&(o=n+10,"Exif"===function(t,e,o){var i,r="";for(o+=i=e;i<o;i++)r+=String.fromCharCode(t.getUint8(i));return r}(p,n+4,4)&&(s=p.getUint16(o),((r=18761===s)||19789===s)&&42===p.getUint16(o+2,r)&&8<=(i=p.getUint32(o+4,r))&&(c=o+i)));if(c)for(u=p.getUint16(c,r),h=0;h<u;h++)if(a=c+12*h+2,274===p.getUint16(a,r)){a+=8,e=p.getUint16(a,r);break}return e}(t),e(i)}).catch(function(t){o(t)})})},e.default=i},1334:function(t,e,o){"use strict";var i=o(968);o.n(i).a},1413:function(t,e,o){"use strict";function i(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{ref:"cropper",staticClass:"vue-cropper",on:{mouseover:e.scaleImg,mouseout:e.cancelScale}},[o("div",{staticClass:"cropper-box"},[o("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"cropper-box-canvas",style:{width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+e.x/e.scale+"px,"+e.y/e.scale+"px,0)rotateZ("+90*e.rotate+"deg)"}},[o("img",{ref:"cropperImg",attrs:{src:e.imgs,alt:"cropper-img"}})])]),e._v(" "),o("div",{staticClass:"cropper-drag-box",class:{"cropper-move":e.move&&!e.crop,"cropper-crop":e.crop,"cropper-modal":e.cropping},on:{mousedown:e.startMove,touchstart:e.startMove}}),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.cropping,expression:"cropping"}],staticClass:"cropper-crop-box",style:{width:e.cropW+"px",height:e.cropH+"px",transform:"translate3d("+e.cropOffsertX+"px,"+e.cropOffsertY+"px,0)"}},[o("span",{staticClass:"cropper-view-box"},[o("img",{style:{width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+(e.x-e.cropOffsertX)/e.scale+"px,"+(e.y-e.cropOffsertY)/e.scale+"px,0)rotateZ("+90*e.rotate+"deg)"},attrs:{src:e.imgs,alt:"cropper-img"}})]),e._v(" "),o("span",{staticClass:"cropper-face cropper-move",on:{mousedown:e.cropMove,touchstart:e.cropMove}}),e._v(" "),e.info?o("span",{staticClass:"crop-info",style:{top:e.cropInfo.top}},[e._v("\n          "+e._s(this.cropInfo.width)+" Ã— "+e._s(this.cropInfo.height)+"\n        ")]):e._e(),e._v(" "),e.fixedBox?e._e():o("span",[o("span",{staticClass:"crop-line line-w",on:{mousedown:function(t){return e.changeCropSize(t,!1,!0,0,1)},touchstart:function(t){return e.changeCropSize(t,!1,!0,0,1)}}}),e._v(" "),o("span",{staticClass:"crop-line line-a",on:{mousedown:function(t){return e.changeCropSize(t,!0,!1,1,0)},touchstart:function(t){return e.changeCropSize(t,!0,!1,1,0)}}}),e._v(" "),o("span",{staticClass:"crop-line line-s",on:{mousedown:function(t){return e.changeCropSize(t,!1,!0,0,2)},touchstart:function(t){return e.changeCropSize(t,!1,!0,0,2)}}}),e._v(" "),o("span",{staticClass:"crop-line line-d",on:{mousedown:function(t){return e.changeCropSize(t,!0,!1,2,0)},touchstart:function(t){return e.changeCropSize(t,!0,!1,2,0)}}}),e._v(" "),o("span",{staticClass:"crop-point point1",on:{mousedown:function(t){return e.changeCropSize(t,!0,!0,1,1)},touchstart:function(t){return e.changeCropSize(t,!0,!0,1,1)}}}),e._v(" "),o("span",{staticClass:"crop-point point2",on:{mousedown:function(t){return e.changeCropSize(t,!1,!0,0,1)},touchstart:function(t){return e.changeCropSize(t,!1,!0,0,1)}}}),e._v(" "),o("span",{staticClass:"crop-point point3",on:{mousedown:function(t){return e.changeCropSize(t,!0,!0,2,1)},touchstart:function(t){return e.changeCropSize(t,!0,!0,2,1)}}}),e._v(" "),o("span",{staticClass:"crop-point point4",on:{mousedown:function(t){return e.changeCropSize(t,!0,!1,1,0)},touchstart:function(t){return e.changeCropSize(t,!0,!1,1,0)}}}),e._v(" "),o("span",{staticClass:"crop-point point5",on:{mousedown:function(t){return e.changeCropSize(t,!0,!1,2,0)},touchstart:function(t){return e.changeCropSize(t,!0,!1,2,0)}}}),e._v(" "),o("span",{staticClass:"crop-point point6",on:{mousedown:function(t){return e.changeCropSize(t,!0,!0,1,2)},touchstart:function(t){return e.changeCropSize(t,!0,!0,1,2)}}}),e._v(" "),o("span",{staticClass:"crop-point point7",on:{mousedown:function(t){return e.changeCropSize(t,!1,!0,0,2)},touchstart:function(t){return e.changeCropSize(t,!1,!0,0,2)}}}),e._v(" "),o("span",{staticClass:"crop-point point8",on:{mousedown:function(t){return e.changeCropSize(t,!0,!0,2,2)},touchstart:function(t){return e.changeCropSize(t,!0,!0,2,2)}}})])])])}var r=[];o.d(e,"a",function(){return i}),o.d(e,"b",function(){return r})},374:function(t,e,o){"use strict";o.r(e);var i=o(1413),r=o(966);for(var s in r)"default"!==s&&function(t){o.d(e,t,function(){return r[t]})}(s);o(1334);var n=o(0),c=Object(n.a)(r.default,i.a,i.b,!1,null,"b27c4d08",null);e.default=c.exports},966:function(t,e,o){"use strict";o.r(e);var i=o(967),r=o.n(i);for(var s in i)"default"!==s&&function(t){o.d(e,t,function(){return i[t]})}(s);e.default=r.a},967:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r=o(1333),n=(i=r)&&i.__esModule?i:{default:i};e.default={data:function(){return{w:0,h:0,scale:1,x:0,y:0,loading:!0,trueWidth:0,trueHeight:0,move:!0,moveX:0,moveY:0,crop:!1,cropping:!1,cropW:0,cropH:0,cropOldW:0,cropOldH:0,canChangeX:!1,canChangeY:!1,changeCropTypeX:1,changeCropTypeY:1,cropX:0,cropY:0,cropChangeX:0,cropChangeY:0,cropOffsertX:0,cropOffsertY:0,support:"",touches:[],touchNow:!1,rotate:0,isIos:!1,orientation:0,imgs:"",coe:.2,scaling:!1,scalingSet:"",coeStatus:"",isCanShow:!0}},props:{img:{type:[String,Blob,null,File],default:""},outputSize:{type:Number,default:1},outputType:{type:String,default:"jpeg"},info:{type:Boolean,default:!0},canScale:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!1},autoCropWidth:{type:[Number,String],default:0},autoCropHeight:{type:[Number,String],default:0},fixed:{type:Boolean,default:!1},fixedNumber:{type:Array,default:function(){return[1,1]}},fixedBox:{type:Boolean,default:!1},full:{type:Boolean,default:!1},canMove:{type:Boolean,default:!0},canMoveBox:{type:Boolean,default:!0},original:{type:Boolean,default:!1},centerBox:{type:Boolean,default:!1},high:{type:Boolean,default:!0},infoTrue:{type:Boolean,default:!1},maxImgSize:{type:Number,default:2e3},enlarge:{type:[Number,String],default:1},preW:{type:[Number,String],default:0},mode:{type:String,default:"contain"}},computed:{cropInfo:function(){var t={};if(t.top=21<this.cropOffsertY?"-21px":"0px",t.width=0<this.cropW?this.cropW:0,t.height=0<this.cropH?this.cropH:0,this.infoTrue){var e=1;this.high&&!this.full&&(e=window.devicePixelRatio),1!==this.enlarge&!this.full&&(e=Math.abs(Number(this.enlarge))),t.width=t.width*e,t.height=t.height*e,this.full&&(t.width=t.width/this.scale,t.height=t.height/this.scale)}return t.width=t.width.toFixed(0),t.height=t.height.toFixed(0),t},isIE:function(){var t=navigator.userAgent,e=-1<t.indexOf("compatible")&&-1<t.indexOf("MSIE");return e}},watch:{img:function(){this.checkedImg()},imgs:function(t){""!==t&&this.reload()},cropW:function(){this.showPreview()},cropH:function(){this.showPreview()},cropOffsertX:function(){this.showPreview()},cropOffsertY:function(){this.showPreview()},scale:function(t,e){this.showPreview()},x:function(){this.showPreview()},y:function(){this.showPreview()},autoCrop:function(t){t&&this.goAutoCrop()},autoCropWidth:function(){this.autoCrop&&this.goAutoCrop()},autoCropHeight:function(){this.autoCrop&&this.goAutoCrop()},mode:function(){this.checkedImg()},rotate:function(){this.showPreview(),this.autoCrop?this.goAutoCrop(this.cropW,this.cropH):(0<this.cropW||0<this.cropH)&&this.goAutoCrop(this.cropW,this.cropH)}},methods:{checkOrientationImage:function(t,e,o,i){var r=this,s=document.createElement("canvas"),n=s.getContext("2d");switch(n.save(),e){case 2:s.width=o,s.height=i,n.translate(o,0),n.scale(-1,1);break;case 3:s.width=o,s.height=i,n.translate(o/2,i/2),n.rotate(180*Math.PI/180),n.translate(-o/2,-i/2);break;case 4:s.width=o,s.height=i,n.translate(0,i),n.scale(1,-1);break;case 5:s.height=o,s.width=i,n.rotate(.5*Math.PI),n.scale(1,-1);break;case 6:s.width=i,s.height=o,n.translate(i/2,o/2),n.rotate(90*Math.PI/180),n.translate(-o/2,-i/2);break;case 7:s.height=o,s.width=i,n.rotate(.5*Math.PI),n.translate(o,-i),n.scale(-1,1);break;case 8:s.height=o,s.width=i,n.translate(i/2,o/2),n.rotate(-90*Math.PI/180),n.translate(-o/2,-i/2);break;default:s.width=o,s.height=i}n.drawImage(t,0,0,o,i),n.restore(),s.toBlob(function(t){var e=URL.createObjectURL(t);r.imgs=e},"image/"+this.outputType,1)},checkedImg:function(){var r=this;if(""!==this.img){this.loading=!0,this.scale=1,this.rotate=0,this.clearCrop();var s=new Image;if(s.onload=function(){if(""===r.img)return r.$emit("imgLoad","error"),!1;var o=s.width,i=s.height;n.default.getData(s).then(function(t){r.orientation=t.orientation||1;var e=r.maxImgSize;!r.orientation&&o<e&i<e?r.imgs=r.img:(e<o&&(i=i/o*e,o=e),e<i&&(o=o/i*e,i=e),r.checkOrientationImage(s,r.orientation,o,i))})},s.onerror=function(){r.$emit("imgLoad","error")},"data"!==this.img.substr(0,4)&&(s.crossOrigin=""),this.isIE){var t=new XMLHttpRequest;t.onload=function(){var t=URL.createObjectURL(this.response);s.src=t},t.open("GET",this.img,!0),t.responseType="blob",t.send()}else s.src=this.img}},startMove:function(t){if(t.preventDefault(),this.move&&!this.crop){if(!this.canMove)return!1;this.moveX=(t.clientX?t.clientX:t.touches[0].clientX)-this.x,this.moveY=(t.clientY?t.clientY:t.touches[0].clientY)-this.y,t.touches?(window.addEventListener("touchmove",this.moveImg),window.addEventListener("touchend",this.leaveImg),2==t.touches.length&&(this.touches=t.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale))):(window.addEventListener("mousemove",this.moveImg),window.addEventListener("mouseup",this.leaveImg)),this.$emit("imgMoving",{moving:!0,axis:this.getImgAxis()})}else this.cropping=!0,window.addEventListener("mousemove",this.createCrop),window.addEventListener("mouseup",this.endCrop),window.addEventListener("touchmove",this.createCrop),window.addEventListener("touchend",this.endCrop),this.cropOffsertX=t.offsetX?t.offsetX:t.touches[0].pageX-this.$refs.cropper.offsetLeft,this.cropOffsertY=t.offsetY?t.offsetY:t.touches[0].pageY-this.$refs.cropper.offsetTop,this.cropX=t.clientX?t.clientX:t.touches[0].clientX,this.cropY=t.clientY?t.clientY:t.touches[0].clientY,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.cropW=0,this.cropH=0},touchScale:function(t){var e=this;t.preventDefault();var o=this.scale,i=this.touches[0].clientX,r=this.touches[0].clientY,s=t.touches[0].clientX,n=t.touches[0].clientY,c=this.touches[1].clientX,a=this.touches[1].clientY,h=t.touches[1].clientX,p=t.touches[1].clientY,u=Math.sqrt(Math.pow(i-c,2)+Math.pow(r-a,2)),l=Math.sqrt(Math.pow(s-h,2)+Math.pow(n-p,2))-u,f=1,d=(f=.1<(f=f/this.trueWidth>f/this.trueHeight?f/this.trueHeight:f/this.trueWidth)?.1:f)*l;if(!this.touchNow){if(this.touchNow=!0,0<l?o+=Math.abs(d):l<0&&o>Math.abs(d)&&(o-=Math.abs(d)),this.touches=t.touches,setTimeout(function(){e.touchNow=!1},8),!this.checkoutImgAxis(this.x,this.y,o))return!1;this.scale=o}},cancelTouchScale:function(t){window.removeEventListener("touchmove",this.touchScale)},moveImg:function(t){var a=this;if(t.preventDefault(),t.touches&&2===t.touches.length)return this.touches=t.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale),window.removeEventListener("touchmove",this.moveImg),!1;var e=t.clientX?t.clientX:t.touches[0].clientX,o=t.clientY?t.clientY:t.touches[0].clientY,h=void 0,p=void 0;h=e-this.moveX,p=o-this.moveY,this.$nextTick(function(){if(a.centerBox){var t=a.getImgAxis(h,p,a.scale),e=a.getCropAxis(),o=a.trueHeight*a.scale,i=a.trueWidth*a.scale,r=void 0,s=void 0,n=void 0,c=void 0;switch(a.rotate){case 1:case-1:case 3:case-3:r=a.cropOffsertX-a.trueWidth*(1-a.scale)/2+(o-i)/2,s=a.cropOffsertY-a.trueHeight*(1-a.scale)/2+(i-o)/2,n=r-o+a.cropW,c=s-i+a.cropH;break;default:r=a.cropOffsertX-a.trueWidth*(1-a.scale)/2,s=a.cropOffsertY-a.trueHeight*(1-a.scale)/2,n=r-i+a.cropW,c=s-o+a.cropH}t.x1>=e.x1&&(h=r),t.y1>=e.y1&&(p=s),t.x2<=e.x2&&(h=n),t.y2<=e.y2&&(p=c)}a.x=h,a.y=p,a.$emit("imgMoving",{moving:!0,axis:a.getImgAxis()})})},leaveImg:function(t){window.removeEventListener("mousemove",this.moveImg),window.removeEventListener("touchmove",this.moveImg),window.removeEventListener("mouseup",this.leaveImg),window.removeEventListener("touchend",this.leaveImg),this.$emit("imgMoving",{moving:!1,axis:this.getImgAxis()})},scaleImg:function(){this.canScale&&window.addEventListener(this.support,this.changeSize)},cancelScale:function(){this.canScale&&window.removeEventListener(this.support,this.changeSize)},changeSize:function(t){var e=this;t.preventDefault();var o=this.scale,i=t.deltaY||t.wheelDelta;i=0<navigator.userAgent.indexOf("Firefox")?30*i:i,this.isIE&&(i=-i);var r=this.coe,s=(r=r/this.trueWidth>r/this.trueHeight?r/this.trueHeight:r/this.trueWidth)*i;s<0?o+=Math.abs(s):o>Math.abs(s)&&(o-=Math.abs(s));var n=s<0?"add":"reduce";if(n!==this.coeStatus&&(this.coeStatus=n,this.coe=.2),this.scaling||(this.scalingSet=setTimeout(function(){e.scaling=!1,e.coe=e.coe+=.01},50)),this.scaling=!0,!this.checkoutImgAxis(this.x,this.y,o))return!1;this.scale=o},changeScale:function(t){var e=this.scale;t=t||1;var o=20;if(0<(t*=o=o/this.trueWidth>o/this.trueHeight?o/this.trueHeight:o/this.trueWidth)?e+=Math.abs(t):e>Math.abs(t)&&(e-=Math.abs(t)),!this.checkoutImgAxis(this.x,this.y,e))return!1;this.scale=e},createCrop:function(t){var i=this;t.preventDefault();var r=t.clientX?t.clientX:t.touches?t.touches[0].clientX:0,s=t.clientY?t.clientY:t.touches?t.touches[0].clientY:0;this.$nextTick(function(){var t=r-i.cropX,e=s-i.cropY;if(0<t?(i.cropW=t+i.cropChangeX>i.w?i.w-i.cropChangeX:t,i.cropOffsertX=i.cropChangeX):(i.cropW=i.w-i.cropChangeX+Math.abs(t)>i.w?i.cropChangeX:Math.abs(t),i.cropOffsertX=0<i.cropChangeX+t?i.cropChangeX+t:0),i.fixed){var o=i.cropW/i.fixedNumber[0]*i.fixedNumber[1];o+i.cropOffsertY>i.h?(i.cropH=i.h-i.cropOffsertY,i.cropW=i.cropH/i.fixedNumber[1]*i.fixedNumber[0],i.cropOffsertX=0<t?i.cropChangeX:i.cropChangeX-i.cropW):i.cropH=o,i.cropOffsertY=i.cropOffsertY}else 0<e?(i.cropH=e+i.cropChangeY>i.h?i.h-i.cropChangeY:e,i.cropOffsertY=i.cropChangeY):(i.cropH=i.h-i.cropChangeY+Math.abs(e)>i.h?i.cropChangeY:Math.abs(e),i.cropOffsertY=0<i.cropChangeY+e?i.cropChangeY+e:0)})},changeCropSize:function(t,e,o,i,r){t.preventDefault(),window.addEventListener("mousemove",this.changeCropNow),window.addEventListener("mouseup",this.changeCropEnd),window.addEventListener("touchmove",this.changeCropNow),window.addEventListener("touchend",this.changeCropEnd),this.canChangeX=e,this.canChangeY=o,this.changeCropTypeX=i,this.changeCropTypeY=r,this.cropX=t.clientX?t.clientX:t.touches[0].clientX,this.cropY=t.clientY?t.clientY:t.touches[0].clientY,this.cropOldW=this.cropW,this.cropOldH=this.cropH,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.fixed&&this.canChangeX&&this.canChangeY&&(this.canChangeY=0)},changeCropNow:function(t){var r=this;t.preventDefault();var s=t.clientX?t.clientX:t.touches?t.touches[0].clientX:0,n=t.clientY?t.clientY:t.touches?t.touches[0].clientY:0,c=this.w,a=this.h,h=0,p=0;if(this.centerBox){var e=this.getImgAxis(),o=e.x2,i=e.y2;h=0<e.x1?e.x1:0,p=0<e.y1?e.y1:0,o<c&&(c=o),i<a&&(a=i)}this.$nextTick(function(){var t=s-r.cropX,e=n-r.cropY;if(r.canChangeX&&(1===r.changeCropTypeX?0<r.cropOldW-t?(r.cropW=c-r.cropChangeX-t<=c-h?r.cropOldW-t:r.cropOldW+r.cropChangeX-h,r.cropOffsertX=c-r.cropChangeX-t<=c-h?r.cropChangeX+t:h):(r.cropW=Math.abs(t)+r.cropChangeX<=c?Math.abs(t)-r.cropOldW:c-r.cropOldW-r.cropChangeX,r.cropOffsertX=r.cropChangeX+r.cropOldW):2===r.changeCropTypeX&&(0<r.cropOldW+t?(r.cropW=r.cropOldW+t+r.cropOffsertX<=c?r.cropOldW+t:c-r.cropOffsertX,r.cropOffsertX=r.cropChangeX):(r.cropW=c-r.cropChangeX+Math.abs(t+r.cropOldW)<=c-h?Math.abs(t+r.cropOldW):r.cropChangeX-h,r.cropOffsertX=c-r.cropChangeX+Math.abs(t+r.cropOldW)<=c-h?r.cropChangeX-Math.abs(t+r.cropOldW):h))),r.canChangeY&&(1===r.changeCropTypeY?0<r.cropOldH-e?(r.cropH=a-r.cropChangeY-e<=a-p?r.cropOldH-e:r.cropOldH+r.cropChangeY-p,r.cropOffsertY=a-r.cropChangeY-e<=a-p?r.cropChangeY+e:p):(r.cropH=Math.abs(e)+r.cropChangeY<=a?Math.abs(e)-r.cropOldH:a-r.cropOldH-r.cropChangeY,r.cropOffsertY=r.cropChangeY+r.cropOldH):2===r.changeCropTypeY&&(0<r.cropOldH+e?(r.cropH=r.cropOldH+e+r.cropOffsertY<=a?r.cropOldH+e:a-r.cropOffsertY,r.cropOffsertY=r.cropChangeY):(r.cropH=a-r.cropChangeY+Math.abs(e+r.cropOldH)<=a-p?Math.abs(e+r.cropOldH):r.cropChangeY-p,r.cropOffsertY=a-r.cropChangeY+Math.abs(e+r.cropOldH)<=a-p?r.cropChangeY-Math.abs(e+r.cropOldH):p))),r.canChangeX&&r.fixed){var o=r.cropW/r.fixedNumber[0]*r.fixedNumber[1];o+r.cropOffsertY>a?(r.cropH=a-r.cropOffsertY,r.cropW=r.cropH/r.fixedNumber[1]*r.fixedNumber[0]):r.cropH=o}if(r.canChangeY&&r.fixed){var i=r.cropH/r.fixedNumber[1]*r.fixedNumber[0];i+r.cropOffsertX>c?(r.cropW=c-r.cropOffsertX,r.cropH=r.cropW/r.fixedNumber[0]*r.fixedNumber[1]):r.cropW=i}})},changeCropEnd:function(t){window.removeEventListener("mousemove",this.changeCropNow),window.removeEventListener("mouseup",this.changeCropEnd),window.removeEventListener("touchmove",this.changeCropNow),window.removeEventListener("touchend",this.changeCropEnd)},endCrop:function(){0===this.cropW&&0===this.cropH&&(this.cropping=!1),window.removeEventListener("mousemove",this.createCrop),window.removeEventListener("mouseup",this.endCrop),window.removeEventListener("touchmove",this.createCrop),window.removeEventListener("touchend",this.endCrop)},startCrop:function(){this.crop=!0},stopCrop:function(){this.crop=!1},clearCrop:function(){this.cropping=!1,this.cropW=0,this.cropH=0},cropMove:function(t){if(t.preventDefault(),!this.canMoveBox)return this.crop=!1,this.startMove(t),!1;if(t.touches&&2===t.touches.length)return this.crop=!1,this.startMove(t),this.leaveCrop(),!1;window.addEventListener("mousemove",this.moveCrop),window.addEventListener("mouseup",this.leaveCrop),window.addEventListener("touchmove",this.moveCrop),window.addEventListener("touchend",this.leaveCrop);var e,o,i=t.clientX?t.clientX:t.touches[0].clientX,r=t.clientY?t.clientY:t.touches[0].clientY;e=i-this.cropOffsertX,o=r-this.cropOffsertY,this.cropX=e,this.cropY=o,this.$emit("cropMoving",{moving:!0,axis:this.getCropAxis()})},moveCrop:function(t,s){var n=this,c=0,a=0;t&&(t.preventDefault(),c=t.clientX?t.clientX:t.touches[0].clientX,a=t.clientY?t.clientY:t.touches[0].clientY),this.$nextTick(function(){var t=void 0,e=void 0,o=c-n.cropX,i=a-n.cropY;if(s&&(o=n.cropOffsertX,i=n.cropOffsertY),t=o<=0?0:o+n.cropW>n.w?n.w-n.cropW:o,e=i<=0?0:i+n.cropH>n.h?n.h-n.cropH:i,n.centerBox){var r=n.getImgAxis();t<=r.x1&&(t=r.x1),t+n.cropW>r.x2&&(t=r.x2-n.cropW),e<=r.y1&&(e=r.y1),e+n.cropH>r.y2&&(e=r.y2-n.cropH)}n.cropOffsertX=t,n.cropOffsertY=e,n.$emit("cropMoving",{moving:!0,axis:n.getCropAxis()})})},getImgAxis:function(t,e,o){t=t||this.x,e=e||this.y,o=o||this.scale;var i={x1:0,x2:0,y1:0,y2:0},r=this.trueWidth*o,s=this.trueHeight*o;switch(this.rotate){case 0:i.x1=t+this.trueWidth*(1-o)/2,i.x2=i.x1+this.trueWidth*o,i.y1=e+this.trueHeight*(1-o)/2,i.y2=i.y1+this.trueHeight*o;break;case 1:case-1:case 3:case-3:i.x1=t+this.trueWidth*(1-o)/2+(r-s)/2,i.x2=i.x1+this.trueHeight*o,i.y1=e+this.trueHeight*(1-o)/2+(s-r)/2,i.y2=i.y1+this.trueWidth*o;break;default:i.x1=t+this.trueWidth*(1-o)/2,i.x2=i.x1+this.trueWidth*o,i.y1=e+this.trueHeight*(1-o)/2,i.y2=i.y1+this.trueHeight*o}return i},getCropAxis:function(){var t={x1:0,x2:0,y1:0,y2:0};return t.x1=this.cropOffsertX,t.x2=t.x1+this.cropW,t.y1=this.cropOffsertY,t.y2=t.y1+this.cropH,t},leaveCrop:function(t){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop),this.$emit("cropMoving",{moving:!1,axis:this.getCropAxis()})},getCropChecked:function(u){var l=this,f=document.createElement("canvas"),d=new Image,g=this.rotate,v=this.trueWidth,m=this.trueHeight,w=this.cropOffsertX,C=this.cropOffsertY;function x(t,e){f.width=Math.round(t),f.height=Math.round(e)}d.onload=function(){if(0!==l.cropW){var t=f.getContext("2d"),e=1;l.high&!l.full&&(e=window.devicePixelRatio),1!==l.enlarge&!l.full&&(e=Math.abs(Number(l.enlarge)));var o=l.cropW*e,i=l.cropH*e,r=v*l.scale*e,s=m*l.scale*e,n=(l.x-w+l.trueWidth*(1-l.scale)/2)*e,c=(l.y-C+l.trueHeight*(1-l.scale)/2)*e;switch(x(o,i),t.save(),g){case 0:l.full?(x(o/l.scale,i/l.scale),t.drawImage(d,n/l.scale,c/l.scale,r/l.scale,s/l.scale)):t.drawImage(d,n,c,r,s);break;case 1:case-3:l.full?(x(o/l.scale,i/l.scale),n=n/l.scale+(r/l.scale-s/l.scale)/2,c=c/l.scale+(s/l.scale-r/l.scale)/2,t.rotate(90*g*Math.PI/180),t.drawImage(d,c,-n-s/l.scale,r/l.scale,s/l.scale)):(n+=(r-s)/2,c+=(s-r)/2,t.rotate(90*g*Math.PI/180),t.drawImage(d,c,-n-s,r,s));break;case 2:case-2:l.full?(x(o/l.scale,i/l.scale),t.rotate(90*g*Math.PI/180),n/=l.scale,c/=l.scale,t.drawImage(d,-n-r/l.scale,-c-s/l.scale,r/l.scale,s/l.scale)):(t.rotate(90*g*Math.PI/180),t.drawImage(d,-n-r,-c-s,r,s));break;case 3:case-1:l.full?(x(o/l.scale,i/l.scale),n=n/l.scale+(r/l.scale-s/l.scale)/2,c=c/l.scale+(s/l.scale-r/l.scale)/2,t.rotate(90*g*Math.PI/180),t.drawImage(d,-c-r/l.scale,n,r/l.scale,s/l.scale)):(n+=(r-s)/2,c+=(s-r)/2,t.rotate(90*g*Math.PI/180),t.drawImage(d,-c-r,n,r,s));break;default:l.full?(x(o/l.scale,i/l.scale),t.drawImage(d,n/l.scale,c/l.scale,r/l.scale,s/l.scale)):t.drawImage(d,n,c,r,s)}t.restore()}else{var a=v*l.scale,h=m*l.scale,p=f.getContext("2d");switch(p.save(),g){case 0:x(a,h),p.drawImage(d,0,0,a,h);break;case 1:case-3:x(h,a),p.rotate(90*g*Math.PI/180),p.drawImage(d,0,-h,a,h);break;case 2:case-2:x(a,h),p.rotate(90*g*Math.PI/180),p.drawImage(d,-a,-h,a,h);break;case 3:case-1:x(h,a),p.rotate(90*g*Math.PI/180),p.drawImage(d,-a,0,a,h);break;default:x(a,h),p.drawImage(d,0,0,a,h)}p.restore()}u(f)},"data"!==this.img.substr(0,4)&&(d.crossOrigin="Anonymous"),d.src=this.imgs},getCropData:function(e){var o=this;this.getCropChecked(function(t){e(t.toDataURL("image/"+o.outputType,o.outputSize))})},getCropBlob:function(e){var o=this;this.getCropChecked(function(t){t.toBlob(function(t){return e(t)},"image/"+o.outputType,o.outputSize)})},showPreview:function(){var t=this;if(!this.isCanShow)return!1;this.isCanShow=!1,setTimeout(function(){t.isCanShow=!0},16);var e=this.cropW,o=this.cropH,i=this.scale,r={};r.div={width:e+"px",height:o+"px"};var s=(this.x-this.cropOffsertX)/i,n=(this.y-this.cropOffsertY)/i;r.w=e,r.h=o,r.url=this.imgs,r.img={width:this.trueWidth+"px",height:this.trueHeight+"px",transform:"scale("+i+")translate3d("+s+"px, "+n+"px, 0px)rotateZ("+90*this.rotate+"deg)"},r.html='\n      <div class="show-preview" style="width: '+r.w+"px; height: "+r.h+'px,; overflow: hidden">\n        <div style="width: '+e+"px; height: "+o+'px">\n          <img src='+r.url+' style="width: '+this.trueWidth+"px; height: "+this.trueHeight+"px; transform:\n          scale("+i+")translate3d("+s+"px, "+n+"px, 0px)rotateZ("+90*this.rotate+'deg)">\n        </div>\n      </div>',this.$emit("realTime",r)},reload:function(){var t=this,e=new Image;e.onload=function(){t.w=parseFloat(window.getComputedStyle(t.$refs.cropper).width),t.h=parseFloat(window.getComputedStyle(t.$refs.cropper).height),t.trueWidth=e.width,t.trueHeight=e.height,t.original?t.scale=1:t.scale=t.checkedMode(),t.$nextTick(function(){t.x=-(t.trueWidth-t.trueWidth*t.scale)/2+(t.w-t.trueWidth*t.scale)/2,t.y=-(t.trueHeight-t.trueHeight*t.scale)/2+(t.h-t.trueHeight*t.scale)/2,t.loading=!1,t.autoCrop&&t.goAutoCrop(),t.$emit("imgLoad","success"),setTimeout(function(){t.showPreview()},20)})},e.onerror=function(){t.$emit("imgLoad","error")},e.src=this.imgs},checkedMode:function(){var e=1,t=(this.trueWidth,this.trueHeight),o=this.mode.split(" ");switch(o[0]){case"contain":this.trueWidth>this.w&&(e=this.w/this.trueWidth),this.trueHeight*e>this.h&&(e=this.h/this.trueHeight);break;case"cover":(t*=e=this.w/this.trueWidth)<this.h&&(e=(t=this.h)/this.trueHeight);break;default:try{var i=o[0];if(-1!==i.search("px")&&(i=i.replace("px",""),e=parseFloat(i)/this.trueWidth),-1!==i.search("%")&&(i=i.replace("%",""),e=parseFloat(i)/100*this.w/this.trueWidth),2===o.length&&"auto"===i){var r=o[1];-1!==r.search("px")&&(r=r.replace("px",""),e=(t=parseFloat(r))/this.trueHeight),-1!==r.search("%")&&(r=r.replace("%",""),e=(t=parseFloat(r)/100*this.h)/this.trueHeight)}}catch(t){e=1}}return e},goAutoCrop:function(t,e){this.clearCrop(),this.cropping=!0;var o=this.w,i=this.h;if(this.centerBox){var r=this.trueWidth*this.scale,s=this.trueHeight*this.scale;o=r<o?r:o,i=s<i?s:i}var n=t||parseFloat(this.autoCropWidth),c=e||parseFloat(this.autoCropHeight);0!==n&&0!==c||(n=.8*o,c=.8*i),n=o<n?o:n,c=i<c?i:c,this.fixed&&(c=n/this.fixedNumber[0]*this.fixedNumber[1]),c>this.h&&(n=(c=this.h)/this.fixedNumber[1]*this.fixedNumber[0]),this.changeCrop(n,c)},changeCrop:function(t,e){var o=this;this.cropW=t,this.cropH=e,this.cropOffsertX=(this.w-t)/2,this.cropOffsertY=(this.h-e)/2,this.centerBox&&this.$nextTick(function(){o.moveCrop(null,!0)})},refresh:function(){var t=this;this.img;this.imgs="",this.scale=1,this.crop=!1,this.rotate=0,this.w=0,this.h=0,this.trueWidth=0,this.trueHeight=0,this.clearCrop(),this.$nextTick(function(){t.checkedImg()})},rotateLeft:function(){this.rotate=this.rotate<=-3?0:this.rotate-1},rotateRight:function(){this.rotate=3<=this.rotate?0:this.rotate+1},rotateClear:function(){this.rotate=0},checkoutImgAxis:function(t,e,o){t=t||this.x,e=e||this.y,o=o||this.scale;var i=!0;if(this.centerBox){var r=this.getImgAxis(t,e,o),s=this.getCropAxis();r.x1>=s.x1&&(i=!1),r.x2<=s.x2&&(i=!1),r.y1>=s.y1&&(i=!1),r.y2<=s.y2&&(i=!1)}return i}},mounted:function(){this.support="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";var c=this,t=navigator.userAgent;this.isIOS=!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,o){for(var i=atob(this.toDataURL(e,o).split(",")[1]),r=i.length,s=new Uint8Array(r),n=0;n<r;n++)s[n]=i.charCodeAt(n);t(new Blob([s],{type:c.type||"image/png"}))}}),this.showPreview(),this.checkedImg()},destroyed:function(){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop)}}},968:function(t,e,o){}}]);