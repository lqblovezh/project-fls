/*!
 * {
 *   "buildtime": "2019-07-19 15:01:49",
 *   "workspace": "F:\\project\\x-book4\\js",
 *   "username": "Administrator",
 *   "hostname": "PC201608171616",
 *   "platform": "win32",
 *   "git": {
 *     "branch": "master",
 *     "hash": "b17f442a6",
 *     "message": [
 *       "commit b17f442a62eb78bc9ab78ffe68e3afb76c3e3548",
 *       "Author: YangZai <552396385@qq.com>",
 *       "Date:   Fri Jul 19 14:48:13 2019 +0800",
 *       "    xxxxxx"
 *     ],
 *     "user": "YangZai",
 *     "email": "552396385@qq.com",
 *     "remote": [
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (fetch)",
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (push)"
 *     ]
 *   }
 * }
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{1158:function(t,e,a){"use strict";a.r(e);var i=a(1405),n=a(736);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a(1160);var l=a(0),s=Object(l.a)(n.default,i.a,i.b,!1,null,"713be441",null);e.default=s.exports},1159:function(t){t.exports=JSON.parse('{"status":true,"msg":"","data":[{"id":"17","name":"历史文献学","parent_id":"9"},{"id":"52","name":"世界古代通史","parent_id":"51"},{"id":"50","name":"世界史学理论与史学史","parent_id":"15"},{"id":"63","name":"世界近现代通史","parent_id":"62"},{"id":"19","name":"先秦史","parent_id":"18"},{"id":"16","name":"史学理论及中国史学史","parent_id":"10"},{"id":"15","name":"世界史学理论与史学史","parent_id":"5"},{"id":"48","name":"鸦片战争至辛亥革命史","parent_id":"30"},{"id":"47","name":"中国现代史","parent_id":"35"},{"id":"81","name":"一带一路研究","parent_id":"80"},{"id":"38","name":"思想史","parent_id":"37"},{"id":"96","name":"古代史-下册","parent_id":"91"},{"id":"51","name":"世界古代中古史","parent_id":"5"},{"id":"39","name":"文化史","parent_id":"37"},{"id":"49","name":"中华民国史","parent_id":"30"},{"id":"20","name":"秦汉史","parent_id":"18"},{"id":"64","name":"日本史","parent_id":"62"},{"id":"82","name":"全球史","parent_id":"80"},{"id":"53","name":"欧洲古代史","parent_id":"51"},{"id":"65","name":"南亚史","parent_id":"62"},{"id":"33","name":"中国共产党史","parent_id":"30"},{"id":"40","name":"科技史","parent_id":"37"},{"id":"92","name":"历史","parent_id":"6"},{"id":"62","name":"世界近现代史","parent_id":"5"},{"id":"22","name":"魏晋南北朝史","parent_id":"18"},{"id":"54","name":"中东近东北非的古代史","parent_id":"51"},{"id":"83","name":"环境史","parent_id":"80"},{"id":"84","name":"思想史","parent_id":"80"},{"id":"80","name":"专门史","parent_id":"5"},{"id":"66","name":"中亚史","parent_id":"62"},{"id":"55","name":"亚洲古代史","parent_id":"51"},{"id":"3","name":"年度报告","parent_id":"0"},{"id":"41","name":"社会史","parent_id":"37"},{"id":"7","name":"政法","parent_id":"6"},{"id":"21","name":"隋唐五代十国史","parent_id":"18"},{"id":"34","name":"中国近代通史","parent_id":"30"},{"id":"8","name":"历史地理学","parent_id":"4"},{"id":"23","name":"宋史","parent_id":"18"},{"id":"67","name":"西亚史","parent_id":"62"},{"id":"9","name":"历史文献学","parent_id":"4"},{"id":"42","name":"城市史","parent_id":"37"},{"id":"85","name":"文化史","parent_id":"80"},{"id":"56","name":"美洲古代中古史","parent_id":"51"},{"id":"4","name":"中国史","parent_id":"3"},{"id":"97","name":"经济","parent_id":"6"},{"id":"5","name":"世界史","parent_id":"3"},{"id":"98","name":"哲学","parent_id":"6"},{"id":"68","name":"非洲史","parent_id":"62"},{"id":"43","name":"中外文化交流史","parent_id":"37"},{"id":"57","name":"非洲古代中古史","parent_id":"51"},{"id":"24","name":"辽金史","parent_id":"18"},{"id":"86","name":"科技史","parent_id":"80"},{"id":"69","name":"美国史","parent_id":"62"},{"id":"87","name":"社会史","parent_id":"80"},{"id":"99","name":"语言","parent_id":"6"},{"id":"6","name":"\\r\\n数字图书","parent_id":"0"},{"id":"25","name":"元史","parent_id":"18"},{"id":"44","name":"人物研究","parent_id":"37"},{"id":"58","name":"世界中古史通史","parent_id":"51"},{"id":"26","name":"明史","parent_id":"18"},{"id":"88","name":"城市史","parent_id":"80"},{"id":"70","name":"拉丁美洲史","parent_id":"62"},{"id":"45","name":"方志学","parent_id":"37"},{"id":"59","name":"欧洲中古史","parent_id":"51"},{"id":"100","name":"十三辑","parent_id":"6"},{"id":"101","name":"十四辑","parent_id":"6"},{"id":"10","name":"史学理论及中国史学史","parent_id":"4"},{"id":"46","name":"谱牒学","parent_id":"37"},{"id":"89","name":"历史地理学","parent_id":"80"},{"id":"102","name":"国图","parent_id":"6"},{"id":"27","name":"清史","parent_id":"18"},{"id":"18","name":"中国古代史","parent_id":"4"},{"id":"60","name":"中东近东及北非的中古史","parent_id":"51"},{"id":"71","name":"俄国史","parent_id":"62"},{"id":"30","name":"中国近代史","parent_id":"4"},{"id":"72","name":"英国史","parent_id":"62"},{"id":"90","name":"人物研究","parent_id":"80"},{"id":"35","name":"中国现代史","parent_id":"4"},{"id":"28","name":"中国古文字","parent_id":"18"},{"id":"61","name":"亚洲中古史","parent_id":"51"},{"id":"29","name":"中国古代契约文书","parent_id":"18"},{"id":"37","name":"专门史","parent_id":"4"},{"id":"73","name":"法国史","parent_id":"62"},{"id":"74","name":"德国史","parent_id":"62"},{"id":"12","name":"历史地理学","parent_id":"8"},{"id":"75","name":"意大利史","parent_id":"62"},{"id":"76","name":"西班牙史","parent_id":"62"},{"id":"77","name":"东欧国家史","parent_id":"62"},{"id":"78","name":"北欧国家史","parent_id":"62"},{"id":"79","name":"近现代国际关系史","parent_id":"62"}]}')},1160:function(t,e,a){"use strict";var i=a(738);a.n(i).a},1161:function(t,e,a){"use strict";var i=a(739);a.n(i).a},1376:function(t,e,a){"use strict";function i(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",{staticClass:"index clearfix"},[i("Top",{attrs:{currentPlant:"X-PUBLISH"}}),i("Menu",{attrs:{curr:"/contentLibrary/digitalBook"}}),i("div",{staticClass:"mainRight"},[i("div",{staticClass:"contentWrap"},[i("div",{staticClass:"contentLeft"},[i("div",{staticClass:"maindata"},[i("div",{staticClass:"serachWrap",on:{keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.query()}}},[i("div",{staticClass:"title"}),i("form",{attrs:{id:"mainForm"}},[i("span",{staticClass:"group-inline"},[i("el-input",{attrs:{placeholder:"书名",name:"name",clearable:""},model:{value:a.searchQuery.name,callback:function(t){a.$set(a.searchQuery,"name",t)},expression:"searchQuery.name"}})],1),i("span",{staticClass:"group-inline"},[i("el-input",{attrs:{placeholder:"作者",name:"author",clearable:""},model:{value:a.searchQuery.author,callback:function(t){a.$set(a.searchQuery,"author",t)},expression:"searchQuery.author"}})],1),i("span",{staticClass:"group-inline"},[i("el-input",{attrs:{placeholder:"标签",name:"tag",clearable:""},model:{value:a.searchQuery.tag,callback:function(t){a.$set(a.searchQuery,"tag",t)},expression:"searchQuery.tag"}})],1),i("span",{staticClass:"group-inline"},[i("TimePick",{attrs:{inputsName:["start_time","end_time"]}})],1),i("span",{staticClass:"group-inline"},[i("el-button",{attrs:{size:"mediu",type:"primary",icon:"el-icon-search",plain:""},on:{click:a.query}},[a._v("搜索")]),i("el-button",{attrs:{size:"mediu",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return a.openDetailDialogAdd("xq",!0)}}},[a._v("新建")])],1)])]),i("div",{staticClass:"tableWrap"},[i("div",{staticClass:"tableTop"},[i("div",{staticClass:"title vel-line"},[i("span",[a._v("全部 "),a.page?i("span",{staticClass:"totalNum"},[a._v("("+a._s(a.page.total)+")")]):a._e()]),i("div",{staticClass:"btns"},[i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:a.moveToOther}},[a._v("移动分组")]),i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return a.opnePublishDialog(!1)}}},[a._v("发布")]),i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:a.importSomething}},[a._v("导入")]),i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:a.exportSomething}},[a._v("导出")]),i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:a.exportSomething2}},[a._v("全部导出")]),i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return a.delChoosen(!1)}}},[a._v("删除")])],1)])]),i("table",{staticClass:"table"},[i("thead",[i("tr",[i("th",{staticClass:"allBtn"},[i("input",{attrs:{type:"checkbox"},on:{click:function(t){return a.checkAll(t)}}})]),i("th",[a._v("名称")]),i("th",[a._v("作者")]),i("th",[a._v("标签")]),i("th",{staticClass:"time"},[a._v("创建时间")]),i("th",{staticClass:"operate"},[a._v("操作")])])]),a.list?i("tbody",a._l(a.list,function(e){return i("tr",[i("th",[i("input",{ref:"ids",refInFor:!0,attrs:{type:"checkbox",name:"ids"},domProps:{value:e.id}})]),i("th",[i("img",{staticClass:"cover-photo",attrs:{src:e.img_src}}),i("div",{staticClass:"th-name bookName",attrs:{title:e.name}},[a._v(a._s(e.name))])]),i("th",[i("div",{staticClass:"th-name",attrs:{title:e.author}},[a._v(a._s(e.author))])]),i("th",[i("div",{staticClass:"th-name",attrs:{title:e.tag}},[a._v(a._s(e.tag))])]),i("th",[i("div",{staticClass:"th-name"},[a._v(a._s(e.create_time))])]),i("th",[i("div",{staticClass:"btns"},[i("Icon",{attrs:{title:"详情",size:"mini",type:"icon-detail",plain:""},on:{click:function(t){return a.opneDetailDialog("xq",e)}}}),i("Icon",{attrs:{title:"预览",size:"mini",type:"icon-preview",plain:""},on:{click:function(t){return a.openReader(e)}}}),i("Icon",{attrs:{title:"链接",size:"mini",type:"icon-link",plain:""},on:{click:function(t){return a.opneImgLinkDialog(e)}}}),i("Icon",{attrs:{title:"删除",size:"mini",type:"icon-delete",plain:""},on:{click:function(t){return a.delChoosen(e.id)}}})],1)])])}),0):a._e()]),a.page?i("div",{staticClass:"pageWrap"},[i("el-pagination",{attrs:{small:!1,background:"","current-page":a.page.num,"page-sizes":[10,50,100],"page-size":a.page.offset,layout:"total, sizes, prev, pager, next, jumper",total:a.page.total},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1):a._e()]),i("div",{staticClass:"gruopList"},[i("GroupList",{attrs:{groupList:a.groupList,currGroup:a.currGroup},on:{addGroup:a.addGroup,updateGroup:a.updateGroup,delGroup:a.delGroup,groupChange:a.groupChange}})],1)])])])]),i("div",{staticClass:"dialogs"},[a.readerDialog?i("Reader",{attrs:{readerDialog:a.readerDialog,readerId:a.readerId,version:"draft"},on:{"update:readerDialog":function(t){a.readerDialog=t},"update:reader-dialog":function(t){a.readerDialog=t}}}):a._e(),i("el-dialog",{attrs:{center:!1,visible:a.detailDialog,"close-on-click-modal":!1,top:"50px",width:"1000px"},on:{"update:visible":function(t){a.detailDialog=t}}},[i("div",{staticClass:"content",attrs:{slot:"title"},slot:"title"},[a.detailDialog?i("Detail",{attrs:{type:a.detailDialogType,detailDialog:a.detailDialog,detailData:a.detailData},on:{detailBack:a.detailBack,"update:detailDialog":function(t){a.detailDialog=t},"update:detail-dialog":function(t){a.detailDialog=t}}}):a._e()],1)]),i("el-dialog",{attrs:{center:!1,visible:a.uploadDialog,"close-on-click-modal":!1,top:"100px"},on:{"update:visible":function(t){a.uploadDialog=t}}},[i("div",{staticClass:"content",attrs:{slot:"title"},slot:"title"},[i("UploadAll",{ref:"upload",on:{upload:a.importFiles}})],1)]),a.publishDialog?i("el-dialog",{attrs:{center:!1,visible:a.publishDialog,"close-on-click-modal":!1,top:"50px",width:"1000px",title:"发布"},on:{"update:visible":function(t){a.publishDialog=t}}},[i("Release",{attrs:{ids:a.fabuIds},on:{cancle:function(t){a.publishDialog=!1}}})],1):a._e(),a.imgLinkDialog?i("LinkDialog",{attrs:{imgLinkDialog:a.imgLinkDialog,imgSrc:a.linkDialogObj.img_src,link:a.linkDialogObj.link},on:{back:function(t){a.imgLinkDialog=!1}}}):a._e(),i("el-dialog",{attrs:{center:!1,visible:a.moveToOtherDiaolog,"close-on-click-modal":!1,title:"移动分组",width:"500px"},on:{"update:visible":function(t){a.moveToOtherDiaolog=t}}},[i("span",{}),i("div",{staticClass:"group"},[i("div",{staticClass:"label"},[a._v("移动到")]),i("select",{ref:"moveToId",staticClass:"form-control",attrs:{placeholder:"请选择"}},a._l(a.groupList,function(t,e){return t.id!=a.currGroup&&""!=t.id?i("option",{domProps:{value:t.id,textContent:a._s(t.name)}}):a._e()}),0)]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:a.moveToSubmit}},[a._v(" 确定")]),i("el-button",{on:{click:function(t){a.moveToOtherDiaolog=!1}}},[a._v("返回")])],1)])],1)],1)}var n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},1405:function(t,e,a){"use strict";function i(){var i=this,t=i.$createElement,n=i._self._c||t;return n("div",{staticClass:"div"},[n("div",{staticClass:"dialogs"},[i.imageCropperDialog?n("ImageCropper",{ref:"imageCropper",attrs:{imageCropperDialog:i.imageCropperDialog,imgFile:i.imgFile,autoCropWidth:290,autoCropHeight:400},on:{"update:imageCropperDialog":function(t){i.imageCropperDialog=t},"update:image-cropper-dialog":function(t){i.imageCropperDialog=t},preview:i.preview}}):i._e(),n("el-dialog",{attrs:{width:"400px",title:"内层Dialog",visible:i.importDialog,"append-to-body":""},on:{"update:visible":function(t){i.importDialog=t}}},[n("div",{staticClass:"center"},[n("el-button",{attrs:{type:"primary",size:"small",plain:""}},[n("a",{attrs:{href:"xswitch://"+i.token.token}},[i._v("点击 调用exe")])]),n("el-button",{attrs:{type:"primary",size:"small",plain:""}},[i._v("xxxx")])],1)]),i.detailReadOnly?n("el-button",{staticClass:"modifyBtn",attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){i.detailReadOnly=!1}}},[i._v("修改")]):i._e(),n("el-tabs",{attrs:{value:i.type},on:{"tab-click":i.handleClick}},[n("el-tab-pane",{attrs:{label:"详情",name:"xq"}},[n("div",{staticClass:"div"},[n("VaForm",{ref:"detailForm"},[n("form",{ref:"detailForm",staticClass:"detailForm"},[n("fieldset",{attrs:{disabled:i.detailReadOnly}},[n("div",{staticClass:"group"},[n("div",{staticClass:"label"},[i._v("ISBN或DOI:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:i.detailDataOwn.isbn,expression:"detailDataOwn.isbn"}],ref:"isbn",staticClass:"form-control grid-content",attrs:{type:"text",maxlength:"15"},domProps:{value:i.detailDataOwn.isbn},on:{input:function(t){t.target.composing||i.$set(i.detailDataOwn,"isbn",t.target.value)}}}),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:i.syncInfo}},[i._v("同步")])],1),n("div",{staticClass:"group"},[n("div",{staticClass:"label"},[i._v("*名称:")]),n("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"},{name:"model",rawName:"v-model",value:i.detailDataOwn.name,expression:"detailDataOwn.name"}],staticClass:"form-control",attrs:{type:"text",maxlength:"20"},domProps:{value:i.detailDataOwn.name},on:{input:function(t){t.target.composing||i.$set(i.detailDataOwn,"name",t.target.value)}}})]),n("TypeMsg",{attrs:{detailDataOwn:i.detailDataOwn,name:"数字图书"}}),n("div",{staticClass:"group"},[n("div",{staticClass:"label"},[i._v("*作者:")]),n("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"},{name:"model",rawName:"v-model",value:i.detailDataOwn.author,expression:"detailDataOwn.author"}],staticClass:"form-control",attrs:{type:"text",maxlength:"10"},domProps:{value:i.detailDataOwn.author},on:{input:function(t){t.target.composing||i.$set(i.detailDataOwn,"author",t.target.value)}}})]),n("div",{staticClass:"group"},[n("div",{staticClass:"label"},[i._v("*标签:")]),n("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"},{name:"model",rawName:"v-model",value:i.detailDataOwn.tag,expression:"detailDataOwn.tag"}],staticClass:"form-control",attrs:{type:"text",maxlength:"10"},domProps:{value:i.detailDataOwn.tag},on:{input:function(t){t.target.composing||i.$set(i.detailDataOwn,"tag",t.target.value)}}})]),n("div",{staticClass:"group"},[n("div",{staticClass:"label"},[i._v("简介:")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:i.detailDataOwn.abs,expression:"detailDataOwn.abs"}],staticClass:"textarea",attrs:{type:"text",maxlength:"300"},domProps:{value:i.detailDataOwn.abs},on:{input:function(t){t.target.composing||i.$set(i.detailDataOwn,"abs",t.target.value)}}})]),n("div",{staticClass:"group",staticStyle:{width:"50%",float:"left"}},[n("div",{staticClass:"label"},[i._v("*设置封面:")]),n("label",[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return i.$refs.fenmian.click()}}},[i._v("导入封面")]),n("input",{ref:"fenmian",staticClass:"hide",attrs:{type:"file",accept:"image/jpeg,image/jpg,image/png"},on:{change:i.previewImg}})],1)]),n("div",{staticClass:"group",staticStyle:{width:"50%",float:"right"}},[n("div",{staticClass:"label"},[i._v("图书稿件:")]),n("label",[n("el-button",{attrs:{size:"mini ",type:"primary"},on:{click:function(t){return i.$refs.tushu.click()}}},[i._v("选择ZIP")]),n("el-button",{attrs:{size:"mini ",type:"primary"},on:{click:i.upLoadXml}},[i._v("导入")]),n("input",{ref:"tushu",staticClass:"hide",attrs:{type:"file",accept:"application/zip"},on:{change:i.previewBook}})],1),n("div",[n("div",{staticClass:"label"},[i._v("当前书稿:")]),i.file?n("span",{domProps:{textContent:i._s(i.file.name)}}):i._e()])]),n("div",{staticClass:"group"},[n("div",{staticClass:"label"}),n("img",{staticClass:"previewImgUrl",attrs:{src:i.previewImgUrl||i.detailDataOwn.img_src}})]),n("p",{staticClass:"imgSizeWrap"},[n("span",{staticClass:"imgSize"},[i._v("建议图片大小：290*400px")])])],1),n("div",{staticClass:"btns"},[n("el-button",{attrs:{ype:"info"},on:{click:function(t){return i.$emit("update:detailDialog",!1)}}},[i._v("取消")]),i.detailReadOnly?i._e():n("el-button",{attrs:{type:"primary"},on:{click:function(t){return i.submitDetail("detailForm")}}},[i._v("确定")])],1)])])],1)]),n("el-tab-pane",{attrs:{label:"扩展属性",name:"data"}},[n("MetaData",{attrs:{metadata:i.metadata,readOnly:i.detailReadOnly},on:{submit:i.submitDetail,back:function(t){return i.$emit("update:detailDialog",!1)}}})],1),n("el-tab-pane",{attrs:{label:"目录",name:"ml"}},[n("div",{staticClass:"muluWrap"},[n("div",{staticClass:"left"},[n("el-tree",{staticClass:"muluList",attrs:{data:i.ml,props:i.defaultProps,"node-key":"id"},on:{"node-click":i.handleNodeClick}})],1),n("div",{staticClass:"right"},[n("fieldset",{attrs:{disabled:i.detailReadOnly}},[n("table",{staticClass:"table"},[n("thead",[n("tr",[n("th",{attrs:{width:"50"}},[i._v("序号")]),n("th",[i._v(" 名称")]),n("th",{attrs:{width:"110"}},[i._v(" 调序")])])]),n("tbody",i._l(i.currMulu,function(e,a){return n("tr",[n("th",{domProps:{textContent:i._s(a+1)}}),n("th",{staticClass:"th-name",domProps:{textContent:i._s(e.chapter_name)}}),n("th",[n("div",{staticClass:"div"},[n("el-button",{staticClass:"iconRotate up",attrs:{disabled:0==a,icon:"el-icon-back",size:"mini"},on:{click:function(t){0!=a&&i.muluSort(e,a,"up")}}}),n("el-button",{staticClass:"iconRotate down",attrs:{disabled:a+1==i.currMulu.length,icon:"el-icon-back",size:"mini"},on:{click:function(t){a+1!=i.currMulu.length&&i.muluSort(e,a,"down")}}})],1)])])}),0)])])])])])],1)],1)])}var n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},324:function(t,e,a){"use strict";a.r(e);var i=a(1376),n=a(715);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a(1161);var l=a(0),s=Object(l.a)(n.default,i.a,i.b,!1,null,"3a3945a6",null);e.default=s.exports},715:function(t,e,a){"use strict";a.r(e);var i=a(716),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e.default=n.a},716:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=v(a(5)),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t},n=(v(a(84)),f(a(19))),r=v(a(158)),l=v(a(157)),o=v(a(161)),d=v(a(420)),u=v(a(731)),c=v(a(384)),p=v(a(1158)),m=a(126),g=f(a(394));function f(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}function v(t){return t&&t.__esModule?t:{default:t}}e.default={components:{Menu:r.default,Top:l.default,GroupList:c.default,Detail:p.default,Release:u.default,Reader:d.default,UploadAll:o.default},mixins:[m.main],data:function(){return{services:g,commonServices:n,list:null,readerDialog:!1,readerId:"",page:null,groupList:null,uploadDialog:!1,detailDialog:!1,detailDialogType:"xq",detailData:null,timePick:null,imgLinkDialog:!1,publishDialog:!1,moveToOtherDiaolog:!1,moveIds:null,toId:null,fabuIds:[]}},methods:{getList:function(t,e,a){var i=0<arguments.length&&void 0!==t?t:this.page&&this.page.num||1,n=this,r=1<arguments.length&&void 0!==e?e:this.page&&this.page.offset||10,l=2<arguments.length&&void 0!==a?a:null;this.services.listBooks(s({pageNum:i,pageOffset:r,group_id:this.currGroup},l)).then(function(t){n.list=t.data,n.page=t.page})},clear:function(){document.getElementById("text").value=""},clear2:function(){document.getElementById("text2").value=""},clear3:function(){document.getElementById("text3").value=""},opneDetailDialog:function(t,e){this.detailData=e,this.detailDialogType=t,this.detailDialog=!0},openDetailDialogAdd:function(t){this.detailDialogType=t,this.detailDialog=!0,this.detailData=null,this.metadata=null},delGroup:function(e){var a=this;log("删除分组",e),this.services.deleteGroup({id:e}).then(function(t){e===a.currGroup&&a.$router.push({path:a.$route.path,query:{id:"non"}}),a.getGroupList()})},opnePublishDialog:function(t){(this.detailData=t)?this.fabuIds.push(t.id):this.fabuIds=this.$getChecked("ids",this),this.fabuIds&&0<this.fabuIds.length&&(this.publishDialog=!0)},releaseBack:function(t){this.publishDialog=!1},openReader:function(t){this.readerId=t.id,this.readerDialog=!0},del:function(e){var a=this;return function(t){return function(){var s=t.apply(this,arguments);return new Promise(function(r,l){return function e(t,a){try{var i=s[t](a),n=i.value}catch(t){return void l(t)}if(!i.done)return Promise.resolve(n).then(function(t){e("next",t)},function(t){e("throw",t)});r(n)}("next")})}}(i.default.mark(function t(){return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",a.services.deleteBooks(e));case 1:case"end":return t.stop()}},t,a)}))()},products:function(t){var i=this;this.services.products({id:t}).then(function(t){i.$message.success("生成成功!")}).catch(function(t){var e=t.payload;for(var a in e.messages){i.$message.error(e.messages[a]);break}})}}}},736:function(t,e,a){"use strict";a.r(e);var i=a(737),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e.default=n.a},737:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=u(a(5)),i=(u(a(1159)),a(160)),n=a(25),l=d(n),s=d(a(394)),o=a(126);function d(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return function(){var s=t.apply(this,arguments);return new Promise(function(r,l){return function e(t,a){try{var i=s[t](a),n=i.value}catch(t){return void l(t)}if(!i.done)return Promise.resolve(n).then(function(t){e("next",t)},function(t){e("throw",t)});r(n)}("next")})}}e.default={props:["type","detailData","detailDialog"],created:function(){this.detailData?(this.getDetail(),this.getMulu(),this.getToken()):this.metadata=this.detailDataOwn.attributes},mixins:[o.getIconStyle],data:function(){return{detailDataOwn:{attributes:[]},metadata:[],ml:null,defaultProps:{children:"children",label:"chapter_name"},imageCropperDialog:!1,oldBlob:null,currMulu:null,previewImgUrl:null,imgUrl:null,file:null,importDialog:!1,token:{}}},methods:{getDetail:function(){var e=this;s.detailBooks({id:this.detailData.id}).then(function(t){e.detailDataOwn=t.data,t.data.attributes||(t.data.attributes=[]),e.metadata=t.data.attributes})},getMulu:function(){var a=this;s.getBookCatalog({id:this.detailData.id}).then(function(t){var e=(0,i.recursionTree)(t.data,"pid","root");a.ml=e,a.currMulu=e})},getToken:function(){var e=this;l.getClientToken().then(function(t){e.token=t.data})},handleClick:function(t,e){"ml"==t.name&&(this.currMulu=this.ml)},handleNodeClick:function(t,e,a){this.currMulu=e.data.children},muluSort:function(t,e,a){var i=this.currMulu;"up"===a?0<e&&(i.splice(e,1),i.splice(e-1,0,t)):(i.splice(e,1),i.splice(e+1,0,t)),s.siblingSort({id:t.id,sort:a})},addMetadata:function(){this.metadata.push({key:"",name:"",value:""})},delMetadata:function(t){this.metadata.splice(t,1)},upLoadXml:function(){var a=this;return c(r.default.mark(function t(){var e;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.file)return e=a.$progress(),t.next=4,l.getTask(a.file,{is_chunk:!0,size:1048576},function(t){e.percentage=t}).then(function(t){a.detailDataOwn.preview=t.data.path});t.next=5;break;case 4:e.close();case 5:case"end":return t.stop()}},t,a)}))()},submitDetail:function(t){var n=this;return c(r.default.mark(function t(){var e,a,i;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.$refs.detailForm.valiAll()){t.next=3;break}return t.abrupt("return");case 3:if(e=n.$progress(),t.prev=4,n.imgFiles)return n.oldBlob&&(n.imgFiles=n.oldBlob,n.imgFiles.name="img"),t.next=9,l.getTask(n.imgFiles).then(function(t){n.detailDataOwn.img=t.data.path});t.next=9;break;case 9:if(n.detailDataOwn.img){t.next=13;break}return n.$message.error("请导入封面!"),e.close(),t.abrupt("return");case 13:if(n.detailDataOwn.id)return t.next=16,s.modifyBooks(n.detailDataOwn);t.next=18;break;case 16:t.next=20;break;case 18:return t.next=20,s.addBooks(n.detailDataOwn);case 20:n.$emit("detailBack"),t.next=33;break;case 23:t.prev=23,t.t0=t.catch(4),a=t.t0.payload,t.t1=r.default.keys(a.messages);case 27:if((t.t2=t.t1()).done){t.next=33;break}return i=t.t2.value,n.$message.error(a.messages[i]),t.abrupt("break",33);case 33:e.close();case 34:case"end":return t.stop()}},t,n,[[4,23]])}))()},submitMetadata:function(){},previewImg:function(t){var e=this,a=t.target.files[0];this.imgFiles=a,this.imgFile=URL.createObjectURL(a),this.$ImageSize({file:a,ratio:.73,interval:.05}).then(function(t){e.previewImgUrl=URL.createObjectURL(a)},function(t){201!=t.status?e.$message.error(t.message):e.imageCropperDialog=!0})},previewBook:function(t){var e=t.target.files[0];this.file=e,dir(e,"file")},syncInfo:function(){var r=this,t=this.$refs.isbn.value;t&&(0,n.synchronization)({id:t}).then(function(t){var e=t.data,a=e.bookname,i=e.writer,n=(e.isbn,e.bookbrief);r.$set(r.detailDataOwn,"name",a),r.$set(r.detailDataOwn,"abs",n),r.$set(r.detailDataOwn,"author",i)}).catch(function(t){var e=t.payload;for(var a in e.messages){r.$message.error(e.messages[a]);break}})},preview:function(t){this.previewImgUrl=URL.createObjectURL(t),this.oldBlob=t,this.imageCropperDialog=!1}}}},738:function(t,e,a){},739:function(t,e,a){}}]);