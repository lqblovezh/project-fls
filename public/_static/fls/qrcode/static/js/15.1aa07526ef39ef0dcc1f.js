(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1368:function(t,e,i){"use strict";var a=i(748);i.n(a).a},1395:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"index clearfix"},[i("div",{staticClass:"mainRight"},[i("div",{staticClass:"contentWrap"},[i("div",{staticClass:"contentLeft"},[i("div",{staticClass:"maindata"},[i("div",{staticClass:"serachWrap"},[i("div",{staticClass:"title"}),i("form",{staticClass:"clearfix",attrs:{id:"mainForm"}},[i("span",{staticClass:"group-inline"},[i("el-input",{attrs:{placeholder:"名称",clearable:""},model:{value:t.query.name,callback:function(e){t.$set(t.query,"name",e)},expression:"query.name"}})],1),i("span",{staticClass:"group-inline"},[i("TimePick",{on:{getTime:t.getTime}})],1),i("span",{staticClass:"group-inline"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.query.status,expression:"query.status"}],staticClass:"form-control width-small",attrs:{placeholder:"标签",name:"status"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.query,"status",e.target.multiple?i:i[0])}}},[i("option",{attrs:{value:""}},[t._v("全部")]),i("option",{attrs:{value:"true"}},[t._v("使用中")]),i("option",{attrs:{value:"false"}},[t._v("未使用")])])]),i("span",{staticClass:"group-inline"},[i("el-button",{attrs:{size:"mediu",type:"primary",icon:"el-icon-search",plain:""},on:{click:t.getList}},[t._v("搜索")])],1)])]),i("div",{staticClass:"tableWrap"},[i("div",{staticClass:"tableTop"},[i("div",{staticClass:"title vel-line"},[i("span",[t._v("全部 "),t.page?i("span",{staticClass:"totalNum"},[t._v("("+t._s(t.total)+")")]):t._e()]),i("div",{staticClass:"btns"},[i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.opneDetailDialog("")}}},[t._v("新建")]),i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){t.del(t.$getChecked())}}},[t._v("删除")])],1)])]),i("table",{staticClass:"table"},[i("thead",[i("tr",[i("th",{staticClass:"table-check"},[i("input",{attrs:{type:"checkbox"},on:{click:function(e){return t.$checkAll(e)}}})]),i("th",[t._v("名称")]),i("th",[t._v("创建时间")]),i("th",[t._v("使用状态")]),i("th",{attrs:{width:"80"}},[t._v("操作")])])]),t.tableData?i("tbody",t._l(t.tableData,function(e){return i("tr",[i("th",[i("input",{ref:"ids",refInFor:!0,attrs:{type:"checkbox",name:"ids"},domProps:{value:e.id}})]),i("th",[i("img",{staticClass:"cover-photo"}),i("div",{staticClass:"th-name bookName",attrs:{title:e.name}},[t._v(t._s(e.name))])]),i("th",[i("div",{staticClass:"th-name"},[t._v(t._s(e.create_time))])]),i("th",[i("div",{staticClass:"th-name"},[t._v(t._s(e.status_name))])]),i("th",[i("div",{staticClass:"btns"},[i("Icon",{attrs:{type:"icon-detail",title:"详情"},on:{click:function(i){return t.opneDetailDialog(e.id)}}}),i("Icon",{attrs:{type:"icon-preview",title:"报表"},on:{click:function(e){return t.$router.push({path:"/wms/voteInfo"})}}}),e.status?t._e():i("Icon",{attrs:{type:"icon-delete",title:"删除"},on:{click:function(i){return t.del(e.id)}}})],1)])])}),0):t._e()]),t.page?i("div",{staticClass:"pageWrap"},[i("el-pagination",{attrs:{small:!1,background:"","current-page":t.page.pageNum,"page-sizes":[10,50,100],"page-size":t.page.pageOffset,layout:"total, sizes,prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e(),i("div",{staticClass:"dialogs"},[i("el-dialog",{attrs:{center:!1,visible:t.detailDialog,"append-to-body":"",to:"50px",width:"1000px"},on:{"update:visible":function(e){t.detailDialog=e}}},[i("div",{staticClass:"content",attrs:{slot:"title"},slot:"title"},[t.detailDialog?i("Detail",{attrs:{id:t.id,detailDialog:t.detailDialog},on:{close:t.close,"update:detailDialog":function(e){t.detailDialog=e},"update:detail-dialog":function(e){t.detailDialog=e}}}):t._e()],1)])],1)])])])])])])},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},298:function(t,e,i){"use strict";i.r(e);var a=i(1395),n=i(746);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i(1368);var r=i(0),o=Object(r.a)(n.default,a.a,a.b,!1,null,"07af360a",null);e.default=o.exports},324:function(t,e,i){"use strict";i.r(e);var a=i(325),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);e.default=n.a},325:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["inputsName","placeholder"],data:function(){return{timePick:null,start:"开始日期",end:"结束日期"}},created:function(){this.placeholder&&(this.start=this.placeholder[0]||this.start,this.end=this.placeholder[1]||this.end)},methods:{}}},326:function(t,e,i){},330:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.main=void 0;var a,n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t},s=i(310);(a=s)&&a.__esModule;var r={data:function(){return{tableData:[],total:0,page:{pageOffset:10,pageNum:1},ids:[],isTeacher:"",dialogVisible:!1,detailVisible:!1,detailData:[],productType:null}},created:function(){this.pageType||this.getList()},methods:{searchLimit:function(){this.page.pageNum=1,this.getList(n({},this.query))},getList:function(t){var e=this;this.service&&this.service.getList(n({},this.page,this.query,t)).then(function(t){t&&t.status&&(e.tableData=t.data,e.total=t.page.total)})},handleSelectionChange:function(t){this.ids=t.map(function(t){return t.id}),this.multipleSelection=t},update:function(t,e){this.$refs[e].src=URL.createObjectURL(t.target.files[0])},getTime:function(t){t||(t=["",""]),this.query.time_start=t[0],this.query.time_end=t[1],this.query.start_time=t[0],this.query.end_time=t[1]},handleSizeChange:function(t){this.page.pageOffset=t,this.getList(n({},this.page,this.query))},handleCurrentChange:function(t){this.page.pageNum=t,this.getList(n({},this.page,this.query))},handleClose:function(){this.detailVisible=!1,this.dialogVisible=!1},del:function(t){var e=this;if(Array.isArray(t)||(t=[t]),!t){if(!this.ids.length)return this.$message.warning("请先选中");t=this.ids}this.$confirm("你真的要删除该数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.service.del({id:t}).then(function(t){t&&t.status&&(e.getList(n({},e.page,e.query)),e.$message.success("删除成功"))},function(t){var i=t.payload;e.$message.error(i.message)})}).catch(function(){})},save:function(t){var e=this;t||(t=this.form),this.service.save(t).then(function(t){t.status&&(e.$message.success("保存成功"),e.getList(e.query)),e.dialogVisible=!1,e.$refs.child&&(e.$refs.child.dialogVisible=!1)},function(t){e.$message.error(t.payload.message)})},educe:function(t){this.service.educe({id:t}).then(function(t){window.location.href=t.data.url})},detail:function(t){var e=this;log(111111),this.service.detail({id:t}).then(function(t){e.detailData=t.data,log(t,"detail")})},dialogClose:function(){this.detailDialog=!1,this.getList()},showDetail:function(t,e){var i=this;log("------------"),this.service.detail({id:t}).then(function(t){log(t,"detailInfo"),i.detailData=t.data,i.productType=e,i.detailVisible=!0})}},computed:{}};e.main=r},347:function(t,e){},348:function(t,e){},352:function(t,e,i){"use strict";i.r(e);var a=i(353),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);e.default=n.a},353:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o(i(9)),n=o(i(320)),s=i(414),r=i(327);function o(t){return t&&t.__esModule?t:{default:t}}e.default={props:["type","id","detailDialog","readOnly","defaultData"],components:{Resource:n.default},data:function(){return{res:[],i:0,delIds:[],resource_info:[],useProduct:[],resourceDialog:!1,detailData:{},newDate:{name:"",questions:[{question:"",type:"single",must:!1,resource_id:[],resource_info:[],option:{1:""}}]}}},mounted:function(){var t=this;this.id?(0,s.detail)({id:this.id}).then(function(e){t.detailData=e.data,t.detailData.questions.forEach(function(t){t.must="false"!==t.must})}):this.detailData=this.newDate},methods:{handleClick:function(t,e){var i=this;"qrcode"==t.name&&(0,r.getUseList)({special_id:this.id}).then(function(t){i.useProduct=t.data})},setType:function(t,e){t.type=e?"multi":"single"},isMust:function(t,e){t.must=e},delQues:function(t,e){this.detailData.questions.splice(t,1),this.delIds.includes(e)||this.delIds.push(e)},delRes:function(t,e){e.resource_id.splice(t,1),e.resource_info.splice(t,1),log(e.resource_id)},delAnswer:function(t,e){this.$delete(e.option,t)},addRes:function(t){this.i=t,this.resourceDialog=!0},addAnswer:function(t){this.$set(t,Object.keys(t).length+1,"")},newArr:function(t,e){return t.map(function(t){return t[e]})},addSelect:function(t,e){var i=this.detailData.questions[this.i];i.resource_info=i.resource_info||[],i.resource_info=this.array_del_repeat(i.resource_info.concat(e),"id"),i.resource_id=this.newArr(i.resource_info,"id"),this.resourceDialog=!1},array_del_repeat:function(t,e){var i={};return t=t.reduce(function(t,a){return!i[a[e]]&&(i[a[e]]=t.push(a)),t},[])},submitInfo:function(){var t,e=(t=a.default.mark(function t(){var e=this;return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.delIds.length){t.next=3;break}return t.next=3,(0,s.delQus)({id:this.delIds});case 3:(0,s.save)(this.detailData).then(function(t){t.status&&e.$emit("close")}).catch(function(t){var i=t.payload;for(var a in i.messages){e.$message.error(i.messages[a]);break}});case 4:case"end":return t.stop()}},t,this)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function a(n,s){try{var r=e[n](s),o=r.value}catch(t){return void i(t)}if(!r.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})});return function(){return e.apply(this,arguments)}}(),add:function(){this.detailData.questions.push({question:"",type:"single",must:!1,resource_id:[],resource_info:[],option:{1:""}})}}}},354:function(t,e,i){},365:function(t,e,i){"use strict";i.r(e);var a=i(367),n=i(324);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i(366);var r=i(0),o=Object(r.a)(n.default,a.a,a.b,!1,null,null,null);e.default=o.exports},366:function(t,e,i){"use strict";var a=i(326);i.n(a).a},367:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"li"},[i("el-date-picker",{staticClass:"picker",attrs:{type:"daterange",align:"right","unlink-panels":!0,name:t.inputsName,"range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":t.start,"end-placeholder":t.end,"default-time":["00:00:00","23:59:59"]},on:{change:function(e){return t.$emit("getTime",t.timePick)}},model:{value:t.timePick,callback:function(e){t.timePick=e},expression:"timePick"}})],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},414:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getList=function(t){return(0,n.request_get)("/api/questionnaire",t)},e.save=function(t){var e=t.id,i=function(t,e){var i={};for(var a in t)e.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(t,a)&&(i[a]=t[a]);return i}(t,["id"]);if(e)return(0,n.request_put)("/api/questionnaire/"+e,i);return(0,n.request_post)("/api/questionnaire",i)},e.detail=function(t){var e=t.id;return(0,n.request_get)("/api/questionnaire/"+e)},e.usedVote=function(t){var e=t.id;return(0,n.request_get)("/api/vote/used/"+e)},e.del=function(t){return(0,n.request_post)("/api/questionnaire/delete",t)},e.delQus=function(t){return(0,n.request_post)("/api/questionnaire/question/delete",t)};var a,n=i(16),s=i(22);(a=s)&&a.__esModule,i(336)},439:function(t,e,i){"use strict";i.r(e);var a=i(444),n=i(352);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i(440);var r=i(0),o=Object(r.a)(n.default,a.a,a.b,!1,null,"5809df4e",null);e.default=o.exports},440:function(t,e,i){"use strict";var a=i(354);i.n(a).a},444:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"div"},[i("el-tabs",{attrs:{value:t.type},on:{"tab-click":t.handleClick}},[t.resourceDialog?i("Resource",{attrs:{resourceDialog:t.resourceDialog,curSoucesList:[],isShowType:!0},on:{"update:resourceDialog":function(e){t.resourceDialog=e},"update:resource-dialog":function(e){t.resourceDialog=e},select:t.addSelect}}):t._e()],1),i("el-tabs",{attrs:{value:t.type||"info"},on:{"tab-click":t.handleClick}},[i("el-tab-pane",{attrs:{label:"详情",name:"info"}},[i("VaForm",{ref:"detailForm"},[i("form",{ref:"detailForm",staticClass:"detailForm"},[i("fieldset",{attrs:{disabled:t.readOnly}},[i("div",{staticClass:"group"},[i("div",{staticClass:"label"},[t._v("*问卷名称:")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.detailData.name,expression:"detailData.name"}],staticClass:"form-control",attrs:{type:"text",maxlength:"20",disabled:t.readOnly},domProps:{value:t.detailData.name},on:{input:function(e){e.target.composing||t.$set(t.detailData,"name",e.target.value)}}})]),i("ul",{staticClass:"question"},t._l(t.detailData.questions,function(e,a){return i("li",{staticClass:"top"},[i("div",{staticClass:"first"},[i("div",{staticClass:"title"},[t._v("第"+t._s(a+1)+"题:")]),i("div",{staticClass:"answer"},[i("el-input",{attrs:{size:"small"},model:{value:e.question,callback:function(i){t.$set(e,"question",i)},expression:"item.question"}})],1),i("el-checkbox",{model:{value:e.must,callback:function(i){t.$set(e,"must",i)},expression:"item.must"}},[t._v("非必填 ")]),i("el-checkbox",{attrs:{value:"multi"==e.type},on:{change:function(i){return t.setType(e,i)}}},[t._v("复选题")]),i("Icon",{staticClass:"delete",attrs:{type:"icon-delete",title:"删除"},on:{click:function(i){return t.delQues(a,e.id)}}})],1),i("div",{staticClass:"second"},[i("div",{staticClass:"title"},[i("div",{staticClass:"name"},[t._v("资源名称")]),i("div",{staticClass:"res"},[t._l(e.resource_info,function(a,n){return i("p",[i("span",[t._v(t._s(a.name||"未选择资源"))]),a.name?i("Icon",{staticClass:"delete",attrs:{type:"icon-delete",title:"删除"},on:{click:function(i){return t.delRes(n,e)}}}):t._e()],1)}),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(e){return t.addRes(a)}}},[t._v("添加资源")])],2)]),i("div",{staticClass:"answer"},[i("ul",t._l(e.option,function(a,n){return i("li",[i("span",[t._v("答案"+t._s(n)+":")]),i("el-input",{staticClass:"w",model:{value:e.option[n],callback:function(i){t.$set(e.option,n,i)},expression:"item.option[i]"}}),i("Icon",{staticClass:"delete",attrs:{type:"icon-delete",title:"删除"},on:{click:function(i){return t.delAnswer(n,e)}}})],1)}),0),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(i){return t.addAnswer(e.option)}}},[t._v("新增答案")])],1)])])}),0)])]),i("div",{staticClass:"btn"},[i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(e){return t.add()}}},[t._v("新增")])],1),i("div",{staticClass:"btns"},[i("el-button",{attrs:{type:"info",size:"small"},on:{click:function(e){return t.$emit("update:detailDialog",!1)}}},[t._v("取消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.submitInfo("detailForm")}}},[t._v("确定")])],1)])],1),i("el-tab-pane",{attrs:{label:"二维码产品",name:"qrcode"}},[i("table",{staticClass:"table"},[i("thead",[i("tr",[i("th",[t._v("产品名称")]),i("th",[t._v("产品简介")]),i("th",[t._v("创建时间")])])]),i("tbody",t._l(t.useProduct,function(e){return i("tr",[i("td",[i("img",{staticClass:"cover-photo",attrs:{src:e.img_src}}),i("div",{staticClass:"th-name bookName"})]),i("td",[t._v(t._s(e.name))]),i("td",[t._v(t._s(e.abs))]),i("td",[t._v(t._s(e.create_time))])])}),0)])])],1)],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},746:function(t,e,i){"use strict";i.r(e);var a=i(747),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);e.default=n.a},747:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(330),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(414)),s=o(i(439)),r=o(i(365));function o(t){return t&&t.__esModule?t:{default:t}}e.default={components:{Detail:s.default,TimePick:r.default},mixins:[a.main],data:function(){return{service:n,detailDialog:!1,detailDialoaType:"info",detailData:null,query:{name:"",start_time:"",end_time:"",status:""},id:""}},methods:{opneDetailDialog:function(t){this.id=t,this.detailDialog=!0},close:function(){this.detailDialog=!1,this.getList()}}}},748:function(t,e,i){}}]);