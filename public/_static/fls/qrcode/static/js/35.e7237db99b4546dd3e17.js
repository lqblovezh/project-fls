(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{1010:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/api/head_books",t)},e.save=function(t){var e=t.id,a=o(t,["id"]);if(e)return(0,n.request_put)(u({id:e}),a);return(0,n.request_post)("/api/head_books",a)},e.detail=function(t){var e=t.id,a=o(t,["id"]);return(0,n.request_get)(u({id:e}),a)},e.del=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/api/head_books/delete",t)},e.sort=function(t){var e=t.id,a=o(t,["id"]);return(0,n.request_put)(l({id:e}),a)};var i,n=a(16),r=a(22),s=(i=r)&&i.__esModule?i:{default:i};function o(t,e){var a={};for(var i in t)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);return a}var u=s.default.compile("/api/head_books/:id"),l=s.default.compile("/api/head_books/sort/:id")},1423:function(t,e,a){"use strict";var i=function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"content"},[e("Tree",{attrs:{dataList:this.list}})],1)])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},272:function(t,e,a){"use strict";a.r(e);var i=a(1423),n=a(624);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);var s=a(0),o=Object(s.a)(n.default,i.a,i.b,!1,null,"b5c2478c",null);e.default=o.exports},378:function(t,e,a){"use strict";a.r(e);var i=a(379),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e.default=n.a},379:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n=a(9),r=(i=n)&&i.__esModule?i:{default:i},s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t},o=a(81);e.default={props:["dataList","type","services","detailData","getDetail"],data:function(){return{data:this.dataList,currMulu:[],detailDialog:!1}},components:{},created:function(){},methods:{append:function(t){t.children||this.$set(t,"children",[]),t.children.push({children:[],name:""})},remove:function(t,e){var a=this;if(e.id)this.services.delCate({id:e.id}).then(function(t){a.getDetail()},function(t){a.$message.error(t.message)});else{var i=t.parent,n=i.data.children||i.data,r=n.findIndex(function(t){return t.id===e.id});n.splice(r,1)}},getList:function(){var t=this;this.detailData.id&&this.services.detail({id:this.detailData.id}).then(function(e){t.data=(0,o.recursionTree)(e.data.category_list)})},allowDrop:function(t,e,a){return"二级 3-1"!==e.data.name||"inner"!==a},allowDrag:function(t){return-1===t.data.name.indexOf("三级 3-2-2")},add:function(){if(!this.detailData.id)return this.$message.warning("请先保存专题详情!");this.data.push({children:[],pid:"0",name:""})},uploadTreeFile:function(t,e){this.currTreeData=t,this.currNode=e,this.$refs.treeImgInp.click()},treeImgInpChange:function(){var t,e=(t=r.default.mark(function t(e){var a,i;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=this.$isFileBig(e,1)){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.$globalUpdateFile(a);case 5:i=t.sent,this.currTreeData,this.$set(this.currTreeData,"img_src",i.url),this.$set(this.currTreeData,"img",i.path);case 9:case"end":return t.stop()}},t,this)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(n,r){try{var s=e[n](r),o=s.value}catch(t){return void a(t)}if(!s.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})});return function(t){return e.apply(this,arguments)}}(),save:function(t,e){var a=this,i=e.parent?e.parent.data:{};this.services.addCate(s({},t,{pid:i.id,special_id:this.detailData.id})).then(function(t){a.$message.success("保存成功"),a.getDetail()},function(t){a.$message.error(t.message)})},selectCurrent:function(t,e){},muluSort:function(t,e){var a=this;this.services.sort({id:t.id,sort:e}).then(function(t){a.getList()})}}}},380:function(t,e,a){},616:function(t,e,a){"use strict";a.r(e);var i=a(791),n=a(378);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a(617);var s=a(0),o=Object(s.a)(n.default,i.a,i.b,!1,null,"5a7f30d1",null);e.default=o.exports},617:function(t,e,a){"use strict";var i=a(380);a.n(i).a},624:function(t,e,a){"use strict";a.r(e);var i=a(625),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e.default=n.a},625:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);e.default=t}(a(1010));var i,n=a(616),r=(i=n)&&i.__esModule?i:{default:i};e.default={components:{Tree:r.default},data:function(){return{list:[]}},created:function(){},methods:{}}},791:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tree"},[t.detailDialog?a("el-dialog",{attrs:{width:"1000px",title:"详情",visible:t.detailDialog,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":""},on:{"update:visible":function(e){t.detailDialog=e}}},[a("VaForm",{ref:"detailForm"},[a("form",{ref:"detailForm",staticClass:"detailForm"},[a("div",{staticClass:"group"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.currentDetail.abs,expression:"currentDetail.abs"}],staticClass:"textarea",attrs:{type:"text",maxlength:"300"},domProps:{value:t.currentDetail.abs},on:{input:function(e){e.target.composing||t.$set(t.currentDetail,"abs",e.target.value)}}})])])]),a("div",{staticClass:"btns",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:function(e){t.detailDialog=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.detailDialog=!1}}},[t._v("确定")])],1)],1):t._e(),a("div",{staticClass:"btn"},[a("el-button",{staticClass:"el-icon-plus",attrs:{type:"primary",plain:""},on:{click:function(e){return t.add()}}},[t._v("添加顶级")])],1),a("table",{ref:"table",staticClass:"table table1"},[t._m(0)]),a("el-tree",{ref:"tree",attrs:{data:t.data,"node-key":"id","default-expand-all":"",draggable:"","allow-drop":t.allowDrop,"allow-drag":t.allowDrag},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node,n=e.data;return a("span",{staticClass:"custom-tree-node"},[a("input",{directives:[{name:"model",rawName:"v-model",value:n.name,expression:"data.name"}],staticClass:"form-control",domProps:{value:n.name},on:{input:function(e){e.target.composing||t.$set(n,"name",e.target.value)}}}),a("span",{staticClass:"options",staticStyle:{float:"right"}},[a("div",{staticClass:"icon el-icon-upload2",attrs:{title:"保存"},on:{click:function(e){return e.stopPropagation(),t.save(n,i)}}}),n.id?a("div",{staticClass:"icon el-icon-plus",attrs:{title:"添加"},on:{click:function(e){return e.stopPropagation(),t.append(n)}}}):t._e(),a("div",{staticClass:"icon icon-delete",attrs:{title:"删除"},on:{click:function(e){return e.stopPropagation(),t.remove(i,n)}}})]),"0"===n.pid?a("div",{staticClass:"time"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return e.stopPropagation(),t.uploadTreeFile(n,i)}}},[t._v("上传")]),a("img",{staticClass:"tree-img",attrs:{src:n.img_src}})],1):t._e()])}}])}),a("input",{ref:"treeImgInp",staticClass:"hide",attrs:{type:"file"},on:{change:t.treeImgInpChange}})],1)},n=[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",{staticStyle:{"padding-left":"80px"}},[this._v(" 名称")]),e("th",{attrs:{width:"200"}},[this._v(" 一级分类图")]),e("th",{staticClass:"options"},[this._v(" 操作")])])])}];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})}}]);