(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{147:function(t,e,i){"use strict";i.r(e);var a=i(148),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);e.default=n.a},148:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(88),n=i(18);e.default={mixins:[a.main],data:function(){return{type:0,params:{gather:{}},id:""}},methods:{getList:function(){var t=this;this.id=this.$route.query.id,this.id||(this.params=this.fetch(),this.id=this.params.gather.id),this.$route.query.type?(0,n.get_home_resource)({id:this.id}).then(function(e){t.info=e.data.info,t.$set(t.params,"gather",{id:t.id,name:t.$route.query.name,data:t.info,res_id:e.data.id,is_buy:e.data.is_buy})}):(0,n.get_resource_content)({id:this.id}).then(function(e){t.info=e.data.info,t.$set(t.params,"gather",{id:t.id,name:t.$route.query.name,data:t.info,res_id:e.data.id,is_buy:e.data.is_buy})})},itemClick:function(t){var e=this;this.$dialog.loading.open("数据加载中"),setTimeout(function(){e.type=t,e.$dialog.loading.close()},1e3)},goResource:function(t,e){var i=t.type_name;if(this.params.gather.is_buy)switch(i){case"音频":this.goPlay(e,"audio");break;case"视频":this.goPlay(e,"video");break;case"数字图书":this.goPlay(e,"chapters");break;case"文章":this.goPlay(e,"article");break;case"图片":this.goPlay(e,"pic")}else this.$dialog.toast({mes:"请先购买",timeout:1500})},goPlay:function(t,e){this.params.gather.n=t,this.save(this.params),this.to(e,{qrcode_id:this.$route.query.qrcode_id,qrcode_product_id:this.$route.query.qrcode_product_id})},showPic:function(t){this.$refs.spic[t].$el.click()}}}},149:function(t,e,i){},398:function(t,e,i){"use strict";var a=i(149);i.n(a).a},443:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("yd-layout",[i("yd-navbar",{attrs:{slot:"navbar",title:t.params.gather.name,color:"#fff",bgcolor:"#3998e2"},slot:"navbar"},[i("router-link",{attrs:{slot:"left",to:"/home?qrcode_id="+t.qrcode_id},slot:"left"},[i("yd-navbar-back-icon",{attrs:{color:"#fff"}},[t._v("返回")])],1)],1),i("div",{staticClass:"scroll"},[i("div",{staticClass:"content",attrs:{slot:"list"},slot:"list"},[i("div",{staticClass:"list"},[t.info.components?i("ul",["图片"==t.info.components[0].type_name&&t.params.gather.is_buy?i("yd-lightbox",[t.info?i("li",[i("yd-lightbox-img",{staticClass:"img",attrs:{src:t.info.img_src}}),i("div",{staticClass:"abstract"},[i("div",{staticClass:"title"},[i("span",{staticClass:"oh"},[t._v(t._s(t.info.name))])]),i("div",{staticClass:"txt"},[t._v(t._s(t.info.abs))]),i("div",{staticClass:"handle"},[i("div",{staticClass:"price"},[i("span",[t._v("价格：")]),i("span",{staticClass:"pr"},[t._v("￥"+t._s(t.info.price)+"  ")])]),t.params.gather.is_buy?i("yd-button",{attrs:{disabled:"",size:"mini",type:"disabled"}},[t._v("免费")]):i("yd-button",{attrs:{size:"mini",bgcolor:"#3998e2",color:"#fff"},nativeOn:{click:function(e){return t.to("/pay",{qrcode_id:t.$route.query.qrcode_id,id:t.$route.query.id,type:"createOrder"})}}},[t._v("立即购买")])],1)])],1):t._e(),t._l(t.info.components,function(e,a){return i("li",{key:a,on:{click:function(e){return t.showPic(a)}}},[i("yd-lightbox-img",{ref:"spic",refInFor:!0,staticClass:"img small",attrs:{src:e.img_src||e.preview_path}}),i("div",{staticClass:"abstract"},[i("div",{staticClass:"title"},[t._v(t._s(e.name))]),i("div",{staticClass:"txt"},[t._v(t._s(e.abs))])])],1)})],2):[t.info?i("li",[i("yd-lightbox-img",{staticClass:"img",attrs:{src:t.info.img_src}}),i("div",{staticClass:"abstract"},[i("div",{staticClass:"title"},[i("span",{staticClass:"oh"},[t._v(t._s(t.info.name))])]),i("div",{staticClass:"txt"},[t._v(t._s(t.info.abs))]),i("div",{staticClass:"handle"},[i("div",{staticClass:"price"},[i("span",[t._v("价格：")]),i("span",{staticClass:"pr"},[t._v("￥"+t._s(t.info.price))])]),t.params.gather.is_buy?"0.00"!=t.info.price?i("yd-button",{attrs:{disabled:"",size:"mini",type:"disabled"}},[t._v("已购买")]):i("yd-button",{attrs:{disabled:"",size:"mini",type:"disabled"}},[t._v("免费 ")]):i("yd-button",{attrs:{size:"mini",bgcolor:"#3998e2",color:"#fff"},nativeOn:{click:function(e){return t.to("/pay",{qrcode_id:t.$route.query.qrcode_id,id:t.$route.query.id,type:"createOrder"})}}},[t._v("立即购买")])],1)])],1):t._e(),t._l(t.info.components,function(e,a){return i("li",{key:a,on:{click:function(i){return t.goResource(e,a)}}},[i("yd-lightbox-img",{staticClass:"img small",attrs:{src:e.img_src||e.preview_path}}),i("div",{staticClass:"abstract"},[i("div",{staticClass:"title"},[i("span",{staticClass:"oh"},[t._v(t._s(e.name))])]),i("div",{staticClass:"txt"},[t._v(t._s(e.abs))])])],1)})]],2):t._e()])])])],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},57:function(t,e,i){"use strict";i.r(e);var a=i(443),n=i(147);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i(398);var o=i(9),r=Object(o.a)(n.default,a.a,a.b,!1,null,"4f9466bf",null);e.default=r.exports},87:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/system/app_manager/managers",t)},e.del=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/system/app_manager/managers/delete",t)},e.detail=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)(o(t),t)},e.save=function(t){var e=t.id,i=function(t,e){var i={};for(var a in t)e.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(t,a)&&(i[a]=t[a]);return i}(t,["id"]);if(e)return(0,n.request_put)(o({id:e}),i);return(0,n.request_post)("/system/app_manager/managers",i).then(function(t){i.apps.forEach(function(e){r({manager_id:t.data.id,app_id:e.id})})})},e.getApps=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/system/app/apps",t)},e.authorize=r,e.revoke=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/system/app_manager/managers/app_revoke",t)},e.codeImage=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=Math.random().toFixed(3);return(0,n.request_get)("/common/api/captcha/image?code="+t)},e.codePhone=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/common/api/captcha/mobile",t)},e.userLogin=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/common/api/auth/login/user",t).then(function(t){return window.sessionStorage.setItem("token",t.data.token),window.localStorage.setItem("token",t.data.token),config.token=t.data.token,t})},e.userReg=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/common/api/user/register",t)},e.backPwdCode=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/common/api/user/pass_reset/send",t)},e.setPwd=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/common/api/user/pass_reset/set",t)},e.phoneLogin=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/common/api/auth/login_by_phone/user",t).then(function(t){return window.sessionStorage.setItem("token",t.data.token),window.localStorage.setItem("token",t.data.token),config.token=t.data.token,t})};var a,n=i(5),s=i(10);var o=((a=s)&&a.__esModule?a:{default:a}).default.compile("/system/api/app_manager/managers/:id");function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/system/app_manager/managers/app_authorize",t)}},88:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.code=e.main=void 0;var a=r(i(8)),n=r(i(89)),s=i(17),o=(i(11),i(87));function r(t){return t&&t.__esModule?t:{default:t}}var c=new n.default({phone:{required:!0,length:11,message:{required:"请输入手机号",length:"手机号码长度应为11位"}}}),u={data:function(){return{list:[],info:{},qrcode_id:this.$route.query.qrcode_id,page:{}}},created:function(){var t,e=this;return(t=a.default.mark(function t(){return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$route.query.token_id&&window.sessionStorage.setItem("token",e.$route.query.token_id),window.sessionStorage.getItem("token")){t.next=5;break}return alert(123456),e.$router.push({path:"/login"}),t.abrupt("return");case 5:e.getList();case 6:case"end":return t.stop()}},t,e)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function a(n,s){try{var o=e[n](s),r=o.value}catch(t){return void i(t)}if(!o.done)return Promise.resolve(r).then(function(t){a("next",t)},function(t){a("throw",t)});t(r)}("next")})})()},methods:{loadList:function(t){var e=this;t&&(0,s.setTimeout)(function(){e.list=[].concat(function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}(e.list),[{txt:"xxxxx"}]),e.$refs.infinitescroll.$emit("ydui.infinitescroll.finishLoad")},1e3)},go:function(t,e){this.$router.push({name:t,params:e})},to:function(t,e){this.$router.push({path:t,query:e})},outLink:function(t){location.href=t},pay:function(){},fetch:function(){return JSON.parse(window.localStorage.getItem("params")||"[]")},save:function(t){window.localStorage.setItem("params",JSON.stringify(t))}},computed:{unescapeHTML:function(){return function(t){return(t=""+t).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&apos;/g,"'")}}},watch:{params:{handler:function(t){this.save(t)},deep:!0}}},d={data:function(){return{img_code:{code_id:null,code_img:null},img_code_val:null,code_tip:"发送验证码",duration:60,timer:null}},methods:{getImgCode:function(){var t=this;(0,o.codeImage)().then(function(e){t.img_code=e.data})},validatePhone:function(){var t=c.validate({phone:this.info.phone});return!(t.length>0)||(this.$Toast({message:t[0].toString()}),!1)},setTimer:function(){var t=this;if(null===this.timer){var e=this.duration;!function i(){t.code_tip=e+"秒后再试",e-- >0?t.timer=(0,s.setTimeout)(i,1e3):(t.code_tip="发送验证码",t.timer=null)}()}},sendCheckCode:function(){var t=this;null!==this.img_code_val?this.validatePhone()&&!this.timer&&(0,o.codePhone)({phone:this.info.phone,code_id_img:this.img_code.code_id,code_val_img:this.img_code_val,not_check_user_exist:1}).then(function(e){t.$dialog.toast({mes:e.message||"发送成功",icon:"success",timeout:1500}),t.setTimer(),t.info.code_id=e.data.code_id}).catch(function(e){t.$dialog.toast({icon:"error",timeout:1500,mes:"发送失败"})}):this.$dialog.toast({mes:"请输入图片验证码",timeout:1e3})}}};e.main=u,e.code=d}}]);