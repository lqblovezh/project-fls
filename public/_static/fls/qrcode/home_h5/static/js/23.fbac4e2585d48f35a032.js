(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{216:function(e,t,n){"use strict";n.r(t);var s=n(217),r=n.n(s);for(var i in s)"default"!==i&&function(e){n.d(t,e,function(){return s[e]})}(i);t.default=r.a},217:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,r=n(8),i=(s=r)&&s.__esModule?s:{default:s},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},o=n(88),u=n(18);t.default={mixins:[o.main],data:function(){return{n:this.$route.query.n||0,is_answer:!1}},methods:{getList:function(){var e,t=this;return(e=i.default.mark(function e(){var n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.$route.query.resource_id,t.$dialog.loading.open("加载数据中..."),(0,u.getResource)({product_id:t.$route.query.qrcode_product_id,resource_id:n}).then(function(e){t.list=e.data.practice_list,t.list.forEach(function(e){Array.isArray(e.user_answer)||(e.user_answer=[])}),t.is_answer=e.data.is_answer_paper}),t.$dialog.loading.close();case 4:case"end":return e.stop()}},e,t)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function s(r,i){try{var a=t[r](i),o=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(o).then(function(e){s("next",e)},function(e){s("throw",e)});e(o)}("next")})})()},next:function(){this.n++,this.n>=this.list.length&&(this.n=this.list.length-1,this.$dialog.toast({mes:"已经是最后一题！",timeout:1500}))},pre:function(){this.n--,this.n<0&&(this.n=0)},sendData:function(){var e=this;if(this.is_answer)this.$dialog.toast({mes:"你已提交过该试卷！",timeout:1500});else{var t=!1,n={product_id:this.$route.query.qrcode_product_id,resource_id:this.$route.query.resource_id,answer:[]};this.list.forEach(function(e){e.user_answer.length||(t=!0),n.answer.push({id:e.id,answer:e.user_answer})}),t?this.$dialog.confirm({title:"提示",mes:"你还有未填写的题目,是否提交！",opts:function(){e.saveData(n)}}):this.saveData(n)}},saveData:function(e){var t=this;(0,u.answer_paper)(e).then(function(e){t.$dialog.toast({mes:"提交成功",timeout:1500,icon:"success"}),t.to("/resource/list",a({},t.$route.query))},function(e){t.$dialog.toast({mes:"提交失败",timeout:1500,icon:"error"})})},answer:function(e,t){switch(Array.isArray(e.user_answer)||(e.user_answer=[""]),e.question_type){case"multi":-1==e.user_answer.findIndex(function(e,n,s){return e==t})?e.user_answer.push(t):e.user_answer.splice(0,1);break;case"judgment":case"single":e.user_answer.splice(0,1,t)}},reset:function(){var e=this;(0,u.reset_paper)({id:this.$route.query.resource_id}).then(function(t){e.n=0,e.$route.query.n=0,e.getList()})}},computed:{getType:function(){return function(e){return"multi"==e?"【多选题】":"single"==e?"【单选题】":"subjective_item"==e?"【主观题】":"fill"==e?"【填空题】":"judgment"==e?"【判断题】":void 0}},isTrue:function(){return function(e,t){if(e.includes(t))return"active"}}}}},218:function(e,t,n){},433:function(e,t,n){"use strict";var s=n(218);n.n(s).a},466:function(e,t,n){"use strict";var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("yd-layout",{staticClass:"body"},[n("yd-navbar",{attrs:{slot:"navbar",title:"在线测试",color:"#fff",bgcolor:"#3998e2"},slot:"navbar"},[n("span",{attrs:{slot:"left"},on:{click:function(t){return e.to("/resource",Object.assign({},e.$route.query))}},slot:"left"},[n("yd-navbar-back-icon",{attrs:{color:"#fff"}},[e._v("返回")])],1)]),n("div",{staticClass:"content"},[e._l(e.list,function(t,s){return[n("div",{directives:[{name:"show",rawName:"v-show",value:s==e.n,expression:"i==n"}],staticClass:"qus"},[n("div",{staticClass:"title"},[n("span",{staticClass:"type c2"},[e._v(e._s(e.getType(t.question_type)))]),n("span",{staticClass:"c5"},[e._v(e._s(t.score)+"分")])]),n("span",{domProps:{innerHTML:e._s(t.question)}})]),"multi"==t.question_type||"single"==t.question_type?n("ul",{directives:[{name:"show",rawName:"v-show",value:s==e.n,expression:"i==n"}],staticClass:"choose"},e._l(t.option,function(s,r){return n("li",{on:{click:function(n){return e.answer(t,["A","B","C","D","E","F","G","H"][r])}}},[n("div",{staticClass:"lside",class:e.isTrue(t.user_answer,["A","B","C","D","E","F","G","H"][r])},[e._v(e._s(["A","B","C","D","E","F","G","H"][r]))]),n("div",{staticClass:"rside"},[n("div",{staticClass:"title",domProps:{innerHTML:e._s(s.title)}}),s.img?n("img",{attrs:{src:s.img}}):e._e()])])}),0):e._e(),"judgment"==t.question_type?n("ul",{directives:[{name:"show",rawName:"v-show",value:s==e.n,expression:"i==n"}],staticClass:"choose"},[n("li",{on:{click:function(n){return e.answer(t,"A")}}},[n("div",{staticClass:"lside",class:e.isTrue(t.user_answer,"A")},[e._v("A")]),n("div",{staticClass:"rside"},[n("div",{staticClass:"title"},[e._v("正确")])])]),n("li",{on:{click:function(n){return e.answer(t,"B")}}},[n("div",{staticClass:"lside",class:e.isTrue(t.user_answer,"B")},[e._v("B")]),n("div",{staticClass:"rside"},[n("div",{staticClass:"title"},[e._v("错误")])])])]):e._e(),!t.user_answer||"fill"!=t.question_type&&"subjective_item"!=t.question_type?e._e():n("yd-textarea",{directives:[{name:"show",rawName:"v-show",value:s==e.n,expression:"i==n "}],staticClass:"textarea",attrs:{placeholder:"请输入答案",maxlength:"100"},model:{value:t.user_answer[0],callback:function(n){e.$set(t.user_answer,0,n)},expression:"item.user_answer[0]"}}),n("div",{directives:[{name:"show",rawName:"v-show",value:s==e.n&&e.is_answer,expression:"i==n && is_answer"}],staticClass:"parse"},[t.answer==t.user_answer.toString()||"subjective_item"==t.question_type?n("div",{staticClass:"isTrue"},[n("span",{staticClass:"icon"}),n("span",[e._v("正确")])]):n("div",{staticClass:"isTrue"},[n("span",{staticClass:"err"}),n("span",{staticClass:"c1"},[e._v("错误,正确答案为 "+e._s(t.answer))])]),n("div",{staticClass:"describe"},[n("div",[e._v("解析：")]),n("div",{domProps:{innerHTML:e._s(t.analysis)}})])])]}),n("div",{staticClass:"btn"},[e.is_answer?n("yd-button",{attrs:{size:"large",bgcolor:"#3998e2",color:"#fff"},nativeOn:{click:function(t){return e.reset(t)}}},[e._v("再做一次")]):n("yd-button",{attrs:{size:"large",bgcolor:"#3998e2",color:"#fff"},nativeOn:{click:function(t){return e.sendData(t)}}},[e._v("提交")])],1)],2),n("div",{staticClass:"handel",attrs:{slot:"tabbar"},slot:"tabbar"},[n("span",{directives:[{name:"show",rawName:"v-show",value:e.n,expression:"n"}],staticClass:"pre",on:{click:e.pre}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.n+1<e.list.length,expression:"n+1<list.length"}],staticClass:"next",on:{click:e.next}})])],1)},r=[];n.d(t,"a",function(){return s}),n.d(t,"b",function(){return r})},80:function(e,t,n){"use strict";n.r(t);var s=n(466),r=n(216);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);n(433);var a=n(9),o=Object(a.a)(r.default,s.a,s.b,!1,null,"31d9228a",null);t.default=o.exports},87:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_get)("/system/app_manager/managers",e)},t.del=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_post)("/system/app_manager/managers/delete",e)},t.detail=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_get)(a(e),e)},t.save=function(e){var t=e.id,n=function(e,t){var n={};for(var s in e)t.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s]);return n}(e,["id"]);if(t)return(0,r.request_put)(a({id:t}),n);return(0,r.request_post)("/system/app_manager/managers",n).then(function(e){n.apps.forEach(function(t){o({manager_id:e.data.id,app_id:t.id})})})},t.getApps=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_get)("/system/app/apps",e)},t.authorize=o,t.revoke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_post)("/system/app_manager/managers/app_revoke",e)},t.codeImage=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=Math.random().toFixed(3);return(0,r.request_get)("/common/api/captcha/image?code="+e)},t.codePhone=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_post)("/common/api/captcha/mobile",e)},t.userLogin=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_post)("/common/api/auth/login/user",e).then(function(e){return window.sessionStorage.setItem("token",e.data.token),window.localStorage.setItem("token",e.data.token),config.token=e.data.token,e})},t.userReg=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_post)("/common/api/user/register",e)},t.backPwdCode=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_post)("/common/api/user/pass_reset/send",e)},t.setPwd=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_post)("/common/api/user/pass_reset/set",e)},t.phoneLogin=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_post)("/common/api/auth/login_by_phone/user",e).then(function(e){return window.sessionStorage.setItem("token",e.data.token),window.localStorage.setItem("token",e.data.token),config.token=e.data.token,e})};var s,r=n(5),i=n(10);var a=((s=i)&&s.__esModule?s:{default:s}).default.compile("/system/api/app_manager/managers/:id");function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_post)("/system/app_manager/managers/app_authorize",e)}},88:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.code=t.main=void 0;var s=o(n(8)),r=o(n(89)),i=n(17),a=(n(11),n(87));function o(e){return e&&e.__esModule?e:{default:e}}var u=new r.default({phone:{required:!0,length:11,message:{required:"请输入手机号",length:"手机号码长度应为11位"}}}),c={data:function(){return{list:[],info:{},qrcode_id:this.$route.query.qrcode_id,page:{}}},created:function(){var e,t=this;return(e=s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$route.query.token_id&&window.sessionStorage.setItem("token",t.$route.query.token_id),window.sessionStorage.getItem("token")){e.next=5;break}return alert(123456),t.$router.push({path:"/login"}),e.abrupt("return");case 5:t.getList();case 6:case"end":return e.stop()}},e,t)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function s(r,i){try{var a=t[r](i),o=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(o).then(function(e){s("next",e)},function(e){s("throw",e)});e(o)}("next")})})()},methods:{loadList:function(e){var t=this;e&&(0,i.setTimeout)(function(){t.list=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t.list),[{txt:"xxxxx"}]),t.$refs.infinitescroll.$emit("ydui.infinitescroll.finishLoad")},1e3)},go:function(e,t){this.$router.push({name:e,params:t})},to:function(e,t){this.$router.push({path:e,query:t})},outLink:function(e){location.href=e},pay:function(){},fetch:function(){return JSON.parse(window.localStorage.getItem("params")||"[]")},save:function(e){window.localStorage.setItem("params",JSON.stringify(e))}},computed:{unescapeHTML:function(){return function(e){return(e=""+e).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&apos;/g,"'")}}},watch:{params:{handler:function(e){this.save(e)},deep:!0}}},l={data:function(){return{img_code:{code_id:null,code_img:null},img_code_val:null,code_tip:"发送验证码",duration:60,timer:null}},methods:{getImgCode:function(){var e=this;(0,a.codeImage)().then(function(t){e.img_code=t.data})},validatePhone:function(){var e=u.validate({phone:this.info.phone});return!(e.length>0)||(this.$Toast({message:e[0].toString()}),!1)},setTimer:function(){var e=this;if(null===this.timer){var t=this.duration;!function n(){e.code_tip=t+"秒后再试",t-- >0?e.timer=(0,i.setTimeout)(n,1e3):(e.code_tip="发送验证码",e.timer=null)}()}},sendCheckCode:function(){var e=this;null!==this.img_code_val?this.validatePhone()&&!this.timer&&(0,a.codePhone)({phone:this.info.phone,code_id_img:this.img_code.code_id,code_val_img:this.img_code_val,not_check_user_exist:1}).then(function(t){e.$dialog.toast({mes:t.message||"发送成功",icon:"success",timeout:1500}),e.setTimer(),e.info.code_id=t.data.code_id}).catch(function(t){e.$dialog.toast({icon:"error",timeout:1500,mes:"发送失败"})}):this.$dialog.toast({mes:"请输入图片验证码",timeout:1e3})}}};t.main=c,t.code=l}}]);