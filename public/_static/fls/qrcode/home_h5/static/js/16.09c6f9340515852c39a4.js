(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{180:function(e,t,n){"use strict";n.r(t);var a=n(181),o=n.n(a);for(var r in a)"default"!==r&&function(e){n.d(t,e,function(){return a[e]})}(r);t.default=o.a},181:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,o=n(8),r=(a=o)&&a.__esModule?a:{default:a},i=n(88),s=n(18);t.default={mixins:[i.main],data:function(){return{params:{}}},methods:{getList:function(){var e,t=this;return(e=r.default.mark(function e(){var n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.$route.query.id,t.$dialog.loading.open("加载数据中..."),t.params=t.fetch(),!t.$route.query.type||!n||t.params.ans){e.next=7;break}(0,s.get_app_info)({id:n,qrcode_product_id:t.$route.query.qrcode_product_id}).then(function(e){t.params=t.fetch(),e.data.n=0,t.$set(t.params,"ans",{is_answer:e.data.is_answer,id:e.data.id,qrcode_product_id:t.$route.query.qrcode_product_id,data:e.data})},function(e){t.$dialog.loading.close()}),e.next=10;break;case 7:if(!n||t.params.ans){e.next=10;break}return e.next=10,(0,s.get_content)({id:n}).then(function(e){t.params=t.fetch(),e.data.n=0,t.$set(t.params,"ans",{is_answer:e.data.is_answer,id:e.data.id,qrcode_product_id:t.$route.query.qrcode_product_id,data:e.data})},function(e){t.$dialog.loading.close()});case 10:t.$dialog.loading.close(),t.info=t.params.ans.data;case 12:case"end":return e.stop()}},e,t)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function a(o,r){try{var i=t[o](r),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){a("next",e)},function(e){a("throw",e)});e(s)}("next")})})()},next:function(){this.info.n++,this.n>=this.info.questions.length&&(this.info.n=this.info.questions.length-1,this.$dialog.toast({mes:"已经是最后一题！",timeout:1500}))},pre:function(){this.info.n--,this.n<0&&(this.info.n=0)},sendData:function(){var e=this;if(this.params.ans.is_answer)this.$dialog.toast({mes:"你已提交过该问卷！",timeout:1500});else{var t={app_id:this.params.ans.id,qrcode_product_id:this.params.ans.qrcode_product_id,questionnaire_answer:[],type:"questionnaire"},n=!1;this.info.questions.forEach(function(e){""!=e.user_answer&&e.user_answer!=[]||(n=!0),t.questionnaire_answer.push({questionnaire_answer_id:e.id,answer:e.user_answer})}),n?this.$dialog.confirm({title:"提示",mes:"你还有未填写的题目,是否提交！",opts:function(){e.saveData(t)}}):this.saveData(t)}},saveData:function(e){var t=this;(0,s.questionnaire)(e).then(function(e){t.$dialog.toast({mes:"提交成功",timeout:1500,icon:"success"}),t.params.ans.is_answer=!0},function(e){e.errors,t.$dialog.toast({mes:"提交失败",timeout:1500,icon:"error"})})}}}},182:function(e,t,n){},411:function(e,t,n){"use strict";var a=n(182);n.n(a).a},454:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("yd-layout",{staticClass:"body"},[n("yd-navbar",{attrs:{slot:"navbar",title:"问卷调查",color:"#fff",bgcolor:"#3998e2"},slot:"navbar"},[n("a",{attrs:{slot:"left",href:"javascript:history.back(-1)"},slot:"left"},[n("yd-navbar-back-icon",{attrs:{color:"#fff"}},[e._v("返回")])],1)]),e.info.questions?n("div",{staticClass:"content"},[e._l(e.info.questions,function(t,a){return[n("div",{directives:[{name:"show",rawName:"v-show",value:a==e.info.n,expression:"i==info.n"}],staticClass:"qus"},[n("span",[e._v(e._s(a+1+"、"+t.question))]),n("yd-radio-group",{directives:[{name:"show",rawName:"v-show",value:"single"==t.type,expression:"item.type=='single'"}],staticClass:"group",attrs:{color:"#3998e2"},model:{value:t.user_answer[0],callback:function(n){e.$set(t.user_answer,0,n)},expression:"item.user_answer[0]"}},e._l(t.option,function(t,a){return n("yd-radio",{staticClass:"radio",attrs:{val:t,disabled:e.params.ans.is_answer}},[e._v(e._s(t)+" ")])}),1),n("yd-checkbox-group",{directives:[{name:"show",rawName:"v-show",value:"single"!=t.type,expression:"item.type!='single'"}],staticClass:"group",attrs:{color:"#3998e2"},on:{callback:function(t){return e.save(e.params)}},model:{value:t.user_answer,callback:function(n){e.$set(t,"user_answer",n)},expression:"item.user_answer"}},e._l(t.option,function(t,a){return n("yd-checkbox",{staticClass:"radio",attrs:{val:t,disabled:e.params.ans.is_answer}},[e._v(e._s(t))])}),1)],1)]}),n("div",{staticClass:"handel"},[e.info.questions&&e.info.n>0?n("span",{staticClass:"pre",on:{click:e.pre}},[e._v("上一题 ")]):e._e(),e.info.questions&&e.info.n<e.info.questions.length-1?n("span",{staticClass:"next",on:{click:e.next}},[e._v("下一题")]):e._e()]),n("div",{staticClass:"btn"},[n("yd-button",{attrs:{size:"large",bgcolor:"#3998e2",color:"#fff"},nativeOn:{click:function(t){return e.sendData(t)}}},[e._v("提交调查")])],1)],2):e._e()],1)},o=[];n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o})},68:function(e,t,n){"use strict";n.r(t);var a=n(454),o=n(180);for(var r in o)"default"!==r&&function(e){n.d(t,e,function(){return o[e]})}(r);n(411);var i=n(9),s=Object(i.a)(o.default,a.a,a.b,!1,null,"7b5da8ee",null);t.default=s.exports},87:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_get)("/system/app_manager/managers",e)},t.del=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/system/app_manager/managers/delete",e)},t.detail=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_get)(i(e),e)},t.save=function(e){var t=e.id,n=function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(e,["id"]);if(t)return(0,o.request_put)(i({id:t}),n);return(0,o.request_post)("/system/app_manager/managers",n).then(function(e){n.apps.forEach(function(t){s({manager_id:e.data.id,app_id:t.id})})})},t.getApps=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_get)("/system/app/apps",e)},t.authorize=s,t.revoke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/system/app_manager/managers/app_revoke",e)},t.codeImage=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=Math.random().toFixed(3);return(0,o.request_get)("/common/api/captcha/image?code="+e)},t.codePhone=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/common/api/captcha/mobile",e)},t.userLogin=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/common/api/auth/login/user",e).then(function(e){return window.sessionStorage.setItem("token",e.data.token),window.localStorage.setItem("token",e.data.token),config.token=e.data.token,e})},t.userReg=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/common/api/user/register",e)},t.backPwdCode=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/common/api/user/pass_reset/send",e)},t.setPwd=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/common/api/user/pass_reset/set",e)},t.phoneLogin=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/common/api/auth/login_by_phone/user",e).then(function(e){return window.sessionStorage.setItem("token",e.data.token),window.localStorage.setItem("token",e.data.token),config.token=e.data.token,e})};var a,o=n(5),r=n(10);var i=((a=r)&&a.__esModule?a:{default:a}).default.compile("/system/api/app_manager/managers/:id");function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/system/app_manager/managers/app_authorize",e)}},88:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.code=t.main=void 0;var a=s(n(8)),o=s(n(89)),r=n(17),i=(n(11),n(87));function s(e){return e&&e.__esModule?e:{default:e}}var u=new o.default({phone:{required:!0,length:11,message:{required:"请输入手机号",length:"手机号码长度应为11位"}}}),c={data:function(){return{list:[],info:{},qrcode_id:this.$route.query.qrcode_id,page:{}}},created:function(){var e,t=this;return(e=a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$route.query.token_id&&window.sessionStorage.setItem("token",t.$route.query.token_id),window.sessionStorage.getItem("token")){e.next=5;break}return alert(123456),t.$router.push({path:"/login"}),e.abrupt("return");case 5:t.getList();case 6:case"end":return e.stop()}},e,t)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function a(o,r){try{var i=t[o](r),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){a("next",e)},function(e){a("throw",e)});e(s)}("next")})})()},methods:{loadList:function(e){var t=this;e&&(0,r.setTimeout)(function(){t.list=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t.list),[{txt:"xxxxx"}]),t.$refs.infinitescroll.$emit("ydui.infinitescroll.finishLoad")},1e3)},go:function(e,t){this.$router.push({name:e,params:t})},to:function(e,t){this.$router.push({path:e,query:t})},outLink:function(e){location.href=e},pay:function(){},fetch:function(){return JSON.parse(window.localStorage.getItem("params")||"[]")},save:function(e){window.localStorage.setItem("params",JSON.stringify(e))}},computed:{unescapeHTML:function(){return function(e){return(e=""+e).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&apos;/g,"'")}}},watch:{params:{handler:function(e){this.save(e)},deep:!0}}},d={data:function(){return{img_code:{code_id:null,code_img:null},img_code_val:null,code_tip:"发送验证码",duration:60,timer:null}},methods:{getImgCode:function(){var e=this;(0,i.codeImage)().then(function(t){e.img_code=t.data})},validatePhone:function(){var e=u.validate({phone:this.info.phone});return!(e.length>0)||(this.$Toast({message:e[0].toString()}),!1)},setTimer:function(){var e=this;if(null===this.timer){var t=this.duration;!function n(){e.code_tip=t+"秒后再试",t-- >0?e.timer=(0,r.setTimeout)(n,1e3):(e.code_tip="发送验证码",e.timer=null)}()}},sendCheckCode:function(){var e=this;null!==this.img_code_val?this.validatePhone()&&!this.timer&&(0,i.codePhone)({phone:this.info.phone,code_id_img:this.img_code.code_id,code_val_img:this.img_code_val,not_check_user_exist:1}).then(function(t){e.$dialog.toast({mes:t.message||"发送成功",icon:"success",timeout:1500}),e.setTimer(),e.info.code_id=t.data.code_id}).catch(function(t){e.$dialog.toast({icon:"error",timeout:1500,mes:"发送失败"})}):this.$dialog.toast({mes:"请输入图片验证码",timeout:1e3})}}};t.main=c,t.code=d}}]);