(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{1650:function(t,e,a){"use strict";var i=a(957);a.n(i).a},1655:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"index clearfix"},[a("div",{staticClass:"mainRight"},[a("div",{staticClass:"contentWrap"},[a("div",{staticClass:"contentLeft"},[a("div",{staticClass:"maindata"},[a("div",{staticClass:"serachWrap"},[a("div",{staticClass:"title"}),a("form",{staticClass:"clearfix",attrs:{id:"mainForm"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push({path:"/wms/vote",query:{pn:t.$route.query.pn}})}}},[t._v("返回")]),a("span",{staticClass:"group-inline float-right"},[a("el-dialog",{attrs:{center:!1,visible:t.detailDialog,"append-to-body":"",title:"所属产品",to:"50px",width:"600px"},on:{"update:visible":function(e){t.detailDialog=e}}},[a("ul",{staticClass:"type"},[a("li",{on:{click:function(e){return t.choose({id:"",name:"全部"})}}},[t._v("全部")]),t._l(t.detailData,function(e){return a("li",{on:{click:function(a){return t.choose(e)}}},[t._v(t._s(e.name))])})],2),a("div",{staticClass:"pageWrap"},[a("el-pagination",{attrs:{small:!1,background:"","current-page":t.page2.pageNum,"page-sizes":[10,50,100],"page-size":t.page2.pageOffset,layout:"total, sizes,prev, pager, next, jumper",total:t.page2.total},on:{"size-change":t.sizeChange,"current-change":t.currentChange}})],1)]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.detailDialog=!0}}},[t._v("所属产品 :"+t._s(t.chooseName))])],1)],1)]),a("div",{staticClass:"tableWrap"},[a("div",{staticClass:"tableTop"},[a("div",{staticClass:"title vel-line"},[a("span",[t._v("全部 "),t.page?a("span",{staticClass:"totalNum"},[t._v("("+t._s(t.total)+")")]):t._e()]),a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){return t.educe(t.$route.query.id)}}},[t._v("导出")]),a("el-button-group",{model:{value:t.radioBtn,callback:function(e){t.radioBtn=e},expression:"radioBtn"}},[a("el-button",{attrs:{type:"primary"}},[t._v("投票人信息")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){return t.$router.push({path:"/wms/statics",query:{pn:t.$route.query.pn,id:t.$route.query.id}})}}},[t._v("数据统计")])],1)],1)])]),a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{staticClass:"table-check"},[a("input",{attrs:{type:"checkbox"},on:{click:function(e){return t.$checkAll(e)}}})]),a("th",[t._v("昵称")]),a("th",[t._v("性别")]),a("th",[t._v("产品名称")]),a("th",[t._v("投票时间")]),a("th",[t._v("电话")]),a("th",[t._v("投票选项")])])]),t.tableData?a("tbody",t._l(t.tableData,function(e){return a("tr",[a("th",[a("input",{ref:"ids",refInFor:!0,attrs:{type:"checkbox",name:"ids"},domProps:{value:e.id}})]),a("th",[a("div",{staticClass:"th-name"},[t._v(t._s(e.user_name))])]),a("th",[a("div",{staticClass:"th-name"},[t._v(t._s(e.sex))])]),a("th",[a("div",{staticClass:"th-name"},[t._v(t._s(e.product_name))])]),a("th",[t._v(t._s(e.update_time))]),a("th",[t._v(t._s(e.phone))]),a("th",[t._v(t._s(e.answer))])])}),0):t._e()]),t.page?a("div",{staticClass:"pageWrap"},[a("el-pagination",{attrs:{small:!1,background:"","current-page":t.page.pageNum,"page-sizes":[10,50,100],"page-size":t.page.pageOffset,layout:"total, sizes,prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()])])])])])])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},277:function(t,e,a){"use strict";a.r(e);var i=a(1655),n=a(954);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a(1650);var s=a(0),o=Object(s.a)(n.default,i.a,i.b,!1,null,"7ac2d2fe",null);e.default=o.exports},436:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.main=void 0;var i,n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t},r=a(282);(i=r)&&i.__esModule;var s={data:function(){return{tableData:[],total:0,page:{pageOffset:10,pageNum:Number(this.$route.query.pn)||1},ids:[],isTeacher:"",dialogVisible:!1,detailVisible:!1,detailData:[],productType:null}},created:function(){this.pageType||this.getList()},methods:{searchLimit:function(){this.page.pageNum=1,this.getList(n({},this.query))},getList:function(t){var e=this;this.service&&this.service.getList(n({},this.page,this.query,t)).then(function(t){t&&t.status&&(e.tableData=t.data,e.total=t.page.total)})},handleSelectionChange:function(t){this.ids=t.map(function(t){return t.id}),this.multipleSelection=t},update:function(t,e){this.$refs[e].src=URL.createObjectURL(t.target.files[0])},getTime:function(t){t||(t=["",""]),this.query.time_start=t[0],this.query.time_end=t[1],this.query.start_time=t[0],this.query.end_time=t[1]},handleSizeChange:function(t){this.page.pageOffset=t,this.getList(n({},this.page,this.query))},handleCurrentChange:function(t){this.page.pageNum=t,this.getList(n({},this.page,this.query))},handleClose:function(){this.detailVisible=!1,this.dialogVisible=!1},del:function(t){var e=this;if(Array.isArray(t)||(t=[t]),!t){if(!this.ids.length)return this.$message.warning("请先选中");t=this.ids}this.$confirm("你真的要删除该数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.service.del({id:t}).then(function(t){t&&t.status&&(e.getList(n({},e.page,e.query)),e.$message.success("删除成功"))},function(t){var a=t.payload;e.$message.error(a.message)})}).catch(function(){})},save:function(t){var e=this;t||(t=this.form),this.service.save(t).then(function(t){t.status&&(e.$message.success("保存成功"),e.getList(e.query)),e.dialogVisible=!1,e.$refs.child&&(e.$refs.child.dialogVisible=!1)},function(t){e.$message.error(t.payload.message)})},educe:function(t){this.service.educe({id:t}).then(function(t){window.location.href=t.data.url})},detail:function(t){var e=this;this.service.detail({id:t}).then(function(t){e.detailData=t.data})},dialogClose:function(){this.detailDialog=!1,this.getList()},showDetail:function(t,e){var a=this;log("------------"),this.service.detail({id:t}).then(function(t){log(t,"detailInfo"),a.detailData=t.data,a.productType=e,a.detailVisible=!0})}},computed:{}};e.main=s},562:function(t,e){},585:function(t,e){},586:function(t,e){},587:function(t,e,a){"use strict";a.r(e);var i=a(588),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e.default=n.a},588:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(a(284)),n=(s(a(282)),function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}(a(661))),r=a(433);a(562);function s(t){return t&&t.__esModule?t:{default:t}}e.default={props:["type","detailData","detailDialog","readOnly","defaultData"],components:{Resource:i.default},data:function(){return{radio:0,resource:[],voteAnswer:[],name:"",id:"",res:[],useProduct:[],resourceDialog:!1}},created:function(){var t=this;this.detailData&&(n.detail({id:this.detailData.id}).then(function(e){t.res=e.data.constitute,t.name=e.data.name,t.id=e.data.id,t.voteAnswer=e.data.answer,t.resource=e.data.constitute.map(function(t){return t.info})}),n.usedVote({id:this.detailData.id}).then(function(t){}))},methods:{handleClick:function(t,e){var a=this;"qrcode"==t.name&&(0,r.getUseList)({special_id:this.id}).then(function(t){a.useProduct=t.data})},addSelect:function(t,e){this.resource=this.array_del_repeat(this.resource.concat(e),"id"),this.resourceDialog=!1},array_del_repeat:function(t,e){var a={};return t=t.reduce(function(t,i){return!a[i[e]]&&(a[i[e]]=t.push(i)),t},[])},addAnswer:function(){var t=this.voteAnswer.length;if(t&&!this.voteAnswer[t-1].answer)return this.$message.warning("请先填写"),void this.$refs.answer[t-1].focus();this.voteAnswer.push({answer:"",option:""})},remove:function(t,e,a){a?n.delRes({id:this.res[e].id}).then(function(a){a.status&&t.splice(e,1)}):t.splice(e,1)},newArr:function(t,e){return t.map(function(t){return t[e]})},submitInfo:function(){var t=this;if(!this.name||!this.voteAnswer.length)return this.$message.warning("相关信未填写完整！");var e={name:this.name,resource_ids:this.newArr(this.resource,"id"),answer:this.voteAnswer,id:this.id};n.save(e).then(function(e){e.status&&t.$emit("close")}).catch(function(e){var a=e.payload;for(var i in a.messages){t.$message.error(a.messages[i]);break}})}}}},589:function(t,e,a){},660:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/api/qrcode_product",t)},e.del=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/api/qrcode_product/delete",t)},e.modifyStatus=d,e.detail=c,e.save=function(t){var e=t.id,a=o(t,["id"]);if(e)return(0,n.request_put)(u({id:e}),a);return(0,n.request_post)("/api/qrcode_product",a)},e.getResConf=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)(l(t),t)},e.saveProduct=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_put)("/api/qrcode_product/resource",t)};var i,n=a(16),r=a(21),s=(i=r)&&i.__esModule?i:{default:i};function o(t,e){var a={};for(var i in t)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);return a}var u=s.default.compile("/api/qrcode_product/:id"),c=s.default.compile("/api/qrcode_product/:id"),l=s.default.compile("/api/qrcode_product/resource/:id"),d=s.default.compile("/api/qrcode_product/use/:id");function d(t){var e=t.id,a=o(t,["id"]);if(log(e,a,"xasssd"),e)return(0,n.request_put)(d({id:e}),a)}function c(t){var e=t.id,a=o(t,["id"]);return(0,n.request_get)(c({id:e}),a)}},661:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getList=function(t){return(0,n.request_get)("/api/vote",t)},e.save=function(t){var e=t.id,a=function(t,e){var a={};for(var i in t)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);return a}(t,["id"]);if(e)return(0,n.request_put)("/api/vote/"+e,a);return(0,n.request_post)("/api/vote",a)},e.detail=function(t){var e=t.id;return(0,n.request_get)("/api/vote/"+e)},e.usedVote=function(t){var e=t.id;return(0,n.request_get)("/api/vote/used/"+e)},e.del=function(t){return(0,n.request_post)("/api/vote/delete",t)},e.delRes=function(t){var e=t.id;return(0,n.request_delete)("/api/vote/resource/"+e)};var i,n=a(16),r=a(21);(i=r)&&i.__esModule,a(569)},685:function(t,e,a){"use strict";a.r(e);var i=a(688),n=a(587);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a(686);var s=a(0),o=Object(s.a)(n.default,i.a,i.b,!1,null,"dffb1d3a",null);e.default=o.exports},686:function(t,e,a){"use strict";var i=a(589);a.n(i).a},688:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"div"},[a("el-tabs",{attrs:{value:t.type},on:{"tab-click":t.handleClick}},[t.resourceDialog?a("Resource",{attrs:{resourceDialog:t.resourceDialog,curSoucesList:[],isShowType:!0},on:{"update:resourceDialog":function(e){t.resourceDialog=e},"update:resource-dialog":function(e){t.resourceDialog=e},select:t.addSelect}}):t._e(),a("el-tab-pane",{attrs:{label:"详情",name:"info"}},[a("VaForm",{ref:"detailForm"},[a("form",{ref:"detailForms",staticClass:"detailForm"},[a("fieldset",{attrs:{disabled:t.readOnly}},[a("div",{staticClass:"group"},[a("div",{staticClass:"label"},[t._v("* 投票名称:")]),a("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"},{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",attrs:{type:"text",maxlength:"20",disabled:t.readOnly},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),a("div",{staticClass:"group"},[a("div",{staticClass:"label"},[t._v("* 投票答案:")]),a("div",{staticClass:"res"},[t._l(t.voteAnswer,function(e,i){return a("div",{staticClass:"item"},[a("el-radio",{attrs:{label:e.option},model:{value:e.option,callback:function(a){t.$set(e,"option",a)},expression:"item.option"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.answer,expression:"item.answer"}],ref:"answer",refInFor:!0,staticClass:"form-control",domProps:{value:e.answer},on:{input:function(a){a.target.composing||t.$set(e,"answer",a.target.value)}}}),a("el-button",{attrs:{type:"danger",plain:"",size:"small"},on:{click:function(e){return t.remove(t.voteAnswer,i)}}},[t._v("删除")])],1)],1)}),a("div",{staticClass:"item"},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.addAnswer}},[t._v("新增投票答案")])],1)],2)])])]),t.readOnly?t._e():a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"info"},on:{click:function(e){return t.$emit("update:detailDialog",!1)}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitInfo("detailForms")}}},[t._v("确定")])],1)])],1),a("el-tab-pane",{attrs:{label:"使用中产品",name:"qrcode"}},[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",[t._v("二维码")]),a("th",[t._v("产品名称")]),a("th",[t._v("产品简介")]),a("th",[t._v("创建时间")])])]),a("tbody",[t.useProduct.length?t._e():a("tr",[a("td",{staticClass:"noMsg",attrs:{colspan:"4",align:"center"}},[t._v("暂无相关数据")])]),t._l(t.useProduct,function(e){return a("tr",[a("td",[a("img",{staticClass:"cover-photo",attrs:{src:e.img_src}}),a("div",{staticClass:"th-name bookName"})]),a("td",[t._v(t._s(e.name))]),a("td",[t._v(t._s(e.abs))]),a("td",[t._v(t._s(e.create_time))])])})],2)])])],1)],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},954:function(t,e,a){"use strict";a.r(e);var i=a(955),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e.default=n.a},955:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(436),n=(u(a(282)),o(a(956))),r=o(a(660)),s=u(a(685));function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}function u(t){return t&&t.__esModule?t:{default:t}}e.default={components:{Detail:s.default},mixins:[i.main],data:function(){return{service:n,detailDialog:!1,detailDialoaType:"info",detailData:[],product:[],radioBtn:"投票人信息",query:{id:this.$route.query.id,type:"vote",product_id:""},chooseName:"全部",page2:{pageOffset:10,pageNum:1}}},mounted:function(){this.getPro()},methods:{getPro:function(){var t=this;r.getList({pageOffset:this.page2.pageOffset,pageNum:this.page2.num}).then(function(e){t.page2=e.page,t.detailData=e.data})},opneDetailDialog:function(){this.detailDialog=!0},choose:function(t){this.query.product_id=t.id,this.chooseName=t.name,this.getList(),this.detailDialog=!1},sizeChange:function(t){this.page2.pageOffset=t,this.getPro()},currentChange:function(t){this.page2.pageNum=t,this.getPro()},educe:function(t){var e=this;this.service.educe({id:t}).then(function(t){e.$message.success("任务创建成功，请前往'导入导出列表'页查看进度！")}).catch(function(t){e.$message.error("导出失败")})}}}},956:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getList=function(t){var e=t.id,a=function(t,e){var a={};for(var i in t)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);return a}(t,["id"]);return(0,n.request_get)("/api/vote/log/"+e,a)},e.pullList=function(){return(0,n.request_get)("/api/vote")},e.statics=function(t){return(0,n.request_get)("/api/vote/statistics",t)},e.educe=function(t){return(0,n.request_get)("/api/vote/export",t)};var i,n=a(16),r=a(21);(i=r)&&i.__esModule,a(569)},957:function(t,e,a){}}]);