(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{1093:function(t,e,i){"use strict";i.r(e);var a=i(1705),s=i(893);for(var n in s)"default"!==n&&function(t){i.d(e,t,function(){return s[t]})}(n);i(1612);var r=i(0),o=Object(r.a)(s.default,a.a,a.b,!1,null,"f26c03fa",null);e.default=o.exports},1611:function(t,e,i){"use strict";i.r(e);var a=i(1712),s=i(895);for(var n in s)"default"!==n&&function(t){i.d(e,t,function(){return s[t]})}(n);var r=i(0),o=Object(r.a)(s.default,a.a,a.b,!1,null,null,null);e.default=o.exports},1612:function(t,e,i){"use strict";var a=i(897);i.n(a).a},1613:function(t,e,i){"use strict";var a=i(898);i.n(a).a},1674:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"box"},[i("el-dialog",{attrs:{center:!1,visible:t.detailDialog,"append-to-body":"",to:"50px",width:"1200px"},on:{"update:visible":function(e){t.detailDialog=e}}},[i("div",{staticClass:"content",attrs:{slot:"title"},slot:"title"},[t.detailDialog?i("Detail",{attrs:{detailDialog:t.detailDialog,detailData:t.detailData,type:t.detailDialoaType,readOnly:!1},on:{"update:detailDialog":function(e){t.detailDialog=e},"update:detail-dialog":function(e){t.detailDialog=e},saveok:t.saveok}}):t._e()],1)]),i("div",{staticClass:"mainRight"},[i("div",{staticClass:"contentWrap"},[i("div",{staticClass:"contentLeft"},[i("div",{staticClass:"maindata"},[i("div",{staticClass:"serachWrap"},[i("div",{staticClass:"title"}),i("form",{staticClass:"clearfix",attrs:{id:"mainForm"}},[i("span",{staticClass:"group-inline"},[i("el-input",{attrs:{placeholder:"名称",name:"name",clearable:""},model:{value:t.searchQuery.name,callback:function(e){t.$set(t.searchQuery,"name",e)},expression:"searchQuery.name"}})],1),i("span",{staticClass:"group-inline"},[i("TimePick",{attrs:{inputsName:["start_time","end_time"]}})],1),i("span",{staticClass:"group-inline float-right"},[i("el-button",{attrs:{size:"mediu",type:"primary",icon:"el-icon-plus",plain:""},on:{click:t.addQrcodePro}},[t._v("新建")]),i("el-button",{attrs:{size:"mediu",type:"primary",icon:"el-icon-search",plain:""},on:{click:t.query}},[t._v("搜索")])],1)])]),i("div",{staticClass:"btn"},[i("el-button-group",[i("el-button",{attrs:{type:"primary",plain:""},on:{click:t.getList}},[t._v("全部")]),i("el-button",{attrs:{type:"primary",plain:""},on:{click:t.getusedList}},[t._v("已使用")]),i("el-button",{attrs:{type:"primary",plain:""},on:{click:t.getnoUseList}},[t._v("暂停中")])],1)],1),i("div",{staticClass:"tableWrap"},[i("div",{staticClass:"tableTop"},[i("div",{staticClass:"title vel-line"},[i("span",[t._v("全部 "),t.page?i("span",{staticClass:"totalNum"},[t._v("("+t._s(t.page.total)+")")]):t._e()]),i("div",{staticClass:"btns"},[i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.delChoosen(!1)}}},[t._v("删除")])],1)])]),i("table",{staticClass:"table"},[i("thead",[i("tr",[i("th",{staticClass:"table-check"},[i("input",{attrs:{type:"checkbox"},on:{click:function(e){return t.$checkAll(e)}}})]),i("th",[t._v("产品名称")]),i("th",[t._v("使用二维码名称")]),i("th",{attrs:{width:"150"}},[t._v("资源消息个数")]),i("th",{attrs:{width:"150"}},[t._v("创建时间")]),i("th",{attrs:{width:"150"}},[t._v("状态")]),i("th",{attrs:{width:"80"}},[t._v("操作")])])]),t.list?i("tbody",t._l(t.list,function(e){return i("tr",[i("th",[i("input",{ref:"ids",refInFor:!0,attrs:{type:"checkbox",name:"ids"},domProps:{value:e.id}})]),i("th",[i("img",{staticClass:"cover-photo",attrs:{src:e.img_src}}),i("div",{staticClass:"th-name bookName",attrs:{title:e.name}},[t._v(t._s(e.name))])]),i("th",[i("div",{staticClass:"th-name",attrs:{title:e.qrcode_name}},[t._v(t._s(e.qrcode_name)+" ")])]),i("th",[i("div",{staticClass:"th-name"},[t._v(t._s(e.msg_num))])]),i("th",[i("div",{staticClass:"th-name"},[t._v(t._s(e.create_time))])]),i("th",[i("div",{staticClass:"th-name"},[t._v(t._s(e.status_name))])]),i("th",[i("div",{staticClass:"btns"},[i("Icon",{attrs:{type:"icon-detail",title:"详情"},on:{click:function(i){return t.opneDetailDialog("info",e)}}}),"true"!=e.status?i("Icon",{attrs:{type:"icon-preview",title:"使用"},on:{click:function(i){return t.modifyStatus(e,"true")}}}):t._e(),"false"!=e.status?i("Icon",{attrs:{type:"icon-Shield",title:"停用"},on:{click:function(i){return t.modifyStatus(e,"false")}}}):t._e(),"true"!=e.status?i("Icon",{attrs:{type:"icon-delete",title:"删除"},on:{click:function(i){return t.delChoosen(e.id)}}}):t._e()],1)])])}),0):t._e()]),t.page?i("div",{staticClass:"pageWrap"},[i("el-pagination",{attrs:{small:!1,background:"","current-page":t.page.num,"page-sizes":[10,50,100],"page-size":t.page.offset,layout:"total, sizes,prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()])])])])])],1)},s=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return s})},1705:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"div"},[t.selResourDialog?i("el-dialog",{attrs:{visible:t.selResourDialog,top:"50px",width:"800px","append-to-body":"",title:"资源选择"},on:{"update:visible":function(e){t.selResourDialog=e}}},[i("div",{staticClass:"content",attrs:{slot:"title"},slot:"title"},[i("ul",{staticClass:"selResour"},[i("li",{on:{click:function(e){return t.selResource("resource","1")}}},[i("span",[t._v("资源库")])]),i("li",{on:{click:function(e){return t.selResource("app","7")}}},[i("span",[t._v("应用库")])]),i("li",{on:{click:function(e){return t.selResource("special","8")}}},[i("span",[t._v("专题库")])])])])]):t._e(),i("el-tabs",{attrs:{value:t.type},on:{"tab-click":t.handleClick}},[i("el-tab-pane",{attrs:{label:"详情",name:"info"}},[t.qrcodeDetailVis?i("Qrcode",{attrs:{qrcodeDetailVis:t.qrcodeDetailVis},on:{"update:qrcodeDetailVis":function(e){t.qrcodeDetailVis=e},"update:qrcode-detail-vis":function(e){t.qrcodeDetailVis=e},chooseQrcode:t.chooseQrcode}}):t._e(),i("VaForm",{ref:"detailForm"},[i("form",{ref:"detailForm",staticClass:"detailForm"},[i("fieldset",{attrs:{disabled:t.readOnly}},[i("div",{staticClass:"group"},[i("div",{staticClass:"label"},[t._v("*二维码:")]),t.information.img_src?i("img",{staticClass:"img",attrs:{src:t.information.img_src}}):t._e(),i("el-button",{staticClass:"select",attrs:{type:"primary",size:"mini",plain:""},on:{click:function(e){t.qrcodeDetailVis=!0}}},[t._v(t._s(t.information.img_src?"修改":"添加"))])],1),i("div",{staticClass:"group"},[i("div",{staticClass:"label"},[t._v("*产品名称:")]),i("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"},{name:"model",rawName:"v-model",value:t.information.name,expression:"information.name"}],staticClass:"form-control",attrs:{type:"text",maxlength:"20",disabled:t.readOnly},domProps:{value:t.information.name},on:{input:function(e){e.target.composing||t.$set(t.information,"name",e.target.value)}}})]),i("div",{staticClass:"group"},[i("div",{staticClass:"label"},[t._v("*描述:")]),i("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"},{name:"model",rawName:"v-model",value:t.information.abs,expression:"information.abs"}],staticClass:"form-control",attrs:{type:"text",maxlength:"20",disabled:t.readOnly},domProps:{value:t.information.abs},on:{input:function(e){e.target.composing||t.$set(t.information,"abs",e.target.value)}}})]),i("div",{staticClass:"group"},[i("div",{staticClass:"label"},[t._v("*消息最多条数:")]),i("span",[t._v(t._s(t.information.msg_num)+"条")])]),i("div",{staticClass:"group"},[i("div",{staticClass:"label"},[t._v("*营销:")]),i("div",{staticClass:"box1"},[i("el-checkbox",{model:{value:t.information.is_show_order,callback:function(e){t.$set(t.information,"is_show_order",e)},expression:"information.is_show_order"}},[t._v("晒单营销")]),i("el-select",{model:{value:t.information.show_order_id,callback:function(e){t.$set(t.information,"show_order_id",e)},expression:"information.show_order_id"}},t._l(t.dryingList,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),i("div",{staticClass:"box2"},[i("el-checkbox",{model:{value:t.information.is_retransmission,callback:function(e){t.$set(t.information,"is_retransmission",e)},expression:"information.is_retransmission"}},[t._v("转发营销")]),i("el-select",{model:{value:t.information.retransmission_id,callback:function(e){t.$set(t.information,"retransmission_id",e)},expression:"information.retransmission_id"}},t._l(t.forwardList,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1)])])])]),t.readOnly?t._e():i("div",{staticClass:"btns"},[i("el-button",{attrs:{type:"info"},on:{click:function(e){return t.$emit("update:detailDialog",!1)}}},[t._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitInfo("detailForm")}}},[t._v("确定")])],1)],1),i("el-tab-pane",{attrs:{label:"资源配置",name:"resource"}},[t.resourceDialog?i("Resource",{attrs:{resourceDialog:t.resourceDialog,curSoucesList:t.resList.constitute||[],type:t.resourcesType,singleElection:!1,isShowType:!0},on:{"update:resourceDialog":function(e){t.resourceDialog=e},"update:resource-dialog":function(e){t.resourceDialog=e},select:t.addSelcet}}):t._e(),i("VaForm",{ref:"detailForm"},[i("form",{ref:"detailForm",staticClass:"detailForm"},[i("fieldset",{attrs:{disabled:t.readOnly}},[i("div",{staticClass:"group"},[t.readOnly?t._e():i("div",{staticClass:"btnRight"},[i("i",{staticClass:"el-icon-info"},[t._v("资源配置数量不能超过 "+t._s(t.information.msg_num)+" 条")]),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.addResour}},[t._v("添加")])],1)]),i("div",{staticClass:"group"},[i("table",{staticClass:"table border",attrs:{width:"100%"}},[i("thead",[i("tr",[i("th",{attrs:{width:"55"}},[i("span",[t._v("序号")])]),i("th",[t._v("名称")]),i("th",[t._v("关联图片")]),i("th",[t._v("自定义地址")]),i("th",[t._v("关联资源名称")]),i("th",{attrs:{width:"100"}},[t._v("操作")])])]),i("tbody",t._l(t.resList.constitute,function(e,a){return i("tr",[i("td",[i("span",[t._v(t._s(a+1))])]),i("td",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"item.name"}],staticClass:"form-control",domProps:{value:e.name},on:{input:function(i){i.target.composing||t.$set(e,"name",i.target.value)}}})]),i("td",[i("img",{ref:e.id,refInFor:!0,staticClass:"img",attrs:{src:e.img_src}}),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(i){return t.updateImg(e.id)}}},[t._v("选择")])],1),i("td",[i("el-input",{attrs:{placeholder:"若自定义地址，关联资源将会被丢弃",clearable:""},model:{value:e.preview,callback:function(i){t.$set(e,"preview",i)},expression:"item.preview"}})],1),i("td",[i("span",[t._v(t._s(e.resource_name))])]),i("td",[i("span",{staticClass:"icon icon-data",attrs:{title:"关联资源",type:"primary",size:"mini",plain:""},on:{click:function(i){return t.detailRes(e)}}}),i("span",{staticClass:"icon icon-delete",attrs:{title:"删除",type:"primary",size:"mini",plain:""},on:{click:function(i){return t.del(e)}}})])])}),0)])])])]),t.rersourceBtn?i("div",{staticClass:"btns"},[i("input",{ref:"updateImg",staticClass:"hide",attrs:{type:"file",accept:"image/jpeg,image/jpg,image/png"},on:{change:function(e){return t.update(e)}}}),i("el-button",{attrs:{type:"info"},on:{click:function(e){return t.$emit("update:detailDialog",!1)}}},[t._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitResource("detailForm")}}},[t._v("确定")])],1):t._e()])],1)],1)],1)},s=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return s})},1712:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-dialog",{attrs:{visible:t.qrcodeDetailVis,top:"50px",width:"800px","append-to-body":"",title:"二维码列表","before-close":t.close},on:{"update:visible":function(e){t.qrcodeDetailVis=e}}},[i("div",{staticClass:"content"},[i("table",{staticClass:"table"},[i("thead",[i("tr",[i("th",[t._v("名称")]),i("th",[t._v("描述")]),i("th",{attrs:{width:"150"}},[t._v("使用状态")]),i("th",[t._v("创建时间")]),i("th",{attrs:{width:"80"}},[t._v("操作")])])]),t.list?i("tbody",t._l(t.list,function(e){return i("tr",[i("th",[i("img",{staticClass:"cover-photo",attrs:{src:e.img_src}}),i("div",{staticClass:"th-name bookName",attrs:{title:e.name}},[t._v(t._s(e.name))])]),i("th",[i("div",{staticClass:"th-name"},[t._v(t._s(e.abs))])]),i("th",[i("div",{staticClass:"th-name"},[t._v(t._s(e.product_status_name))])]),i("th",[i("div",{staticClass:"th-name"},[t._v(t._s(e.create_time))])]),i("th",[i("div",{staticClass:"btns"},[i("el-button",{attrs:{type:"primary",size:"mini",disabled:"true"==e.product_status},on:{click:function(i){return t.chooseQrcode(e)}}},[t._v("选择")])],1)])])}),0):t._e()]),t.page?i("div",{staticClass:"pageWrap"},[i("el-pagination",{attrs:{small:!1,background:"","current-page":t.page.num,"page-sizes":[10,50,100],"page-size":t.page.offset,layout:"total, sizes,prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()])])],1)},s=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return s})},263:function(t,e,i){"use strict";i.r(e);var a=i(1674),s=i(891);for(var n in s)"default"!==n&&function(t){i.d(e,t,function(){return s[t]})}(n);i(1613);var r=i(0),o=Object(r.a)(s.default,a.a,a.b,!1,null,"3e9d694e",null);e.default=o.exports},641:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.request_get)("/api/marketing",t)},e.del=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.request_post)("/api/marketing/delete",t)},e.detail=function(t){var e=t.id,i=o(t,["id"]);return(0,s.request_get)(l({id:e}),i)},e.save=function(t){var e=t.id,i=o(t,["id"]);if(e)return(0,s.request_put)(l({id:e}),i);return(0,s.request_post)("/api/marketing",i)},e.getUseList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.request_get)(u(t))},e.getRecord=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.request_get)(c(t))};var a,s=i(16),n=i(21),r=(a=n)&&a.__esModule?a:{default:a};function o(t,e){var i={};for(var a in t)e.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(t,a)&&(i[a]=t[a]);return i}var l=r.default.compile("/api/marketing/:id"),c=r.default.compile("/api/marketing/record/:id"),u=r.default.compile("/api/marketing/used/:special_id")},660:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.request_get)("/api/qrcode_product",t)},e.del=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.request_post)("/api/qrcode_product/delete",t)},e.modifyStatus=d,e.detail=c,e.save=function(t){var e=t.id,i=o(t,["id"]);if(e)return(0,s.request_put)(l({id:e}),i);return(0,s.request_post)("/api/qrcode_product",i)},e.getResConf=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.request_get)(u(t),t)},e.saveProduct=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.request_put)("/api/qrcode_product/resource",t)};var a,s=i(16),n=i(21),r=(a=n)&&a.__esModule?a:{default:a};function o(t,e){var i={};for(var a in t)e.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(t,a)&&(i[a]=t[a]);return i}var l=r.default.compile("/api/qrcode_product/:id"),c=r.default.compile("/api/qrcode_product/:id"),u=r.default.compile("/api/qrcode_product/resource/:id"),d=r.default.compile("/api/qrcode_product/use/:id");function d(t){var e=t.id,i=o(t,["id"]);if(log(e,i,"xasssd"),e)return(0,s.request_put)(d({id:e}),i)}function c(t){var e=t.id,i=o(t,["id"]);return(0,s.request_get)(c({id:e}),i)}},891:function(t,e,i){"use strict";i.r(e);var a=i(892),s=i.n(a);for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);e.default=s.a},892:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t},s=i(293),n=(l(i(282)),function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(660))),r=l(i(1093)),o=i(49);function l(t){return t&&t.__esModule?t:{default:t}}e.default={components:{Detail:r.default},mixins:[s.main],data:function(){return{services:n,detailDialog:!1,detailDialoaType:"info",detailData:{}}},methods:a({opneDetailDialog:function(t,e){this.detailDialog=!0,this.detailData=e},addQrcodePro:function(){this.detailDialog=!0,this.detailData={}},modifyStatus:function(t,e){this.services.modifyStatus({status:e,id:t.id}).then(function(e){t.status=e.data.status,t.status_name=e.data.status_name})},getusedList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.page&&this.page.num||1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.page&&this.page.offset||10,i=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"true";this.services.getList(a({pageNum:t,pageOffset:e},s,{status:n})).then(function(t){i.setList(t.data),i.setPage(t.page)})},getnoUseList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.page&&this.page.num||1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.page&&this.page.offset||10,i=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"false";this.services.getList(a({pageNum:t,pageOffset:e},s,{status:n})).then(function(t){i.setList(t.data),i.setPage(t.page)})},setList:function(t){this.setSerieslist(t)},setPage:function(t){this.setSerieslistPage(t)},saveok:function(t){this.detailData.id||(this.detailData=t),this.getList()}},(0,o.mapMutations)(["setSerieslist","setSerieslistPage"])),computed:a({},(0,o.mapState)({list:function(t){return t.series.list},page:function(t){return t.series.page}}))}},893:function(t,e,i){"use strict";i.r(e);var a=i(894),s=i.n(a);for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);e.default=s.a},894:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=c(i(15)),s=(c(i(282)),function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(660))),n=i(641),r=c(i(284)),o=c(i(1611)),l=i(103);function c(t){return t&&t.__esModule?t:{default:t}}function u(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function a(s,n){try{var r=e[s](n),o=r.value}catch(t){return void i(t)}if(!r.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})}}e.default={props:["type","detailData","detailDialog","readOnly"],components:{Resource:r.default,Qrcode:o.default},created:function(){this.getMarketing(),this.detailData&&this.detailData.id&&this.getDetail()},data:function(){return{information:[],resourceData:this.detailData,resourceDialog:!1,resList:{constitute:[]},messages:[{name:"1条",value:"0"},{name:"2条",value:"1"},{name:"3条",value:"2"},{name:"4条",value:"3"},{name:"5条",value:"4"},{name:"6条",value:"5"},{name:"7条",value:"6"},{name:"8条",value:"7"}],selResourDialog:!1,rersourceBtn:!1,useDialog:!1,qrcodeDetailVis:!1,dryingList:[],forwardList:[],currentItem:{},currentRef:null,id:1e4,resourcesType:"1",parameter:{code_type:"agility"}}},methods:{getMarketing:function(){var t=this;(0,n.getList)({type:"retransmission"}).then(function(e){t.forwardList=e.data}),(0,n.getList)({type:"show_order"}).then(function(e){t.dryingList=e.data})},handleClick:function(t,e){"resource"==t.name?this.rersourceBtn=!0:this.rersourceBtn=!1},getResConf:function(){var t=this;s.getResConf({id:this.detailData.id}).then(function(e){t.resList=e.data,t.resList.constitute=e.data.constitute})},addSelcet:function(t,e){e[0]&&(this.currentItem.resource_id=e[0].id,this.currentItem.resource_name=e[0].name),this.resourceDialog=!1,this.selResourDialog=!1},getDetail:function(){var t=this;s.detail({id:this.detailData.id}).then(function(e){t.information=e.data,t.resList=e.data})},selResource:function(t,e){this.currentItem.resource_type=t,this.resourcesType=e,this.resourceDialog=!0},submitInfo:function(){var t=u(a.default.mark(function t(){var e=this;return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.save(this.information).then(function(t){e.detailData.id||(e.information=t.data),e.$message.success("操作成功!"),e.$emit("saveok",t.data)}).catch(function(t){e.$message({message:t.message||"错误!",type:"error"})});case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),submitResource:function(){var t=u(a.default.mark(function t(){var e=this;return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.detailData.id||this.$message.warning("请先保存产品!"),t.next=3,s.saveProduct({product_id:this.detailData.id,constitute:this.resList.constitute.map(function(t){return t.preview&&(t.resource_id=null),"add"==t.act&&(t.id=null),t})}).then(function(t){e.getDetail(),e.$message.success("保存成功")}).catch(function(t){e.$message({message:t.message||"错误!",type:"error"})});case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),chooseQrcode:function(t){this.information.img_src=t.img_src,this.information.msg_num=t.msg_num,this.information.qrcode_id=t.id,this.qrcodeDetailVis=!1},detailRes:function(t){this.currentItem=t,this.selResourDialog=!0},addResour:function(){this.id+=1,this.information.msg_num>this.resList.constitute.length?this.resList.constitute.push({act:"add",name:"",id:this.id}):this.$message.error("资源数量不能超过"+this.information.msg_num+"条")},updateImg:function(t){this.currentRef=t,this.$refs.updateImg.click()},update:function(t){var e=this;(0,l.getTask)(t.target.files[0]).then(function(t){if(e.currentRef){var i=e.resList.constitute.findIndex(function(t){return t.id===e.currentRef});e.$set(e.resList.constitute[i],"img_src",t.data.url),e.$set(e.resList.constitute[i],"img",t.data.path)}})},del:function(t){var e=this.resList.constitute.findIndex(function(e){return t.id==e.id});this.resList.constitute.splice(e,1)}}}},895:function(t,e,i){"use strict";i.r(e);var a=i(896),s=i.n(a);for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);e.default=s.a},896:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t},s=i(293),n=(l(i(282)),function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(653))),r=l(i(1093)),o=i(49);function l(t){return t&&t.__esModule?t:{default:t}}e.default={components:{Detail:r.default},props:["qrcodeDetailVis"],mixins:[s.main],data:function(){return{services:n,detailDialoaType:"info",detailData:{},readOnly:!1,parameter:{code_type:"agility"}}},created:function(){log(123456,this.qrcodeDetailVis)},methods:a({close:function(){this.$emit("update:qrcodeDetailVis",!1),this.isShow=!1},setList:function(t){this.setQrcodelist(t)},setPage:function(t){this.setQrcodelistPage(t)}},(0,o.mapMutations)(["setQrcodelist","setQrcodelistPage"]),{chooseQrcode:function(t){this.$emit("chooseQrcode",t)}}),computed:a({},(0,o.mapState)({list:function(t){return t.qrcode.list},page:function(t){return t.qrcode.page}}))}},897:function(t,e,i){},898:function(t,e,i){}}]);