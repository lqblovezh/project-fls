/*!
 * {
 *   "buildtime": "2019-06-17 15:13:29",
 *   "workspace": "F:\\project\\x-book4\\js",
 *   "username": "Administrator",
 *   "hostname": "PC201608171616",
 *   "platform": "win32",
 *   "git": {
 *     "branch": "master",
 *     "hash": "ecb058dd8",
 *     "message": [
 *       "commit ecb058dd8be16255580b36968fc3831fa41d5989",
 *       "Author: YangZai <552396385@qq.com>",
 *       "Date:   Mon Jun 17 15:12:32 2019 +0800",
 *       "    'xxxxx'"
 *     ],
 *     "user": "YangZai",
 *     "email": "552396385@qq.com",
 *     "remote": [
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (fetch)",
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (push)"
 *     ]
 *   }
 * }
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{1017:function(t,e,r){"use strict";var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("NormalWrap",[t.detail?r("div",{staticClass:"page-course-base c_f5_bg"},[r("Crumb",{attrs:{name:t.detail.name}}),r("div",{staticClass:"detail-card cbox c_f_bg"},[r("DetailCard",{attrs:{name:t.detail.name,price:t.detail.price,imgUrl:t.detail.img,des:t.detail.abs,star:t.detail.score,teacher:t.detail.teach_user.nick_name,studied:t.detail.user_speed_count,isBuy:t.detail.user_speed_buy_status,isAddClass:t.detail.studen_join_classs,isStudied:t.detail.end_speed_time,percentage:t.$tianKenPercentage(t.detail.user_speed_time_protion),startTime:t.detail.effective_duration_start,endTime:t.detail.effective_duration_end},on:{addCart:t.addCart,directBuy:t.directBuy,addCourse:t.addCourse,study:t.study,starChange:t.starChange}})],1),r("div",{staticClass:"tabs cbox"},[r("div",{staticClass:"conatiner c_f_bg"},[r("div",{staticClass:"nav"},[r("div",{staticClass:"ls c_e0_bd"},t._l(t.courseNav,function(e,i){return r("div",{key:e.name,staticClass:"item ib active_border",class:{active:t.currActive.indexOf(i)>0},on:{click:function(r){return t.go(e)}}},[t._v(t._s(e.name))])}),0)]),t.detail?r("div",{staticClass:"router"},[r("router-view")],1):t._e()])])],1):t._e()]),r("div",{staticClass:"dialog"},[r("el-dialog",{attrs:{title:"加入班级",visible:t.isCourseDialogShow,width:"40%",top:"4%"},on:{"update:visible":function(e){t.isCourseDialogShow=e}}},[r("DialogAddCourse",{on:{success:t.addClazzBackHandler}})],1)],1)],1)},a=[];r.d(e,"a",function(){return i}),r.d(e,"b",function(){return a})},1046:function(t,e,r){"use strict";var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"comp-detail-card pr"},[r("div",{staticClass:"img"},[r("img",{attrs:{src:t.imgUrl}})]),r("div",{staticClass:"other ib vt f14 c_6"},[r("div",{staticClass:"name f18 c_3"},[t._v(t._s(t.name))]),r("div",{staticClass:"progress"},[r("MyProgress",{attrs:{type:"line",color:"#00b43c",percentage:t.percentage,showText:!0,width:80}})],1),t.star||0==t.star?r("div",{staticClass:"star"},[r("el-rate",{attrs:{"allow-half":!0,value:t.starNum/2},on:{change:t.starChange}})],1):t._e(),t.teacher?r("div",[r("span",[t._v("教师名称：")]),r("span",[t._v(t._s(t.teacher)+"  ")])]):t._e(),r("div",[r("span",{staticClass:"mr15"},[t._v("已学人数："+t._s(t.studied))]),r("span",[t._v("课程学习时段："+t._s(t._f("time")(t.startTime))+" ~ "+t._s(t._f("time")(t.endTime)))])]),t.isBuy?0===Number(t.price)?r("div",{staticClass:"price c_price f20"},[r("span",[t._v("免费")])]):r("div",[r("span",{staticClass:"price c_price f20"},[t._v("已购买")])]):r("div",[r("span",[t._v("价格：")]),r("span",{staticClass:"price c_price f26"},[t._v(t._s(t.$price(t.price)))])]),r("div",{staticClass:"btns f18"},[t.isBuy?t._e():r("div",{staticClass:"gp"},[r("Tbutton",{attrs:{type:"og",icon:"cart-white"},nativeOn:{click:function(e){return t.addCart(e)}}},[t._v("加入购物车")]),r("Tbutton",{attrs:{type:"og_plain"},nativeOn:{click:function(e){return t.directBuy(e)}}},[t._v("直接购买    ")])],1),t.isBuy?r("div",{staticClass:"gp"},[r("Tbutton",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.study(e)}}},[t._v(t._s(t.studyName)+"   ")])],1):t._e(),r("div",{staticClass:"ib gp"},[t.isAddClass?t._e():r("Tbutton",{attrs:{type:"primary_plain"},nativeOn:{click:function(e){return t.addCourse(e)}}},[t._v("班级加入")])],1)])]),r("div",{staticClass:"share pa"},[r("ShareMy",{attrs:{description:t.des,title:t.name,image:"imgUrl",murl:t.murl}})],1)])},a=[];r.d(e,"a",function(){return i}),r.d(e,"b",function(){return a})},1049:function(t,e,r){"use strict";var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"comp-add-course-dialog"},[r("div",{staticClass:"wrap"},[r("table",{staticClass:"table"},[t._m(0),r("tbody",t._l(t.list,function(e){return r("tr",{key:e.id},[r("td",[r("div",{staticClass:"div"},[t._v(t._s(e.class_name)+"    ")])]),r("td",[r("div",{staticClass:"btns c_theme f14",on:{click:function(r){return t.btnsClickHandler(e,r)}}},[r("span",[t._v("加入")])])])])}),0)])])])},a=[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("班级名称")]),e("th",[this._v("操作")])])])}];r.d(e,"a",function(){return i}),r.d(e,"b",function(){return a})},422:function(t,e,r){"use strict";r.r(e);var i=r(1017),a=r(591);for(var s in a)"default"!==s&&function(t){r.d(e,t,function(){return a[t]})}(s);r(936);var n=r(0),c=Object(n.a)(a.default,i.a,i.b,!1,null,null,null);e.default=c.exports},591:function(t,e,r){"use strict";r.r(e);var i=r(592),a=r.n(i);for(var s in i)"default"!==s&&function(t){r.d(e,t,function(){return i[t]})}(s);e.default=a.a},592:function(t,r,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=o(i(5)),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},n=o(i(933)),c=o(i(935)),u=i(22);function o(t){return t&&t.__esModule?t:{default:t}}r.default={components:{DetailCard:n.default,DialogAddCourse:c.default},asyncData:function(t){var e=t.store,r=t.route;return e.dispatch("course/getData",r.query)},created:function(){this.init()},mounted:function(){var t,e=this;return(t=a.default.mark(function t(){return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.dataPromise;case 2:e.detail.pass||/\/course\/detail/.test(e.$route.path)||e.$replace("/course/detail",e.$route.query);case 3:case"end":return t.stop()}},t,e)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,r){return function i(a,s){try{var n=e[a](s),c=n.value}catch(t){return void r(t)}if(!n.done)return Promise.resolve(c).then(function(t){i("next",t)},function(t){i("throw",t)});t(c)}("next")})})()},beforeDestroy:function(){this.$store.state.course.courseDetail=null},beforeRouteUpdate:function(t,e,r){t.query.id!==e.query.id&&this.$store.dispatch("course/getData",t.query),r()},data:function(){return{courseNav:{detail:{name:"课程介绍",path:"/course/detail"},step:{name:"课程步骤",path:"/course/step"},discuss:{name:"学习讨论",path:"/course/discuss"},answer:{name:"教师答疑",path:"/course/answer"},teacher:{name:"教师",path:"/course/teacher"},exam:{name:"在线测试",path:"/course/examList"}},isCourseDialogShow:!1}},computed:s({},(0,u.mapState)({detail:function(t){return t.course.courseDetail},cart:function(t){return t.cart}}),(0,u.mapGetters)(["cartList","totalCart"]),{currActive:function(){return this.$route.path}}),methods:{init:function(){},go:function(t){if("/course/detail"!==t.path){if(this.$user,!this.$user)return void this.$message.error("请先登陆!");if(!this.detail.pass)return void this.$message.error("请先购买!")}this.$go(t.path,{id:this.$route.query.id})},addCart:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=[this.detail.id],i=this.detail,a={id:i.id,name:i.name,abs:i.abs,price:i.price,img:i.img,checked:!0};this.$user&&this.$service.cart.add({ids:r}).catch(function(e){t.$delete(t.cart,a.id),t.$message.error("失败!")}),this.$set(this.cart,a.id,a),e||this.$message.success("添加成功!")},addLocalCart:function(){var t=this.detail,e={id:t.id,name:t.name,abs:t.abs,price:t.price,img:t.img,checked:!0};this.$set(this.cart,e.id,e)},directBuy:function(){var t=this;this.$isUser()&&(this.addCart(!0),this.cartList.forEach(function(e){e.id===t.detail.id?e.checked=!0:e.checked=!1}),this.$go("/cart"))},addCourse:function(){this.isCourseDialogShow=!0},study:function(){var t=this;this.$isUser()&&this.detail.user_speed_buy_status&&(100!=parseInt(this.detail.user_speed_time_protion)?this.$go("/video",{course_id:this.$route.query.id}):this.$service.course.resetCourseTime({id:[this.detail.id]}).then(function(e){t.$store.dispatch("course/getData",t.$route.query)}).catch(function(t){console.warn(""+e.toString())}))},addClazzBackHandler:function(){this.isCourseDialogShow=!1},starChange:function(t){}}}},593:function(t,e,r){"use strict";r.r(e);var i=r(594),a=r.n(i);for(var s in i)"default"!==s&&function(t){r.d(e,t,function(){return i[t]})}(s);e.default=a.a},594:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,a=r(5),s=(i=a)&&i.__esModule?i:{default:i};e.default={props:{name:{type:String,default:""},des:{default:""},star:{},studied:{default:0},imgUrl:{},peopleType:{},price:{},teacher:{},isBuy:{},isAddClass:{},isStudied:{},percentage:{default:0},startTime:{},endTime:{}},data:function(){return{starNum:0,murl:""}},computed:{studyName:function(){return 100==this.percentage?"重新学习":this.isStudied?"继续学习":"开始学习"}},watch:{star:function(){this.starNum=this.star}},created:function(){this.starNum=this.star},mounted:function(){},methods:{addCart:function(){this.$emit("addCart")},directBuy:function(){this.$emit("directBuy")},addCourse:function(){this.$emit("addCourse")},study:function(){this.$emit("study")},starChange:function(t){var e,r=this;return(e=s.default.mark(function e(){var i;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.$isUser()){e.next=3;break}return r.val=r.star,e.abrupt("return");case 3:return i=r.$route.query.id,e.next=6,r.$service.course.setScore({course_id:i,score:2*t}).then(function(t){r.$message.success("评分成功!")}).catch(function(t){r.$message.error(t.payload.errors[0])});case 6:r.$service.course.getScore({course_id:i}).then(function(t){r.starNum=t.data});case 7:case"end":return e.stop()}},e,r)}),function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function i(a,s){try{var n=t[a](s),c=n.value}catch(t){return void r(t)}if(!n.done)return Promise.resolve(c).then(function(t){i("next",t)},function(t){i("throw",t)});e(c)}("next")})})()}},filters:{time:function(t){if(!t)return t;var e=t.match(/\d{4}-\d{2}-\d{2}/);return e?e[0]:t}}}},595:function(t,e,r){},596:function(t,e,r){"use strict";r.r(e);var i=r(597),a=r.n(i);for(var s in i)"default"!==s&&function(t){r.d(e,t,function(){return i[t]})}(s);e.default=a.a},597:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},a=r(22);e.default={props:{},computed:i({},(0,a.mapState)({list:function(t){return t.course.clazzList}}),(0,a.mapGetters)(["cartList","totalCart"]),{currActive:function(){return this.$route.path}}),methods:{btnsClickHandler:function(t){var e=this;this.$isUser()&&this.$prompt("请输入授权码","加入班级",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(r){var i=r.value;return e.$service.clazz.addClazz({id:t.id,code:i})}).then(function(t){e.$message.success("加入成功!"),location.reload()}).catch(function(){e.$message.error("授权码已过期!"),e.$emit("success")})}}}},598:function(t,e,r){},933:function(t,e,r){"use strict";r.r(e);var i=r(1046),a=r(593);for(var s in a)"default"!==s&&function(t){r.d(e,t,function(){return a[t]})}(s);r(934);var n=r(0),c=Object(n.a)(a.default,i.a,i.b,!1,null,null,null);e.default=c.exports},934:function(t,e,r){"use strict";var i=r(595);r.n(i).a},935:function(t,e,r){"use strict";r.r(e);var i=r(1049),a=r(596);for(var s in a)"default"!==s&&function(t){r.d(e,t,function(){return a[t]})}(s);var n=r(0),c=Object(n.a)(a.default,i.a,i.b,!1,null,null,null);e.default=c.exports},936:function(t,e,r){"use strict";var i=r(598);r.n(i).a}}]);