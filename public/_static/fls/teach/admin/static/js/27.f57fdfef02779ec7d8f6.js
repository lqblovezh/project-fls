/*!
 * {
 *   "buildtime": "2019-06-14 15:40:00",
 *   "workspace": "F:\\project\\x-book4\\js",
 *   "username": "Administrator",
 *   "hostname": "PC201608171616",
 *   "platform": "win32",
 *   "git": {
 *     "branch": "master",
 *     "hash": "cc62e1956",
 *     "message": [
 *       "commit cc62e195633d44aadf65545d70d92ce1a5c1c701",
 *       "Author: YangZai <552396385@qq.com>",
 *       "Date:   Fri Jun 14 15:39:28 2019 +0800",
 *       "    'xxx'"
 *     ],
 *     "user": "YangZai",
 *     "email": "552396385@qq.com",
 *     "remote": [
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (fetch)",
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (push)"
 *     ]
 *   }
 * }
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1460:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUserInfo=function(e){return(0,o.request_get)(i({id:e}))},t.userInfo=i,t.update=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_put)(i(e),e)};var a,o=n(49),r=n(82);var i=((a=r)&&a.__esModule?a:{default:a}).default.compile("/common/api/user/users/detail/:user_id");function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_put)("/common/api/user/users/detail",e)}},1461:function(e,t,n){"use strict";var a=n(706);n.n(a).a},1501:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"box"},[n("div",{staticClass:"div"},[n("div",{staticClass:"content1"},[n("VaForm",{ref:"detailForm"},[n("div",{staticClass:"left"},[n("div",{staticClass:"touxiang"},[n("img",{attrs:{src:e.userInfo.picture_absolute}})]),n("div",{staticClass:"name"},[n("span",[e._v(e._s(e.userInfo.name))])]),n("div",{staticClass:"change"},[n("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return e.$refs.picture.click()}}},[e._v("修改")]),n("input",{ref:"picture",staticClass:"hide",attrs:{type:"file"},on:{change:function(t){return e.previewImg(t)}}})],1)]),n("div",{staticClass:"right"},[n("el-form",{attrs:{"label-width":"80px"}},[n("el-form-item",{attrs:{label:"名称:"}},[n("el-input",{model:{value:e.userInfo.nick_name,callback:function(t){e.$set(e.userInfo,"nick_name",t)},expression:"userInfo.nick_name"}})],1),n("el-form-item",{attrs:{label:"性别:"}},[n("el-input",{model:{value:e.userInfo.sex,callback:function(t){e.$set(e.userInfo,"sex",t)},expression:"userInfo.sex"}})],1),n("el-form-item",{attrs:{label:"出生日:"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"出生日期","default-time":["00:00:00"]},on:{change:e.handleChange},model:{value:e.userInfo.date_of_birth,callback:function(t){e.$set(e.userInfo,"date_of_birth",t)},expression:"userInfo.date_of_birth"}})],1),n("el-form-item",{attrs:{label:"学历:"}},[n("el-input",{model:{value:e.userInfo.education,callback:function(t){e.$set(e.userInfo,"education",t)},expression:"userInfo.education"}})],1),n("el-form-item",{attrs:{label:"电话:"}},[n("el-input",{model:{value:e.userInfo.phone,callback:function(t){e.$set(e.userInfo,"phone",t)},expression:"userInfo.phone"}})],1),n("el-form-item",{attrs:{label:"邮箱:"}},[n("el-input",{model:{value:e.userInfo.email,callback:function(t){e.$set(e.userInfo,"email",t)},expression:"userInfo.email"}})],1),n("el-form-item",{attrs:{label:"院系:"}},[n("el-input",{model:{value:e.userInfo.college,callback:function(t){e.$set(e.userInfo,"college",t)},expression:"userInfo.college"}})],1),n("el-form-item",{attrs:{label:"职务:"}},[n("el-input",{model:{value:e.userInfo.duties,callback:function(t){e.$set(e.userInfo,"duties",t)},expression:"userInfo.duties"}})],1),n("el-form-item",{attrs:{label:"简介:"}},[n("el-input",{model:{value:e.userInfo.summary,callback:function(t){e.$set(e.userInfo,"summary",t)},expression:"userInfo.summary"}})],1),n("el-form-item",{attrs:{label:"提成比例:"}},[n("span",{staticClass:"text",domProps:{textContent:e._s(e.userInfo.app_setting&&e.userInfo.app_setting.profit_ratio)}})]),n("el-form-item",{attrs:{label:"钱包余额:"}},[n("span",{staticClass:"text",domProps:{textContent:e._s(e.userInfo.statistics&&e.userInfo.statistics.balances)}})])],1),n("div",{staticClass:"changePass"},[n("el-button",{attrs:{type:"primary",size:"small",plain:""}},[e._v("提现")]),n("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return e.changePass()}}},[e._v("修改登录密码")]),n("el-dialog",{staticClass:"noPadding",attrs:{visible:e.loginDialog,width:"420px","close-on-click-modal":!1,"lock-scroll":!1,"append-to-body":!0},on:{"update:visible":function(t){e.loginDialog=t}}},[n("div",{staticClass:"top",attrs:{slot:"title"},slot:"title"},[n("el-tabs",{attrs:{value:"pass"}},[n("el-tab-pane",{attrs:{label:"修改密码",name:"pass"}})],1)],1),n("form",{ref:"passForm",staticClass:"passContent"},[n("div",{staticClass:"group"},[n("div",{staticClass:"label"},[e._v("旧密码:")]),n("input",{staticClass:"form-control",attrs:{name:"old_pass",type:"password"}})]),n("div",{staticClass:"group"},[n("div",{staticClass:"label"},[e._v("新密码:")]),n("input",{staticClass:"form-control",attrs:{name:"new_pass",type:"password"}})]),n("div",{staticClass:"group"},[n("div",{staticClass:"label"},[e._v("新密码确认:")]),n("input",{staticClass:"form-control",attrs:{name:"new_pass_confirm",type:"password"}})])]),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.loginDialog=!1}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.changePassword}},[e._v("确 定")])],1)])],1)],1)])],1),n("div",{staticClass:"bottom"},[n("input",{ref:"picture",staticClass:"hide",attrs:{type:"file",accept:e.$config.imgAccept},on:{change:function(t){return e.previewImg(t)}}}),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit()}}},[e._v("确定")])],1)])])},o=[];n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o})},262:function(e,t,n){"use strict";n.r(t);var a=n(1501),o=n(704);for(var r in o)"default"!==r&&function(e){n.d(t,e,function(){return o[e]})}(r);n(1461);var i=n(0),s=Object(i.a)(o.default,a.a,a.b,!1,null,"0075532c",null);t.default=s.exports},277:function(e,t){var n=/^(?:submit|button|image|reset|file)$/i,a=/^(?:input|select|textarea|keygen)/i,o=/(\[[^\[\]]*\])/g;function r(e,t,n){if(t.match(o)){!function e(t,n,a){if(0===n.length)return t=a;var o=n.shift(),r=o.match(/^\[(.+?)\]$/);if("[]"===o)return t=t||[],Array.isArray(t)?t.push(e(null,n,a)):(t._values=t._values||[],t._values.push(e(null,n,a))),t;if(r){var i=r[1],s=+i;isNaN(s)?(t=t||{})[i]=e(t[i],n,a):(t=t||[])[s]=e(t[s],n,a)}else t[o]=e(t[o],n,a);return t}(e,function(e){var t=[],n=new RegExp(o),a=/^([^\[\]]*)/.exec(e);for(a[1]&&t.push(a[1]);null!==(a=n.exec(e));)t.push(a[1]);return t}(t),n)}else{var a=e[t];a?(Array.isArray(a)||(e[t]=[a]),e[t].push(n)):e[t]=n}return e}function i(e,t,n){return n=n.replace(/(\r)?\n/g,"\r\n"),n=(n=encodeURIComponent(n)).replace(/%20/g,"+"),e+(e?"&":"")+encodeURIComponent(t)+"="+n}e.exports=function(e,t){"object"!=typeof t?t={hash:!!t}:void 0===t.hash&&(t.hash=!0);for(var o=t.hash?{}:"",s=t.serializer||(t.hash?r:i),u=e&&e.elements?e.elements:[],l=Object.create(null),c=0;c<u.length;++c){var f=u[c];if((t.disabled||!f.disabled)&&f.name&&a.test(f.nodeName)&&!n.test(f.type)){var p=f.name,d=f.value;if("checkbox"!==f.type&&"radio"!==f.type||f.checked||(d=void 0),t.empty){if("checkbox"!==f.type||f.checked||(d=""),"radio"===f.type&&(l[f.name]||f.checked?f.checked&&(l[f.name]=!0):l[f.name]=!1),void 0==d&&"radio"==f.type)continue}else if(!d)continue;if("select-multiple"!==f.type)o=s(o,p,d);else{d=[];for(var m=f.options,v=!1,h=0;h<m.length;++h){var g=m[h],_=t.empty&&!g.value,b=g.value||_;g.selected&&b&&(v=!0,o=t.hash&&"[]"!==p.slice(p.length-2)?s(o,p+"[]",g.value):s(o,p,g.value))}!v&&t.empty&&(o=s(o,p,""))}}}if(t.empty)for(var p in l)l[p]||(o=s(o,p,""));return o}},282:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTask=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];return e.size,e.size>=1048576?(t.is_chunk=!0,(0,a.request_post)("/common/api/files/upload_task?r="+Math.random(5)).then(function(o){if(o.status)return t.task_id=o.data.task_id,(0,a.request_file)("/common/api/files/upload",{file:e,data:t},n);throw new Error(o.messages)}).catch(function(e){throw new Error("上传失败")})):(t.is_chunk=!1,(0,a.request_file)("/common/api/files/upload",{file:e,data:t}))},t.getAppId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_get)("/common/api/app/search_name",e).then(function(e){return o.default.app_id=e.data.id,sessionStorage.app_id=e.data.id,e})},t.getClientToken=function(){return(0,a.request_post)("/common/api/auth/token/pcclient")},t.platInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_get)(s(e)).then(function(e){return o.default.app_id=e.data.id,sessionStorage.app_id=e.data.id,document.title=e.data.name,e})},t.commonPreview=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_get)(l(e))},t.getDefaultCover=function(){return(0,a.request_get)("/api/videos/images")},t.generate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/qr_code/generate",e)},t.commonPreviewCode=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/api/preview",e)},t.getQrcode=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_get)("/common/api/get_qrcode",e)},t.synchronization=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_get)(u(e)).then(function(e){return e})},t.getAuthor=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_get)("/api/ecommerce/author",e)},t.addAuthor=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/api/ecommerce/author",e)},t.getWeixinConfig=function(e){return(0,a.request_get)("/common/api/third/wx_js_sdk/config",e)},t.getIndexInfo=function(){return(0,a.request_get)("/common/api/current")};i(n(19));var a=n(49),o=i(n(50)),r=i(n(82));function i(e){return e&&e.__esModule?e:{default:e}}r.default.compile("/common/api/files/upload_task/:id"),r.default.compile("/common/api/manager/managers/:id"),r.default.compile("/common/api/manager/roles/:id");var s=r.default.compile("/common/api/app/apps/:id"),u=r.default.compile("/common/api/dragon_infos/:id");var l=r.default.compile("/api/preview/:id")},414:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.register=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/user/register",e)},t.login=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/auth/login/user",e).then(function(e){return window.sessionStorage.setItem("token",e.data.token),window.localStorage.setItem("token",e.data.token),r.default.token=e.data.token,e})},t.thirdLogin=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.back_url.match(/.*(\?.*)#.*/),n=t&&t[1];n&&(e.back_url=e.back_url.replace(n,""));return(0,a.request_post)("/common/api/auth/third/link",e)},t.phoneLogin=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/auth/login_by_phone/phone",e).then(function(e){return window.sessionStorage.setItem("token",e.data.token),window.localStorage.setItem("token",e.data.token),r.default.token=e.data.token,e})},t.codeImage=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=Math.random().toFixed(3);return(0,a.request_get)("/common/api/captcha/image?code="+e)},t.codeCheck=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/captcha/check",e)},t.codePhone=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/captcha/mobile",e)},t.codeEmail=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/captcha/email",e)},t.getUserInfo=function(){return(0,a.request_get)("/api/auth/is_login/user")},t.save=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_put)("/common/api/user",e)},t.loginOut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/auth/logout",e).then(function(e){return window.sessionStorage.removeItem("token"),window.sessionStorage.removeItem("userInfo"),r.default.token=null,e})},t.changePass=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_put)("/common/api/auth/pass",e).then(function(e){return window.sessionStorage.removeItem("token"),window.sessionStorage.removeItem("userInfo"),r.default.token=null,e})},t.saveMemberData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_put)(s(e),e)};var a=n(49),o=i(n(82)),r=(i(n(19)),i(n(50)));function i(e){return e&&e.__esModule?e:{default:e}}var s=o.default.compile("/common/api/user/:id")},704:function(e,t,n){"use strict";n.r(t);var a=n(705),o=n.n(a);for(var r in a)"default"!==r&&function(e){n.d(t,e,function(){return a[e]})}(r);t.default=o.a},705:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(n(20)),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=c(n(277)),i=n(51),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1460)),u=(c(n(19)),n(414)),l=n(282);function c(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{loginDialog:!1,user:{},previewImgUrl:null,imgFile:null,userInfo:{}}},created:function(){this.init()},methods:o({},(0,i.mapMutations)(["updateUser"]),{init:function(){this.userInfo=o({},this.$config.userInfo.user)},changePass:function(){this.loginDialog=!0},previewImg:function(e){var t=e.target.files[0],n=URL.createObjectURL(t);this.$set(this.userInfo,"picture_absolute",n)},submit:function(){var e,t=this;return(e=a.default.mark(function e(){var n,o,r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.$refs.picture.files[0],t.$refs.detailForm.valiAll()){e.next=4;break}return e.abrupt("return");case 4:if(o=t.$loading({text:"正在上传",background:"rgba(0, 0, 0, 0.8)"}),e.prev=5,!n){e.next=9;break}return e.next=9,(0,l.getTask)(n).then(function(e){t.userInfo.picture=e.data.path});case 9:return e.next=11,s.userInfo(t.userInfo).then(function(e){e.status&&(t.$message.success("修改成功"),o.close()),sessionStorage.userInfo=JSON.stringify(e.data),t.$emit("detailBack")});case 11:e.next=18;break;case 13:e.prev=13,e.t0=e.catch(5),r=e.t0.payload,o.close(),t.$message.error(r.message);case 18:case"end":return e.stop()}},e,t,[[5,13]])}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function a(o,r){try{var i=t[o](r),s=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(s).then(function(e){a("next",e)},function(e){a("throw",e)});e(s)}("next")})})()},changePassword:function(){var e=this,t=(0,r.default)(this.$refs.passForm,{hash:!0});(0,u.changePass)(t).then(function(t){e.$message.success("修改密码成功！"),e.loginDialog=!1,window.location.href="/"})},handleChange:function(e){this.userInfo.date_of_birth=new Date(e).toLocaleString().split(" ")[0]}})}},706:function(e,t,n){}}]);