/*!
 * {
 *   "buildtime": "2019-05-31 16:22:54",
 *   "workspace": "F:\\X-BOOK\\xcloud\\x-book4\\js",
 *   "username": "LQB",
 *   "hostname": "DESKTOP-QL56OJS",
 *   "platform": "win32",
 *   "git": {
 *     "branch": "master",
 *     "hash": "fbc007935",
 *     "message": [
 *       "commit fbc00793544e5767db1868f95f89c64b93f3aa79",
 *       "Author: 骆秋波 <1277678760@qq.com>",
 *       "Date:   Fri May 31 15:21:03 2019 +0800",
 *       "    打包上传"
 *     ],
 *     "user": "骆秋波",
 *     "email": "1277678760@qq.com",
 *     "remote": [
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (fetch)",
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (push)"
 *     ]
 *   }
 * }
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{196:function(e,t,r){"use strict";r.r(t);var o=r(854),n=r(409);for(var a in n)"default"!==a&&function(e){r.d(t,e,function(){return n[e]})}(a);r(751);var i=r(0),u=Object(i.a)(n.default,o.a,o.b,!1,null,"3cf6d9bb",null);t.default=u.exports},409:function(e,t,r){"use strict";r.r(t);var o=r(410),n=r.n(o);for(var a in o)"default"!==a&&function(e){r.d(t,e,function(){return o[e]})}(a);t.default=n.a},410:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=f(r(5)),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},i=f(r(239)),u=d(r(631)),s=r(6),c=d(r(749));d(r(750));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function f(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function o(n,a){try{var i=t[n](a),u=i.value}catch(e){return void r(e)}if(!i.done)return Promise.resolve(u).then(function(e){o("next",e)},function(e){o("throw",e)});e(u)}("next")})}}t.default={name:"Reader",mounted:function(){var e=this;this.query=this.$route.query,i.default.getItem("access_code").then(function(t){e.access_code=t,e.init()})},data:function(){return{access_code:"",isNav:!0,query:{},isShowX:!1,infoData:null,preChapterId:0,curChapterId:0}},computed:a({},(0,s.mapState)({})),methods:{getInfo:function(){return c.info(this.query)},getUserId:function(){if(sessionStorage.userInfo){var e=JSON.parse(sessionStorage.userInfo);return e&&e.id||""}return""},getAccessCodes:function(e){var t=this;return l(o.default.mark(function r(){return o.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,c.getAccessCode(e).then(function(e){t.access_code=e.data});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r,t)}))()},closeNav:function(){this.isNav=!1},openNav:function(){this.isNav=!0},init:function(){var e=this;return l(o.default.mark(function t(){var r;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(reader3){t.next=2;break}return t.abrupt("return");case 2:({id:e.query.id,type:3}),null,e.query.range&&JSON.parse(e.query.range).start,void 0,e.query.chapter_root?e.query.chapter_root.split(" ")[1]:null,(r=new reader3.Mobile({restUrl:"http://xcloud.kf.gli.cn/publish/reader",imagePath:"/res",services:a({},u,{go_back:function(){r.unmount(),r=null,e.$router.go(-1)},request_full_screen:function(){e.isNav=!1},exit_full_screen:function(){e.isNav=!0},show_toast:function(t){e.$Toast({message:t})},show_confirm:function(t){return e.$confirm(t).then(function(e){return!0}).catch(console.log)},do_share:function(e,t){e.bookId,e.bookName,e.chapterRid,e.chapterName},action_control:function(t,r){t.type,t.action;var o=!0,n=!1,a=void 0;try{for(var i,u=t[Symbol.iterator]();!(o=(i=u.next()).done);o=!0){var s=i.value,c=s.type;return"read"!=s.action||"chapter"!=c&&"section"!=c||(e.$MessageBox.confirm("您还未购买该章节，前往购买？").then(function(t){if(void 0!==e.$route.query.from){e.$route.query.id;e.$go("-1")}e.$router.go(-1)}).catch(function(){void 0!==e.$route.query.from&&e.$router.go(-1)}),!1)}}catch(e){n=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(n)throw a}}}}),fontSize:{list:[{title:"小",value:"14px"},{title:"中",value:"16px"},{title:"大",value:"18px"},{title:"特大",value:"20px"}],index:0},copyEnabled:!0,fullScreenEnabled:!1,searchEnabled:!0,preloadEnabled:!0,goBackEnabled:!0,toolBarActions:[].filter(function(e){return e}),defaultPageLayout:"slide",defaultTextLayout:"lr/auto",readModeList:[{title:"无",pageLayout:"slide",textLayout:"lr/static",scope:"mobile"},{title:"分页",pageLayout:"normal",textLayout:"lr/auto"},{title:"平滑",pageLayout:"slide",textLayout:"lr/auto",scope:"mobile"}]})).emitter.on("updateURL",function(t){if(void 0!=n(t.chapterRid)){var r=decodeURIComponent(e.$route.fullPath),o=void 0,a=void 0;void 0===e.$route.query.chapter_id?(a=t.chapterRid,o=(o=r.replace("index=root","index=root "+a))+"&chapter_id="+a):(a=e.$route.query.chapter_id,o=r.replace(new RegExp("\\b"+a+"\\b","g"),t.chapterRid)),e.preChapterId=a,e.curChapterId=t.chapterRid,e.$router.replace(o)}}),r.extraParams={version:"release",content_version:"release",access_code:e.access_code,product_id:e.query.product_id,user_id:e.getUserId(),release_id:e.query.id},setTimeout(function(){r.mount(e.$refs.root,{bookId:e.query.book_id})},30);case 11:case"end":return t.stop()}},t,e)}))()}}}},424:function(e,t,r){},631:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],o=!0,n=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(o=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){n=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(n)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e};t.get_book=function(e,t){var r=e.bookId,o=t.extraParams;return(0,s.request_post)(c+"/reader/books",n({book_id:r},o)).then(function(e){var t=e.data;return t})},t.get_catalogs=function(e,t){var r=e.bookId,o=e.chapterId,a=t.extraParams;return(0,s.request_post)(c+"/reader/catalogs",n({book_id:r,catalog_pid:o},a)).then(function(e){var t=e.data;return t})},t.get_chapters=function(e,t){var r=e.bookId,o=e.chapterIds,a=t.extraParams;return(0,s.request_post)(c+"/reader/chapters",n({chapter_id:o,book_id:r},a)).then(function(e){var t=e.data;return t})},t.search=function(e,t){var r=e.keyword,o=e.bookId,a=e.page,i=e.chapterRid,u=t.extraParams;return(0,s.request_post)(c+"/reader/search",n({keyword:r,book_id:o,chapter_id:i,pageStart:a.start,pageOffset:a.offset},u)).then(function(e){var t=e.data,r=e.page;return{list:t,page:r}})},t.get_labels=function(e,t){var r=e.bookId,o=t.extraParams;return(0,s.request_get)("/api/book_notes",{book_id:r,user_id:o.user_id}).then(function(e){var t=e.data;return t})},t.add_label=function(e,t){var r=e.bookId,o=e.chapterRid,a=e.chapterName,i=e.userText,u=e.rangeJSON,c=e.selectedText,d=e.status,f=t.extraParams;return(0,s.request_post)("/api/book_notes",n({book_id:r,chapter_id:o,chapter_name:a,chapter_value:c,comm_text:i,range:u,protected:d},f)).then(function(e){var t=e.data;return t})},t.get_bookmarks=function(e,t){var r=e.bookId,o=t.extraParams;return(0,s.request_get)("/api/book_marks",{book_id:r,user_id:o.user_id}).then(function(e){var t=e.data;return t})},t.add_bookmark=function(e,t){var r=e.bookId,o=e.chapterRid,a=e.chapterName,i=e.rangeJSON,u=e.text,c=t.extraParams;return(0,s.request_post)("/api/book_marks",n({book_id:r,chapter_id:o,chapter_name:a,chapter_value:u,range:i},c)).then(function(e){var t=e.data;return t})},t.remove_bookmarks=function(e,t){d(e,t)},t.remove_labels=function(e,t){d(e,t)},t.modify_label=function(e){return e.range=JSON.stringify(e.range),e.comm_text=e.userText,delete e.userText,(0,s.request_put)("/api/book_notes",n({},e)).then(function(e){return e.data})},t.backup_setting=function(e){return(0,s.request_post)("/api/user_read_setting",{data:JSON.stringify(e)})},t.restore_setting=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,s.request_get)("/api/user_read_setting").then(function(e){var t=e.data,r=u.default.isArray(t)&&t[0]||t;return r?JSON.parse(r):{}})},t.set_progress=function(e,t){var r=e.bookId,o=(e.chapterRid,e.progressJSON),n=e.percentJSON,a=t.extraParams;return(0,s.request_post)("/api/read_record",{data:o,proportion:n,release_id:a.release_id,book_id:r})},t.get_progress=function(e,t){var r=e.bookId,n=t.extraParams;return(0,s.request_get)("/api/read_record",{book_id:r,release_id:n.release_id}).then(function(e){var t=o(e.data,1),r=t[0];return r})};var a,i=r(632),u=(a=i)&&a.__esModule?a:{default:a},s=r(1);var c="publish"=="teach"?"/api":"/common/api";function d(e,t){var r=e.ids,o=t.extraParams;return(0,s.request_post)("/api/book_exegesis/delete",n({id:r},o)).then(function(e){return e.data})}},749:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.info=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)(s(e),e)},t.xList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)(u(e),e)},t.xInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_put)(u(e),e)},t.getMedia=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/api/books/get_content",e)},t.getCourse=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)(d(e),e)},t.bookComment=function(e){return(0,n.request_post)("/api/home/book_comments",e)},t.getBookComment=function(e){return(0,n.request_get)("/api/home/book_comments",e)},t.bookCommentUp=function(e){return(0,n.request_put)("/api/home/book_comments",e)},t.bookRelate=function(e){return(0,n.request_get)("/api/relation",e)},t.getAccessCode=function(e){return(0,n.request_get)("/api/books/get_access_code",e)},t.getThemeBookDetail=function(e){return(0,n.request_get)(c(e),e)};var o,n=r(1),a=r(3),i=(o=a)&&o.__esModule?o:{default:o};var u=i.default.compile("/api/books/:id/XSearch"),s=i.default.compile("/api/books/:id/home_info"),c=i.default.compile("/api/theme/:id/book_info"),d=i.default.compile("/api/course_ware/:id/home_info")},750:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.declare=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(!window.DBI)return;var o=function(e){var t=e.event_class,r=void 0===t?"":t,o=e.event_data,n=void 0===o?{}:o,a=e.event_target,i=void 0===a?"":a,u=e.event_type,s=void 0===u?"":u,c=e.event_source,d=void 0===c?"WEB":c,f=e.event_sources,l=void 0===f?"":f,p=e.event_operator,_=void 0===p?"":p,v=e.event_temporary,h=void 0===v?"":v,m=e.event_system,b=void 0===m?"":m,g=e.event_system_verison,y=void 0===g?"":g,k=e.event_terminal,x=void 0===k?"":k,q=e.event_terminal_verison,I=void 0===q?"":q;if(!window.DBI)return void console.error("DBI对象不存在");return DBI.createEvent({event_class:r,event_data:n,event_target:i,event_type:s,event_source:d,event_sources:l,event_operator:_,event_temporary:h,event_system:b,event_system_verison:y,event_terminal:x,event_terminal_verison:I})}(e),n=Object.prototype.toString.call(t);"[object Object]"===n?o.addData(t):"[object Array]"===n&&t.forEach(function(e){o.addData(e)});DBI.declare(o,r)}},751:function(e,t,r){"use strict";var o=r(424);r.n(o).a},854:function(e,t,r){"use strict";var o=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"div"},[t("div",{ref:"root",staticClass:"root"})])},n=[];r.d(t,"a",function(){return o}),r.d(t,"b",function(){return n})}}]);