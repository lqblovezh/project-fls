/*!
 * {
 *   "buildtime": "2019-05-31 16:22:54",
 *   "workspace": "F:\\X-BOOK\\xcloud\\x-book4\\js",
 *   "username": "LQB",
 *   "hostname": "DESKTOP-QL56OJS",
 *   "platform": "win32",
 *   "git": {
 *     "branch": "master",
 *     "hash": "fbc007935",
 *     "message": [
 *       "commit fbc00793544e5767db1868f95f89c64b93f3aa79",
 *       "Author: 骆秋波 <1277678760@qq.com>",
 *       "Date:   Fri May 31 15:21:03 2019 +0800",
 *       "    打包上传"
 *     ],
 *     "user": "骆秋波",
 *     "email": "1277678760@qq.com",
 *     "remote": [
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (fetch)",
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (push)"
 *     ]
 *   }
 * }
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{176:function(e,t,n){"use strict";n.r(t);var i=n(826),a=n(320);for(var o in a)"default"!==o&&function(e){n.d(t,e,function(){return a[e]})}(o);n(593);var r=n(0),s=Object(r.a)(a.default,i.a,i.b,!1,null,"48427622",null);t.default=s.exports},221:function(e,t,n){"use strict";n.r(t);var i=n(222),a=n.n(i);for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);t.default=a.a},222:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{hideBack:{},type:{},privateStyle:{},isRewrite:{type:Boolean,default:!1}},computed:{isShowSearch:function(){return!!this.isSearch},isShowBack:function(){return!this.hideBack}},methods:{goBack:function(){this.isRewrite?this.$emit("back"):this.$router.go(-1)},goSearch:function(){this.$router.push({name:"search"})},share:function(){}}}},223:function(e,t,n){},224:function(e,t,n){"use strict";n.r(t);var i=n(226),a=n(221);for(var o in a)"default"!==o&&function(e){n.d(t,e,function(){return a[e]})}(o);n(225);var r=n(0),s=Object(r.a)(a.default,i.a,i.b,!1,null,"bc7c4e9e",null);t.default=s.exports},225:function(e,t,n){"use strict";var i=n(223);n.n(i).a},226:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header",style:e.privateStyle},[n("div",{staticClass:"header-left"},[e._t("left",[n("span",{staticClass:"icon-go-back icon-back",on:{click:e.goBack}})])],2),n("div",{staticClass:"header-center text-center"},[e._t("center")],2),n("div",{staticClass:"header-right text-right"},[e._t("right",["share"===e.type?n("span",{staticClass:"icon-share",on:{click:e.share}}):"search"===e.type?n("span",{staticClass:"icon-search_h",on:{click:e.goSearch}}):n("span",{staticClass:"placeholder"})])],2)])},a=[];n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a})},227:function(e,t,n){"use strict";function i(e){return e&&"[object Array]"===Object.prototype.toString.call(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.findItem=function(e,t){return t.filter(function(t){return t.id===e||t.children.some(function(t){return t.id===e})})},t.isArray=i,t.isEmptyObj=function(e){for(var t in e)return!1;return!0},t.getResource=function(e,t){var n={};return e&&t&&t.forEach(function(t){e.forEach(function(e){e.teaching_plan.forEach(function(e){e.teaching_plan_info.forEach(function(e){e.b_id===t.b_id&&(n[t.b_id]=e)})})})}),n},t.extract=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"reply";e.forEach(function(e){!function n(a){a.forEach(function(a){i(a[t])&&a[t].length>0&&n(a[t]),a.layer>2&&e[t].push(a)})}(e[t]),e[t].sort(function(e,t){return Date.parse(t.create_time)-Date.parse(e.create_time)})})},t.getInfoOfResource=function(e,t){var n={};return n.course_id=e.id,e.course_period_list&&e.course_period_list.forEach(function(e){e.teaching_plan&&e.teaching_plan.forEach(function(i){i.teaching_plan_info&&i.teaching_plan_info.forEach(function(a){a.id===t&&(n.course_hour_id=e.id,n.course_teaching_id=i.id,n.type=a.type)})})}),n.course_teaching_plan_id=t,n},t.getNextResource=function(e,t){var n={course_teaching_plan_id:-1},i=0;return e.course_period_list&&e.course_period_list.forEach(function(e){e.teaching_plan&&e.teaching_plan.forEach(function(a){a.teaching_plan_info&&a.teaching_plan_info.forEach(function(o){1!==i&&o.id!==t||(n.type=o.type,n.course_teaching_plan_id=o.id,n.course_teaching_id=a.id,n.course_hour_id=e.id),i=o.id===t?1:0})})}),n},t.getCurResource=function(e,t){var n={ids:{},data:null};return e.course_period_list&&e.course_period_list.forEach(function(i){i.teaching_plan&&i.teaching_plan.forEach(function(a){a.teaching_plan_info&&a.teaching_plan_info.forEach(function(o){o.id===t&&(n.data=o,n.ids={course_id:e.id,course_hour_id:i.id,course_plan_id:a.id,course_plan_info_id:o.id})})})}),n}},320:function(e,t,n){"use strict";n.r(t);var i=n(321),a=n.n(i);for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);t.default=a.a},321:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(5)),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o=n(6),r=c(n(224)),s=n(322);n(227);function c(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{actions:null,sheetVisible:!1,haschanged:!1,willUpdateData:{},schoolEdit:!1,collegeEdit:!1}},components:{Head:r.default},computed:a({},(0,o.mapState)("user",{defaultUserInfo:function(e){return JSON.parse(JSON.stringify(e.userInfo||{}))},userInfo:function(e){return e.userInfo||{}}})),methods:a({},(0,o.mapMutations)("user",["setUserInfo"]),{selectPic:function(){this.actions=[{name:"拍照",method:this.openPic},{name:"从相册中选择",method:this.openPic}],this.sheetVisible=!0},selectSex:function(){this.actions=[{name:"男",method:this.changeSex},{name:"女",method:this.changeSex},{name:"保密",method:this.changeSex}],this.sheetVisible=!0},changeSex:function(e){this.defaultUserInfo.sex!==e.name&&(this.defaultUserInfo.sex=e.name,this.willUpdateData.sex=e.name,this.haschanged=!0)},openPic:function(e){this.$refs.camera.click()},previewImg:function(e){var t=e.target.files[0],n=URL.createObjectURL(t);this.$set(this.defaultUserInfo,"picture_absolute",n),this.haschanged=!0},edit:function(e,t){var n=this;this[e]=!0,this.$nextTick(function(){n.$refs[t].focus()})},blur:function(e,t){this[e]=!1,this.defaultUserInfo[t]!==this.userInfo[t]?(this.willUpdateData[t]=this.defaultUserInfo[t],this.haschanged=!0):this.willUpdateData[t]&&delete this.willUpdateData[t]},save:function(){var e,t=this;return(e=i.default.mark(function e(){var n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.$refs.camera.files[0],e.prev=1,!n){e.next=5;break}return e.next=5,(0,s.getTask)(n).then(function(e){t.willUpdateData.picture=e.data.path});case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(1),new Error("图片更新失败");case 10:t.$service.user.changeUserInfo(a({},t.willUpdateData)).then(function(e){t.$Toast({message:"修改成功",iconClass:"icon-toast icon-success"}),t.haschanged=!1,t.setUserInfo(e.data)}).catch(console.warn);case 11:case"end":return e.stop()}},e,t,[[1,7]])}),function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function i(a,o){try{var r=t[a](o),s=r.value}catch(e){return void n(e)}if(!r.done)return Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)});e(s)}("next")})})()}})}},322:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTask=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];return e.size,e.size>=1048576?(t.is_chunk=!0,(0,i.request_post)("/common/api/files/upload_task?r="+Math.random(5)).then(function(a){if(a.status)return t.task_id=a.data.task_id,(0,i.request_file)("/common/api/files/upload",{file:e,data:t},n);throw new Error(a.messages)}).catch(function(e){throw new Error("上传失败")})):(t.is_chunk=!1,(0,i.request_file)("/common/api/files/upload",{file:e,data:t}))},t.getAppId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.request_get)("/common/api/app/search_name",e).then(function(e){return a.default.app_id=e.data.id,sessionStorage.app_id=e.data.id,e})},t.getClientToken=function(){return(0,i.request_post)("/common/api/auth/token/pcclient")},t.platInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.request_get)(s(e)).then(function(e){return a.default.app_id=e.data.id,sessionStorage.app_id=e.data.id,document.title=e.data.name,e})},t.commonPreview=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.request_get)(u(e))},t.getDefaultCover=function(){return(0,i.request_get)("/api/videos/images")},t.generate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.request_post)("/common/api/qr_code/generate",e)},t.commonPreviewCode=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.request_post)("/api/preview",e)},t.getQrcode=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.request_get)("/common/api/get_qrcode",e)},t.synchronization=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.request_get)(c(e)).then(function(e){return e})},t.getAuthor=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.request_get)("/api/ecommerce/author",e)},t.addAuthor=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.request_post)("/api/ecommerce/author",e)},t.getWeixinConfig=function(e){return(0,i.request_get)("/common/api/third/wx_js_sdk/config",e)},t.getIndexInfo=function(){return(0,i.request_get)("/common/api/current")};r(n(39));var i=n(1),a=r(n(52)),o=r(n(3));function r(e){return e&&e.__esModule?e:{default:e}}o.default.compile("/common/api/files/upload_task/:id"),o.default.compile("/common/api/manager/managers/:id"),o.default.compile("/common/api/manager/roles/:id");var s=o.default.compile("/common/api/app/apps/:id"),c=o.default.compile("/common/api/dragon_infos/:id");var u=o.default.compile("/api/preview/:id")},323:function(e,t,n){},593:function(e,t,n){"use strict";var i=n(323);n.n(i).a},826:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pt88-static__vh main-color"},[n("Head",[n("p",{attrs:{slot:"center"},slot:"center"},[e._v("个人资料")]),n("div",{attrs:{slot:"right"},slot:"right"},[n("p",{directives:[{name:"show",rawName:"v-show",value:e.haschanged,expression:"haschanged"}],staticClass:"f14",on:{click:e.save}},[e._v("保存")])])]),n("div",{staticClass:"info-menu"},[n("div",{staticClass:"p3 c-bg-f"},[n("div",{staticClass:"info-item",on:{click:function(t){return e.$go("infoUpdate")}}},[n("p",[e._v("账户与安全")]),n("p",{staticClass:"ell"},[e._v(e._s(e.defaultUserInfo.name)),n("span",{staticClass:"icon-small icon-enter"})])]),n("div",{staticClass:"info-item",on:{click:e.selectPic}},[n("p",[e._v("头像")]),n("p",[n("img",{attrs:{src:e.defaultUserInfo.picture_absolute}}),n("span",{staticClass:"icon-small icon-enter"})]),n("input",{ref:"camera",attrs:{type:"file",accept:"image/*",capture:"camera"},on:{change:function(t){return e.previewImg(t)}}})]),n("div",{staticClass:"info-item",on:{click:function(t){return e.$go("updateNickName")}}},[n("p",[e._v("昵称")]),n("p",[e._v(e._s(e.defaultUserInfo.nick_name)),n("span",{staticClass:"icon-small icon-enter"})])]),n("div",{staticClass:"info-item noBorder",on:{click:e.selectSex}},[n("p",[e._v("性别")]),n("p",[e._v(e._s(e.defaultUserInfo.sex)),n("span",{staticClass:"icon-small icon-enter"})])]),n("div",{staticClass:"line-part"}),n("div",{staticClass:"info-item"},[n("p",[e._v("学校")]),n("p",{directives:[{name:"show",rawName:"v-show",value:!e.schoolEdit,expression:"!schoolEdit"}],on:{click:function(t){return e.edit("schoolEdit","school")}}},[e._v(e._s(e.defaultUserInfo.school)),n("span",{staticClass:"icon-small icon-enter"})]),n("input",{directives:[{name:"show",rawName:"v-show",value:e.schoolEdit,expression:"schoolEdit"},{name:"model",rawName:"v-model",value:e.defaultUserInfo.school,expression:"defaultUserInfo.school"}],ref:"school",domProps:{value:e.defaultUserInfo.school},on:{blur:function(t){return e.blur("schoolEdit","school")},input:function(t){t.target.composing||e.$set(e.defaultUserInfo,"school",t.target.value)}}})]),n("div",{staticClass:"info-item"},[n("p",[e._v("学院")]),n("p",{directives:[{name:"show",rawName:"v-show",value:!e.collegeEdit,expression:"!collegeEdit"}],on:{click:function(t){return e.edit("collegeEdit","college")}}},[e._v(e._s(e.defaultUserInfo.college)),n("span",{staticClass:"icon-small icon-enter"})]),n("input",{directives:[{name:"show",rawName:"v-show",value:e.collegeEdit,expression:"collegeEdit"},{name:"model",rawName:"v-model",value:e.defaultUserInfo.college,expression:"defaultUserInfo.college"}],ref:"college",domProps:{value:e.defaultUserInfo.college},on:{blur:function(t){return e.blur("collegeEdit","college")},input:function(t){t.target.composing||e.$set(e.defaultUserInfo,"college",t.target.value)}}})])])]),n("mt-actionsheet",{attrs:{actions:e.actions},model:{value:e.sheetVisible,callback:function(t){e.sheetVisible=t},expression:"sheetVisible"}})],1)},a=[];n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a})}}]);