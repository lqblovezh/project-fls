/*!
 * {
 *   "buildtime": "2019-07-17 10:58:50",
 *   "workspace": "F:\\project\\x-book4\\js",
 *   "username": "Administrator",
 *   "hostname": "PC201608171616",
 *   "platform": "win32",
 *   "git": {
 *     "branch": "master",
 *     "hash": "a51842995",
 *     "message": [
 *       "commit a51842995ac312d7b576d646ab99c7a4f3f34d0b",
 *       "Author: YangZai <552396385@qq.com>",
 *       "Date:   Wed Jul 17 10:58:23 2019 +0800",
 *       "    xxx"
 *     ],
 *     "user": "YangZai",
 *     "email": "552396385@qq.com",
 *     "remote": [
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (fetch)",
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (push)"
 *     ]
 *   }
 * }
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{1018:function(t,e,n){"use strict";n.r(e);var i=n(1128),a=n(852);for(var s in a)"default"!==s&&function(t){n.d(e,t,function(){return a[t]})}(s);n(1019);var r=n(0),o=Object(r.a)(a.default,i.a,i.b,!1,null,null,null);e.default=o.exports},1019:function(t,e,n){"use strict";var i=n(854);n.n(i).a},1020:function(t,e,n){"use strict";var i=n(855);n.n(i).a},1072:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-info"},[n("Head",{attrs:{type:"dark",name:"个人资料"}}),n("div",{staticClass:"info-list f15"},[n("div",{staticClass:"info-line"}),n("div",{staticClass:"info-title"},[t._v("个人信息")]),n("div",{staticClass:"info-panel"},[n("InfoItem",{attrs:{k:"头像",isImg:"",type:"icon"}},[t.info.picture_absolute?n("img",{attrs:{src:t.info.picture_absolute},on:{click:t.selectImg}}):n("div",{staticClass:"icon icon-three-avatar",on:{click:t.selectImg}})]),n("InfoItem",{attrs:{k:"账户",val:t.info.name}}),n("InfoItem",{attrs:{k:"昵称",editable:"",attr:"nick_name",val:t.info.nick_name,type:"icon"},on:{updateInfo:t.updateInfo}}),n("InfoItem",{attrs:{k:"性别",val:t.info.sex,type:"icon"},on:{select:t.showActionSheet}}),n("InfoItem",{attrs:{k:"年龄",val:t._f("forage")(t.info.date_of_birth),type:"icon"},on:{selectDate:t.selectDate}}),n("InfoItem",{attrs:{k:"地区",editable:"",attr:"address",val:t.info.address,type:"icon"},on:{updateInfo:t.updateInfo}}),n("InfoItem",{attrs:{k:"职业",editable:"",attr:"duties",val:t.info.duties,type:"icon"},on:{updateInfo:t.updateInfo}}),n("InfoItem",{attrs:{k:"联系邮箱",editable:"",attr:"email",val:t.info.email,type:"icon"},on:{updateInfo:t.updateInfo}}),n("InfoItem",{attrs:{k:"个人介绍",val:" ",path:"/user-intro",type:"icon"}})],1),n("div",{staticClass:"info-line"}),t._m(0),n("div",{staticClass:"info-panel"},[n("InfoItem",{attrs:{k:"手机绑定",val:t._f("format")(t.phone_Info),isPhone:"",attr:"phone",type:"false"},on:{updateInfo:t.updateInfo}}),n("InfoItem",{attrs:{k:"微信绑定",val:t.wx_Info,type:"false"}}),n("InfoItem",{attrs:{k:"QQ绑定",src:t.img_Info,val:t.qq_Info,type:"false"}})],1),n("button",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}],staticClass:"linear-btn btn-reset f16 c_f",on:{click:t.save}},[t._v("保存")])]),n("input",{ref:"pic",staticClass:"hide",attrs:{type:"file",accept:"image/*"},on:{change:function(e){return t.previewImg(e)}}}),n("mt-actionsheet",{attrs:{actions:t.actions},model:{value:t.sheetVisible,callback:function(e){t.sheetVisible=e},expression:"sheetVisible"}}),n("mt-datetime-picker",{ref:"picker",attrs:{type:"date",startDate:t.startDate,endDate:t.endDate},on:{confirm:t.handleConfirm},model:{value:t.birthDate,callback:function(e){t.birthDate=e},expression:"birthDate"}})],1)},a=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"info-title flex"},[e("div",{staticClass:"info-title__left"},[this._v("账号绑定")]),e("div",{staticClass:"info-title__right f12"},[this._v("未绑定手机号其他方式下的记录不可迁移")])])}];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a})},1128:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"info-item flex-between-center",class:{ptb15:t.isImg}},[n("div",{staticClass:"info-item__left"},[t._v(t._s(t.k))]),n("div",{staticClass:"info-item__right flex-between-center",on:{click:t.callSomething}},[t.src?n("img",{staticClass:"qq_Img",attrs:{src:t.src}}):t._e(),t.isImg||t.isFocus?t.isFocus?n("div",{staticClass:"info-item__text mr15"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.clone_val,expression:"clone_val"}],ref:"item",attrs:{type:"text"},domProps:{value:t.clone_val},on:{blur:t.updateInfo,input:function(e){e.target.composing||(t.clone_val=e.target.value)}}})]):t.isImg?n("div",{staticClass:"info-item__img mr15"},[t._t("default")],2):t._e():n("div",{staticClass:"info-item__val c_gray1 f14 mr15",class:{dcolor:t.val},on:{click:t.edit}},[t._v(t._s(t.val||"暂未填写"))]),n("div",{directives:[{name:"show",rawName:"v-show",value:"icon"===t.type,expression:"type ==='icon'"}],staticClass:"icon-more"})])])},a=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a})},619:function(t,e,n){"use strict";n.r(e);var i=n(1072),a=n(850);for(var s in a)"default"!==s&&function(t){n.d(e,t,function(){return a[t]})}(s);n(1020);var r=n(0),o=Object(r.a)(a.default,i.a,i.b,!1,null,null,null);e.default=o.exports},850:function(t,e,n){"use strict";n.r(e);var i=n(851),a=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,function(){return i[t]})}(s);e.default=a.a},851:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=c(n(9)),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},s=n(15),r=n(268),o=c(n(1018));function c(t){return t&&t.__esModule?t:{default:t}}function f(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function i(a,s){try{var r=e[a](s),o=r.value}catch(t){return void n(t)}if(!r.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})}}e.default={data:function(){return{sheetVisible:!1,actions:[{name:"男",method:this.changeSex},{name:"女",method:this.changeSex},{name:"保密",method:this.changeSex}],info:{},birthDate:new Date,startDate:new Date("1900"),endDate:new Date,canUpdateAttrs:["sex","date_of_birth","email","duties","nick_name","phone","address"]}},components:{InfoItem:o.default},mounted:function(){this.info=JSON.parse(JSON.stringify(this.$user)),this.info},methods:a({},(0,s.mapMutations)(["SET_USER"]),{isEmptyObj:function(t){for(var e in t)return!1;return!0},showActionSheet:function(){this.sheetVisible=!0},changeSex:function(t){this.$set(this.info,"sex",t.name)},selectImg:function(){this.$refs.pic.click()},selectDate:function(){this.$refs.picker.open()},previewImg:function(t){var e=t.target.files[0],n=URL.createObjectURL(e);this.$set(this.info,"picture_absolute",n)},handleConfirm:function(){var t=this.birthDate;t&&this.$set(this.info,"date_of_birth",t.toLocaleDateString().replace(/\//g,"-"))},updateInfo:function(t){var e=t.attr,n=t.value;this.$set(this.info,e,n)},save:function(){var t=this;return f(i.default.mark(function e(){var n,a,s,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},a=t.$refs.pic.files[0],e.prev=2,!a){e.next=6;break}return e.next=6,(0,r.getTask)(a).then(function(t){n.picture=t.data.path});case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(2),new Error("图片更新失败");case 11:for(s in t.canUpdateAttrs)o=t.canUpdateAttrs[s],t.$user[o]!==t.info[o]&&(n[o]=t.info[o]);!t.isEmptyObj(n)&&t.sendDate(n);case 14:case"end":return e.stop()}},e,t,[[2,8]])}))()},sendDate:function(t){var e=this;return f(i.default.mark(function n(){var a;return i.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$service.user.changeUserInfo(t);case 3:a=n.sent,e.SET_USER(a.data),e.$Toast({message:"修改成功",iconClass:"icon-success"}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),e.$Toast({message:"数据修改失败",iconClass:"icon-failed"});case 11:case"end":return n.stop()}},n,e,[[0,8]])}))()}}),filters:{format:function(t){return t&&t.replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2")},forage:function(t){null==t&&(t="");var e=(new Date).getFullYear(),n=t.substring(0,4),i=parseInt(e),a=parseInt(n);return String(i-a)}},computed:{wx_Info:function(){return this.info.third_weixin&&this.info.third_weixin.nickname?this.info.third_weixin.nickname:"未绑定"},qq_Info:function(){return this.info.third_qq&&this.info.third_qq.nickname?this.info.third_qq.nickname:"未绑定"},phone_Info:function(){return this.info.phone?this.info.phone:"未绑定"},img_Info:function(){return this.info.third_qq&&this.info.third_qq.headimgurl?this.info.third_qq.headimgurl:void 0}}}},852:function(t,e,n){"use strict";n.r(e);var i=n(853),a=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,function(){return i[t]})}(s);e.default=a.a},853:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{src:{type:String},k:{type:String,required:!0},isImg:{type:Boolean,default:!1},val:{type:String},path:{type:String},type:{},editable:{type:Boolean,default:!1},attr:{}},data:function(){return{isFocus:!1,clone_val:""}},methods:{callSomething:function(){"性别"===this.k&&this.$emit("select"),"年龄"===this.k&&this.$emit("selectDate"),this.path&&this.$go(this.path)},edit:function(){var t=this;this.editable&&(this.isFocus=!0,this.clone_val=this.val,this.$nextTick(function(){t.$refs.item.focus()}))},updateInfo:function(){this.isFocus=!1,this.attr,this.$emit("updateInfo",{attr:this.attr,value:this.clone_val})}}}},854:function(t,e,n){},855:function(t,e,n){}}]);