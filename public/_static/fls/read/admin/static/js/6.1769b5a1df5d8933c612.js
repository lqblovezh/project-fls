/*!
 * {
 *   "buildtime": "2019-05-31 16:22:54",
 *   "workspace": "F:\\X-BOOK\\xcloud\\x-book4\\js",
 *   "username": "LQB",
 *   "hostname": "DESKTOP-QL56OJS",
 *   "platform": "win32",
 *   "git": {
 *     "branch": "master",
 *     "hash": "fbc007935",
 *     "message": [
 *       "commit fbc00793544e5767db1868f95f89c64b93f3aa79",
 *       "Author: 骆秋波 <1277678760@qq.com>",
 *       "Date:   Fri May 31 15:21:03 2019 +0800",
 *       "    打包上传"
 *     ],
 *     "user": "骆秋波",
 *     "email": "1277678760@qq.com",
 *     "remote": [
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (fetch)",
 *       "origin http://gitlab.kf.gli.cn/xcloud/x-book4.git (push)"
 *     ]
 *   }
 * }
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1287:function(t,e,n){"use strict";var a=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"div"},[e("SwitchSys",{attrs:{currentPlant:this.currentPlant}})],1)},s=[];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return s})},1293:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"div"},[n("div",{staticClass:"alltop",class:{showMoreTop:t.showMoreTop},on:{mouseleave:function(e){t.showMoreTop=!1}}},[n("ul",{staticClass:"otherTop"},[n("li",{class:{active:t.isBase},on:{click:function(e){return t.goPage("/common/admin")}}},[t._m(0)]),t._l(t.outlink,function(e){return n("li",{class:{active:e.is_current},on:{click:function(n){return t.goPage(e)}}},[n("div",{staticClass:"content"},[n("p",{staticClass:"title"},[t._v(t._s(e.title))]),n("p",{staticClass:"name"},[t._v(t._s(e.name))])])])})],2),n("header",{staticClass:"header"},[n("div",{staticClass:"left",domProps:{textContent:t._s(t.left)},on:{click:t.showMore}}),t.plantInfo&&!t.isXDataVisible?n("div",{staticClass:"content"},[t._v("（"+t._s(t.plantInfo.name)+"）")]):t._e(),t.userInfo?n("div",{staticClass:"right"},["system"!=t.type?n("el-dropdown",{on:{command:t.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[t._v("平台切换"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.userInfo.publishers,function(e){return n("el-dropdown-item",{key:e.id,attrs:{command:e.base_url,disabled:t.publisher.id==e.id}},[t._v(t._s(e.name))])}),1)],1):t._e(),n("span",{staticClass:"user"},[t._v(t._s(t.userName))]),n("span",{staticClass:"logoutBtn",on:{click:t.logout}},[t._v("退出登录")]),n("span",{staticClass:"logoutBtn",on:{click:t.changePass}},[t._v("修改密码")]),n("span",{staticClass:"logoutBtn",on:{click:t.backHome}},[t._v("返回首页")]),n("el-dialog",{attrs:{visible:t.loginDialog,width:"420px","close-on-click-modal":!1,"lock-scroll":!1,"before-close":t.handleClose,"append-to-body":!0},on:{"update:visible":function(e){t.loginDialog=e}}},[n("div",{staticClass:"top",attrs:{slot:"title"},slot:"title"},[n("el-tabs",{attrs:{value:"pass"}},[n("el-tab-pane",{attrs:{label:"修改密码",name:"pass"}})],1)],1),n("form",{ref:"passForm",staticClass:"passContent"},[n("div",{staticClass:"group"},[n("div",{staticClass:"label"},[t._v("旧密码:")]),n("input",{staticClass:"form-control",attrs:{name:"old_pass",type:"password"},domProps:{value:t.passData.old_pass}})]),n("div",{staticClass:"group"},[n("div",{staticClass:"label"},[t._v("新密码:")]),n("input",{staticClass:"form-control",attrs:{name:"new_pass",type:"password"},domProps:{value:t.passData.new_pass}})]),n("div",{staticClass:"group"},[n("div",{staticClass:"label"},[t._v("新密码确认:")]),n("input",{staticClass:"form-control",attrs:{name:"new_pass_confirm",type:"password"},domProps:{value:t.passData.new_pass_confirm}})])]),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.loginDialog=!1}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.changePassword}},[t._v("确 定")])],1)])],1):t._e()])])])},s=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content"},[e("p",{staticClass:"title"}),e("p",{staticClass:"name"},[this._v("基础设置")])])}];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return s})},453:function(t,e,n){"use strict";n.r(e);var a=n(454),s=n.n(a);for(var o in a)"default"!==o&&function(t){n.d(e,t,function(){return a[t]})}(o);e.default=s.a},454:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s(n(258));var a=s(n(746));function s(t){return t&&t.__esModule?t:{default:t}}e.default={props:["leftName","title","currentPlant"],components:{SwitchSys:a.default}}},455:function(t,e,n){"use strict";n.r(e);var a=n(456),s=n.n(a);for(var o in a)"default"!==o&&function(t){n.d(e,t,function(){return a[t]})}(o);e.default=s.a},456:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var a=m(n(19)),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},o=m(n(258)),r=n(457),i=n(747),u=n(46),l=m(n(20)),c=m(n(104)),d=n(78),f=n(102),p=m(n(105));function m(t){return t&&t.__esModule?t:{default:t}}var h="read",g="system"==h&&!0&&"desktop"=="desktop";e.default={props:["leftName","title","currentPlant"],data:function(){return{userInfo:null,current:"",type:h,plantInfo:null,loginDialog:!1,showMoreTop:!1,outlink:"",isBase:!0,publisher:{},passData:{old_pass:null,new_pass:null,new_pass_confirm:null}}},mounted:function(){var t=this;"system"!=h&&(0,d.platInfo)().then(function(e){t.publisher=e.data.publisher,t.outlink=t.publisher.apps,t.outlink.forEach(function(e){e.is_current&&(t.isBase=!1)})}),this.current=this.currentPlant,sessionStorage.userInfo&&(this.userInfo=l.default.parse(sessionStorage.userInfo)),this.$config.userInfo&&(this.userInfo=this.$config.userInfo),this.$config.userInfo||sessionStorage.userInfo||this.checklogin()},computed:{left:function(){return this.leftName||"显示平台"},isXDataVisible:function(){return this.$store.state.xDataVisible},isXDataTextVisible:function(){return!0},userName:function(){return this.userInfo&&this.userInfo.user?this.userInfo.user.name:null}},methods:s({checklogin:function(){var t,e=this;return(t=a.default.mark(function t(){return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,f.isLogin)().then(function(t){e.userInfo=t.data});case 2:case"end":return t.stop()}},t,e)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function a(s,o){try{var r=e[s](o),i=r.value}catch(t){return void n(t)}if(!r.done)return Promise.resolve(i).then(function(t){a("next",t)},function(t){a("throw",t)});t(i)}("next")})})()},update:function(t){this.userInfo=t},handleClose:function(t){this.passData.old_pass=null,this.passDatanew_pass=null,this.passDatanew_pass_confirm=null,this.loginDialog=!1},changeCode:function(t){var e=t.currentTarget;e.src=e.src},logout:function(){this.$confirm("是否确认退出?").then(function(t){(g?i.loginOut:r.loginOut)().then(function(t){sessionStorage.clear(),window.location.href=g?"/system/admin":"/admin"})}).catch(function(t){})},backHome:function(){window.location.href=restUrl_system+"/system"},changePass:function(){this.loginDialog=!0},changePassword:function(){var t=this,e=(0,o.default)(this.$refs.passForm,{hash:!0});(g?i.changePass:r.changePass)(e).then(function(e){t.$message.success("修改密码成功！"),t.loginDialog=!1,window.location.href="../"}).catch(function(e){var n=e.payload;for(var a in n.messages){t.$message.error(n.messages[a]);break}})},goPage:function(t){"string"!=typeof t?t.name!=this.currentPlant?location.href=(0,c.default)(t.base_url,"admin"):this.$message.error("你正处在该平台"):location.href=t},showMore:function(){this.showMoreTop=!this.showMoreTop},handleCommand:function(e){p.default.set("token",sessionStorage.token,{expires:1,path:"/",domain:t.restUrl_system.replace("http://",".")}),location.href=e+"/common/admin"}},(0,u.mapMutations)(["updateUser","openXData","closeXData"]))}}).call(this,n(4))},457:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.register=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/user/register",t)},e.login=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/auth/login/user",t).then(function(t){return window.sessionStorage.setItem("token",t.data.token),window.localStorage.setItem("token",t.data.token),o.default.token=t.data.token,t})},e.thirdLogin=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.back_url.match(/.*(\?.*)#.*/),n=e&&e[1];n&&(t.back_url=t.back_url.replace(n,""));return(0,a.request_post)("/common/api/auth/third/link",t)},e.phoneLogin=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/auth/login_by_phone/phone",t).then(function(t){return window.sessionStorage.setItem("token",t.data.token),window.localStorage.setItem("token",t.data.token),o.default.token=t.data.token,t})},e.codeImage=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=Math.random().toFixed(3);return(0,a.request_get)("/common/api/captcha/image?code="+t)},e.codeCheck=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/captcha/check",t)},e.codePhone=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/captcha/mobile",t)},e.codeEmail=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/captcha/email",t)},e.getUserInfo=function(){return(0,a.request_get)("/api/auth/is_login/user")},e.save=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_put)("/common/api/user",t)},e.loginOut=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/common/api/auth/logout",t).then(function(t){return window.sessionStorage.removeItem("token"),window.sessionStorage.removeItem("userInfo"),o.default.token=null,t})},e.changePass=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_put)("/common/api/auth/pass",t).then(function(t){return window.sessionStorage.removeItem("token"),window.sessionStorage.removeItem("userInfo"),o.default.token=null,t})},e.saveMemberData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_put)(i(t),t)};var a=n(45),s=r(n(77)),o=(r(n(20)),r(n(47)));function r(t){return t&&t.__esModule?t:{default:t}}var i=s.default.compile("/common/api/user/:id")},458:function(t,e,n){},627:function(t,e,n){"use strict";n.r(e);var a=n(1287),s=n(453);for(var o in s)"default"!==o&&function(t){n.d(e,t,function(){return s[t]})}(o);var r=n(0),i=Object(r.a)(s.default,a.a,a.b,!1,null,"1e6bb5e4",null);e.default=i.exports},746:function(t,e,n){"use strict";n.r(e);var a=n(1293),s=n(455);for(var o in s)"default"!==o&&function(t){n.d(e,t,function(){return s[t]})}(o);n(748);var r=n(0),i=Object(r.a)(s.default,a.a,a.b,!1,null,"5d3b1c52",null);e.default=i.exports},747:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t};e.listRole=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_get)("/system/api/manager/roles",t)},e.listManager=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_get)("/system/api/manager/managers",t)},e.addManager=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/system/api/manager/managers",t)},e.modifyManager=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,n=u(t,["id"]);return(0,o.request_put)(l({id:e}),n)},e.detailManager=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,n=u(t,["id"]);return(0,o.request_get)(l({id:e}),n)},e.detailRole=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,n=u(t,["id"]);return e?(0,o.request_get)(c({id:e}),n).then(function(t){var e={};if(t.status){e=t.data.accesses;var n={allow_create:0,allow_view_all:0,allow_edit_all:0,allow_delete_all:0};return d().then(function(s){if(s.status){var o=s.data,r={};for(var i in o)r[o[i].id]=a({},o[i],n),e[o[i].id]&&(r[o[i].id]=a({},o[i],e[o[i].id]));return s.data=r,log(t,222),s}})}}):f()},e.allJurisdiction=d,e._allJurisdiction=f,e.role=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,n=u(t,["id"]);if(log(n),e)return(0,o.request_put)(c({id:e}),n);return(0,o.request_post)("/system/api/manager/roles",n)},e.addRole=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/system/api/manager/roles",t)},e.deleteManager=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/system/api/manager/managers/delete",t)},e.deleteRole=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/system/api/manager/roles/delete",t)},e.logManager=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_get)("/system/api/manager/logs",t)},e.login=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/system/api/auth/login/manager",t)},e.isLogin=function(){return(0,o.request_get)("/system/api/auth/is_login/manager")},e.loginOut=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_post)("/system/api/auth/logout",t)},e.changePass=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.request_put)("/system/api/auth/pass",t).then(function(t){return window.sessionStorage.removeItem("token"),window.sessionStorage.removeItem("userInfo"),config.token=null,t})};var s,o=n(45),r=n(77),i=(s=r)&&s.__esModule?s:{default:s};function u(t,e){var n={};for(var a in t)e.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a]);return n}var l=i.default.compile("/system/api/manager/managers/:id"),c=i.default.compile("/system/api/manager/roles/:id");function d(){return(0,o.request_get)("/system/api/manager/accesses")}function f(){return(0,o.request_get)("/system/api/manager/accesses").then(function(t){if(t.status){var e={allow_create:0,allow_view_all:0,allow_edit_all:0,allow_delete_all:0},n=t.data,s={};for(var o in n)s[n[o].id]=a({},n[o],e);return t.data=s,t}})}},748:function(t,e,n){"use strict";var a=n(458);n.n(a).a}}]);