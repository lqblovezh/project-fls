(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{1156:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"index clearfix"},[a("Top",{attrs:{currentPlant:"X-PUBLISH"}}),a("Menu",{attrs:{curr:"/contentLibrary/digitalBook"}}),a("div",{staticClass:"mainRight"},[a("div",{staticClass:"contentWrap"},[a("div",{staticClass:"contentLeft"},[a("div",{staticClass:"maindata"},[a("div",{staticClass:"serachWrap",on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.query()}}},[a("div",{staticClass:"title"}),a("form",{attrs:{id:"mainForm"}},[a("span",{staticClass:"group-inline"},[a("el-input",{attrs:{placeholder:"请输入名称",name:"name",clearable:""}})],1),a("span",{staticClass:"group-inline"},[a("TimePick",{attrs:{inputsName:["start_time","end_time"]}})],1),a("span",{staticClass:"group-inline float-right"},[a("el-button",{attrs:{size:"mediu",type:"primary",icon:"el-icon-search",plain:""},on:{click:t.query}},[t._v("搜索")])],1)])]),a("div",{staticClass:"tableWrap"},[a("div",{staticClass:"tableTop"},[a("div",{staticClass:"title vel-line"},[a("span",[t._v("全部 "),t.page?a("span",{staticClass:"totalNum"},[t._v("("+t._s(t.page.total)+")")]):t._e()]),a("div",{staticClass:"btns"},[a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:t.moveToOther}},[t._v("移动分组")]),a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:t.exportSomething}},[t._v("导出")]),a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){t.delChoosen(!1)}}},[t._v("删除")])],1)])]),a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{staticClass:"allBtn"},[a("input",{attrs:{type:"checkbox"},on:{click:function(e){t.checkAll(e)}}})]),a("th",[t._v("名称")]),a("th",[t._v("资源品类")]),a("th",[t._v("出处")]),a("th",{staticClass:"time"},[t._v("创建时间")]),a("th",{staticClass:"operate"},[t._v("操作")])])]),t.list?a("tbody",t._l(t.list,function(e){return a("tr",[a("th",[a("input",{ref:"ids",refInFor:!0,attrs:{type:"checkbox",name:"ids"},domProps:{value:e.id}})]),a("th",[a("img",{staticClass:"cover-photo",attrs:{src:e.img_src}}),a("div",{staticClass:"th-name bookName",attrs:{title:e.title}},[t._v(t._s(e.title))])]),a("th",[a("div",{staticClass:"th-name",attrs:{title:e.type_name}},[t._v(t._s(e.type_name))])]),a("th",[a("div",{staticClass:"th-name"},[t._v(t._s(e.owner_model))])]),a("th",[a("div",{staticClass:"th-name"},[t._v(t._s(e.create_time))])]),a("th",[a("div",{staticClass:"btns"},[a("span",{staticClass:"icon icon-detail",attrs:{title:"详情",size:"mini",type:"primary",plain:""},on:{click:function(a){t.opneDetailDialog("info",e)}}}),a("span",{staticClass:"icon icon-preview",attrs:{title:"预览",size:"mini",type:"primary",plain:""},on:{click:function(a){t.openReader(e)}}}),a("span",{staticClass:"icon icon-delete",attrs:{title:"删除",size:"mini",type:"primary",plain:""},on:{click:function(a){t.delChoosen(e.id)}}})])])])})):t._e()]),t.page?a("div",{staticClass:"pageWrap"},[a("el-pagination",{attrs:{small:!1,background:"","current-page":t.page.num,"page-sizes":[10,50,100],"page-size":t.page.offset,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()]),a("div",{staticClass:"gruopList"},[a("GroupList",{attrs:{groupList:t.groupList,currGroup:t.currGroup},on:{addGroup:t.addGroup,updateGroup:t.updateGroup,delGroup:t.delGroup,groupChange:t.groupChange}})],1)])])])]),a("div",{staticClass:"dialogs"},[t.readerDialog?a("Reader",{attrs:{readerDialog:t.readerDialog,readerId:t.readerId,version:"draft"},on:{"update:readerDialog":function(e){t.readerDialog=e}}}):t._e(),a("el-dialog",{attrs:{center:!1,visible:t.detailDialog,"close-on-click-modal":!1,top:"50px",width:"1000px"},on:{"update:visible":function(e){t.detailDialog=e}}},[a("div",{staticClass:"content",attrs:{slot:"title"},slot:"title"},[t.detailDialog?a("Detail",{attrs:{type:t.detailDialogType,detailDialog:t.detailDialog,detailData:t.detailData,detailType:t.detailType,services:t.services},on:{detailBack:t.detailBack,"update:detailDialog":function(e){t.detailDialog=e}}}):t._e()],1)]),t.publishDialog?a("el-dialog",{attrs:{center:!1,visible:t.publishDialog,"close-on-click-modal":!1,top:"50px",width:"1000px",title:"发布"},on:{"update:visible":function(e){t.publishDialog=e}}},[a("Release",{attrs:{ids:t.fabuIds},on:{cancle:function(e){t.publishDialog=!1}}})],1):t._e(),a("el-dialog",{attrs:{center:!1,visible:t.moveToOtherDiaolog,"close-on-click-modal":!1,title:"移动分组",width:"500px"},on:{"update:visible":function(e){t.moveToOtherDiaolog=e}}},[a("span",{}),a("div",{staticClass:"group"},[a("div",{staticClass:"label"},[t._v("移动到")]),a("select",{ref:"moveToId",staticClass:"form-control",attrs:{placeholder:"请选择"}},t._l(t.groupList,function(e,i){return e.id!=t.currGroup&&""!=e.id?a("option",{domProps:{value:e.id,textContent:t._s(e.name)}}):t._e()}))]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.moveToSubmit}},[t._v(" 确定")]),a("el-button",{on:{click:function(e){t.moveToOtherDiaolog=!1}}},[t._v("返回")])],1)])],1)],1)},l=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return l})},334:function(t,e,a){"use strict";a.r(e);var i=a(1156),l=a(712);for(var n in l)"default"!==n&&function(t){a.d(e,t,function(){return l[t]})}(n);a(937);var s=a(0),r=Object(s.a)(l.default,i.a,i.b,!1,null,"84209e5a",null);r.options.__file="index.vue",e.default=r.exports},393:function(t,e,a){"use strict";a.r(e);var i=a(394),l=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,function(){return i[t]})}(n);e.default=l.a},394:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=d(a(3)),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t},n=a(156),s=u(a(27)),r=u(a(404)),o=a(122);d(a(1));function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}function d(t){return t&&t.__esModule?t:{default:t}}function c(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(l,n){try{var s=e[l](n),r=s.value}catch(t){return void a(t)}if(!s.done)return Promise.resolve(r).then(function(t){i("next",t)},function(t){i("throw",t)});t(r)}("next")})}}e.default={props:["type","detailData","detailDialog","detailType","defaultData","services","readOnly"],created:function(){var t=this;if(this.readOnly,this.detailType,!this.defaultData&&this.detailData)this.getDetail(),this.getMulu(this.detailData.id);else if(this.getMainList.forEach(function(e){for(var a in t.defaultData)a!==e.label&&a!==e.name||(e.value=t.defaultData[a])}),this.metadata=this.defaultData.attributes||[],this.readOnly&&this.defaultData.components){var e=(0,n.recursionTree)(this.defaultData.components,"pid","root");this.ml=e,this.currMulu=e}else this.getMulu(this.defaultData.id)},mixins:[o.getIconStyle],data:function(){return{detailDataOwn:{attributes:[]},metadata:[],ml:null,defaultProps:{children:"children",label:"chapter_name"},currMulu:null,previewImgUrl:null,file:null,viewpoint:[{label:"标题",value:""},{label:"副标题"},{label:"作者"},{label:"品类维度"},{label:"品类维度编号"},{label:"专业类别"},{label:"专业类别编号"},{label:"文集类别"},{label:"文集来源ID"},{label:"文献出处"},{label:"文献出处ID"},{label:"套系栏目"},{label:"价格"},{label:"创建时间",isDdisabled:!0,NoNeed:!0}],statute:[{label:"标题",value:""},{label:"发文字号"},{label:"发布单位"},{label:"效力状态"},{label:"品类维度"},{label:"品类维度编号"},{label:"法规类别"},{label:"法规类别编号"},{label:"学科分类"},{label:"学科分类编号"},{label:"法规来源ID"},{label:"文献出处"},{label:"法规文献出处ID"},{label:"套系栏目"},{label:"价格"},{label:"创建时间",isDdisabled:!0,NoNeed:!0}],case:[{label:"标题",value:""},{label:"主要问题(副标题)",name:"副标题"},{label:"案件类别"},{label:"案件类别编号"},{label:"案例编号"},{label:"效力状态"},{label:"品类维度"},{label:"品类维度编号"},{label:"案例来源ID"},{label:"案例(文献)出处",name:"出处"},{label:"文献出处ID"},{label:"套系栏目"},{label:"价格"},{label:"创建时间",isDdisabled:!0,NoNeed:!0}],referee:[{label:"标题",value:""},{label:"案号"},{label:"品类维度"},{label:"品类维度编号"},{label:"案件类别"},{label:"案件类别编号"},{label:"审理法院"},{label:"裁判来源ID"},{label:"裁判文献出处"},{label:"裁判文献出处ID"},{label:"套系栏目"},{label:"价格"},{label:"创建时间",isDdisabled:!0,NoNeed:!0}]}},methods:{getDetail:function(){var t=this;this.services.detailResource({id:this.detailData.id}).then(function(e){t.detailDataOwn=e.data,t.getMainList.forEach(function(t){for(var a in e.data)a!==t.label&&a!==t.name||(t.value=e.data[a])}),t.metadata=e.data.attributes||[]})},getMulu:function(t){var e=this;r.getBookCatalog({id:t}).then(function(t){var a=(0,n.recursionTree)(t.data,"pid","root");e.ml=a,e.currMulu=a})},handleClick:function(t,e){"ml"==t.name&&(this.currMulu=this.ml)},handleNodeClick:function(t,e,a){this.currMulu=e.data.children},muluSort:function(t,e,a){var i=this.currMulu;"up"===a?e>0&&(i.splice(e,1),i.splice(e-1,0,t)):(i.splice(e,1),i.splice(e+1,0,t)),r.siblingSort({id:t.id,sort:a})},submitDetail:function(){var t=c(i.default.mark(function t(e){var a,n,r=this;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.$refs.detailForm.valiAll()){t.next=3;break}return t.abrupt("return");case 3:if(a=this.$progress(),t.prev=4,!this.imgFile){t.next=8;break}return t.next=8,s.getTask(this.imgFile).then(function(t){r.detailDataOwn.img=t.data.path});case 8:return n={},this.getMainList.forEach(function(t){t.name?n[t.name]=t.value:n[t.label]=t.value}),t.next=12,this.services.save(l({id:this.detailData?this.detailData.id:null},n,{attributes:this.metadata,type:this.detailType,link_id:this.defaultData?this.defaultData.id:null}));case 12:this.$emit("detailBack"),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(4),t.t0;case 18:a.close();case 19:case"end":return t.stop()}},t,this,[[4,15]])}));return function(e){return t.apply(this,arguments)}}(),previewImg:function(t){var e=t.target.files[0];this.imgFile=e,this.previewImgUrl=URL.createObjectURL(e)},upLoadXml:function(){var t=c(i.default.mark(function t(){var e,a=this;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.file){t.next=5;break}return e=this.$progress(),t.next=4,s.getTask(this.file,{is_chunk:!0,size:1048576},function(t){e.percentage=t}).then(function(t){a.detailDataOwn.preview=t.data.path});case 4:e.close();case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),previewBook:function(t){var e=t.target.files[0];this.file=e,dir(e,"file")}},computed:{getMainList:function(){switch(Number(this.detailType)){case 1:return this.case;case 2:return this.statute;case 3:return this.viewpoint;case 4:return this.referee}}}}},395:function(t,e,a){},491:function(t,e,a){"use strict";a.r(e);var i=a(503),l=a(393);for(var n in l)"default"!==n&&function(t){a.d(e,t,function(){return l[t]})}(n);a(492);var s=a(0),r=Object(s.a)(l.default,i.a,i.b,!1,null,"51535bf4",null);r.options.__file="detail.vue",e.default=r.exports},492:function(t,e,a){"use strict";var i=a(395);a.n(i).a},503:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"div"},[!t.readOnly&&t.detailReadOnly?a("el-button",{staticClass:"modifyBtn",attrs:{type:"primary",size:"small",plain:""},on:{click:function(e){t.detailReadOnly=!1}}},[t._v("修改")]):t._e(),a("el-tabs",{attrs:{value:t.type},on:{"tab-click":t.handleClick}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[a("div",{staticClass:"div"},[a("VaForm",{ref:"detailForm"},[a("form",{ref:"detailForm",staticClass:"detailForm"},[a("fieldset",{attrs:{disabled:t.readOnly||t.detailReadOnly}},t._l(t.getMainList,function(e){return a("div",{staticClass:"group"},[a("div",{staticClass:"label"},[t._v("*"+t._s(e.label)+":")]),a("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{type:'required'}"},{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],staticClass:"form-control",attrs:{type:"text",maxlength:"20",disabled:e.isDdisabled&&e.value&&e.value.length>=10},domProps:{value:e.value},on:{input:function(a){a.target.composing||t.$set(e,"value",a.target.value)}}})])})),t.readOnly?t._e():a("div",{staticClass:"btns"},[a("el-button",{attrs:{ype:"info"},on:{click:function(e){t.$emit("update:detailDialog",!1)}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitDetail()}}},[t._v("确定")])],1)])])],1)]),a("el-tab-pane",{attrs:{label:"元数据",name:"data"}},[a("MetaData",{attrs:{metadata:t.metadata,readOnly:t.readOnly||t.detailReadOnly},on:{submit:function(e){t.submitDetail()},back:function(e){t.$emit("update:detailDialog",!1)}}})],1),a("el-tab-pane",{attrs:{label:"目录",name:"ml"}},[a("div",{staticClass:"muluWrap"},[a("div",{staticClass:"left"},[a("el-tree",{staticClass:"muluList",attrs:{data:t.ml,props:t.defaultProps,"node-key":"id"},on:{"node-click":t.handleNodeClick}})],1),a("div",{staticClass:"right"},[a("fieldset",{attrs:{disabled:t.readOnly||t.detailReadOnly}},[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{attrs:{width:"50"}},[t._v("序号")]),a("th",[t._v(" 名称")]),a("th",{attrs:{width:"110"}},[t._v(" 调序")])])]),a("tbody",t._l(t.currMulu,function(e,i){return a("tr",[a("th",{domProps:{textContent:t._s(i+1)}}),a("th",{staticClass:"th-name",domProps:{textContent:t._s(e.chapter_name)}}),a("th",[a("div",{staticClass:"div"},[a("el-button",{staticClass:"iconRotate up",attrs:{disabled:0==i,icon:"el-icon-back",size:"mini"},on:{click:function(a){0!=i&&t.muluSort(e,i,"up")}}}),a("el-button",{staticClass:"iconRotate down",attrs:{disabled:i+1==t.currMulu.length,icon:"el-icon-back",size:"mini"},on:{click:function(a){i+1!=t.currMulu.length&&t.muluSort(e,i,"down")}}})],1)])])}))])])])])])],1)],1)},l=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return l})},582:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resourceList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.type;e&&e.indexOf("-")&&(t.type=e.split("-")[1]);return(0,l.request_get)("/api/databooks",t)},e.save=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,a=r(t,["id"]);if(e)return(0,l.request_put)(u({id:e}),a);return(0,l.request_post)("/api/databooks",a)},e.detailResource=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,a=r(t,["id"]);return(0,l.request_get)(u({id:e}),a)},e.del=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.request_post)("/api/databooks/delete",t)},e.listGroup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.request_get)("/api/databooks/groups",t)},e.addGroup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.request_post)("/api/databooks/groups",t)},e.modifyGroup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,a=r(t,["id"]);return(0,l.request_put)(o({id:e}),a)},e.deleteGroup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,a=r(t,["id"]);return(0,l.request_delete)(o({id:e}),a)},e.moveGroup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.request_put)("/api/groups/databooks",t)};var i,l=a(4),n=a(8),s=(i=n)&&i.__esModule?i:{default:i};function r(t,e){var a={};for(var i in t)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);return a}var o=s.default.compile("/api/databooks/groups/:id"),u=s.default.compile("/api/databooks/:id")},712:function(t,e,a){"use strict";a.r(e);var i=a(713),l=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,function(){return i[t]})}(n);e.default=l.a},713:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t},l=(f(a(82)),p(a(20)),f(a(155))),n=f(a(154)),s=f(a(407)),r=f(a(365)),o=f(a(611)),u=f(a(491)),d=a(122),c=p(a(582));a(164);function p(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}function f(t){return t&&t.__esModule?t:{default:t}}e.default={components:{Menu:l.default,Top:n.default,Detail:u.default,GroupList:r.default,Reader:s.default,Release:o.default},mixins:[d.main],data:function(){return a={list:[{name:"文本",value:"0"},{name:"图片",value:"1"}]},(e="detailType")in(t={services:c,list:null,readerDialog:!1,readerId:"",page:null,groupList:null,detailDialog:!1,detailDialogType:"info",detailData:null,publishDialog:!1,moveToOtherDiaolog:!1,moveIds:null,toId:null,fabuIds:[],detailType:null,workType:[{name:"权威案例",value:"1"},{name:"法律法规",value:"2"},{name:"法律观点",value:"3"},{name:"裁判文书",value:"4"}]})?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t;var t,e,a},methods:{getList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.page&&this.page.num||1,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.page&&this.page.offset||10,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.services.resourceList(i({pageNum:t,pageOffset:a,group_id:this.currGroup},l)).then(function(t){e.list=t.data,e.page=t.page})},opneDetailDialog:function(t,e){this.detailType=e.type,this.detailData=e,this.detailDialogType=t,this.detailDialog=!0},addDebris:function(t,e){this.detailDialog=!0,this.detailDialogType=e,this.detailData=null,this.metadata=null},delGroup:function(t){var e=this;this.services.deleteGroup({id:t}).then(function(a){t===e.currGroup&&e.$router.push({path:e.$route.path,query:{id:"non"}}),e.getGroupList()})},opnePublishDialog:function(t){this.detailData=t,t?this.fabuIds.push(t.id):this.fabuIds=this.$getChecked("ids",this),this.fabuIds&&this.fabuIds.length>0&&(this.publishDialog=!0)},releaseBack:function(t){this.publishDialog=!1},openReader:function(t){this.readerId=t.id,this.readerDialog=!0},products:function(t){var e=this;this.services.products({id:t}).then(function(t){e.$message.success("生成成功!")}).catch(function(t){var a=t.payload;for(var i in a.messages){e.$message.error(a.messages[i]);break}})},dropdown:function(t){this.detailDialogType="info",this.detailType=t,this.detailDialog=!0,this.detailData=this.metadata=null}}}},714:function(t,e,a){},937:function(t,e,a){"use strict";var i=a(714);a.n(i).a}}]);