(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{1104:function(t,e,a){"use strict";a.r(e);var i=a(1162),n=a(817);for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);a(1105);var r=a(0),l=Object(r.a)(n.default,i.a,i.b,!1,null,"5f74e1cd",null);l.options.__file="addResource.vue",e.default=l.exports},1105:function(t,e,a){"use strict";var i=a(819);a.n(i).a},1106:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.addGroup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/api/dataarticles/groups",t)},e.getList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/api/dataarticles",t)},e.detailResource=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,a=l(t,["id"]);return(0,n.request_get)(u({id:e}),a)},e.urgentDigital=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_put)("/api/dataarticles/urgent",t)},e.audits=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_put)("/api/dataarticles/audits",t)},e.issuance=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,a=l(t,["id"]);return(0,n.request_put)(toPathIssuance({id:e}),a).then(function(t){return suance({id:e,info:t.data}),t})},e.save=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,a=l(t,["id"]);if(e)return(0,n.request_put)("/api/dataarticles/"+e,a);return(0,n.request_post)("/api/dataarticles",a)},e.del=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/api/dataarticles/delete",t)},e.modifyGroup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,a=l(t,["id"]);return(0,n.request_put)(o({id:e}),a)},e.listGroup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/api/dataarticles/groups",t)},e.deleteGroup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,a=l(t,["id"]);return(0,n.request_delete)(o({id:e}),a)},e.moveGroup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_put)("/api/groups/dataarticles",t)};var i,n=a(4),s=a(8),r=(i=s)&&i.__esModule?i:{default:i};function l(t,e){var a={};for(var i in t)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);return a}var o=r.default.compile("/api/dataarticles/groups/:id"),u=r.default.compile("/api/dataarticles//:id")},1107:function(t,e,a){"use strict";var i=a(820);a.n(i).a},1117:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"index clearfix"},[a("Top",{attrs:{currentPlant:"X-PUBLISH"}}),a("Menu",{attrs:{curr:"/contentLibrary/digitalBook"}}),a("div",{staticClass:"mainRight"},[a("div",{staticClass:"contentWrap"},[a("div",{staticClass:"contentLeft"},[a("div",{staticClass:"maindata"},[a("div",{staticClass:"serachWrap",on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.query()}}},[a("div",{staticClass:"title"}),a("form",{attrs:{id:"mainForm"}},[a("span",{staticClass:"group-inline"},[a("el-input",{attrs:{placeholder:"请输入名称",name:"name",clearable:""}})],1),a("span",{staticClass:"group-inline"},[a("el-select",{attrs:{placeholder:"类别"},model:{value:t.options.value,callback:function(e){t.$set(t.options,"value",e)},expression:"options.value"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})}))],1),a("span",{staticClass:"group-inline"},[a("TimePick",{attrs:{inputsName:["start_time","end_time"]}})],1),a("span",{staticClass:"group-inline float-right"},[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search",plain:""},on:{click:t.query}},[t._v("搜索")]),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus",plain:""},on:{click:t.openDetailDialogAdd}},[t._v("新建")])],1)])]),a("div",{staticClass:"tableWrap"},[a("div",{staticClass:"tableTop"},[a("div",{staticClass:"title vel-line"},[a("span",[t._v("全部 "),t.page?a("span",{staticClass:"totalNum"},[t._v("("+t._s(t.page.total)+")")]):t._e()]),a("div",{staticClass:"btns"},[a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:t.urgentDigital}},[t._v("加急审核")]),a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:t.moveToOther}},[t._v("移动分组")]),a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){t.delChoosen(!1)}}},[t._v("删除")])],1)])]),a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{staticClass:"allBtn"},[a("input",{attrs:{type:"checkbox"},on:{click:function(e){t.checkAll(e)}}})]),a("th",[t._v("名称")]),a("th",[t._v("类别")]),a("th",{attrs:{width:"70"}},[t._v("审核状态")]),a("th",{attrs:{width:"70"}},[t._v("发布状态")]),a("th",{staticClass:"time"},[t._v("分发时间")]),a("th",{staticClass:"operate"},[t._v("操作")])])]),t.list?a("tbody",t._l(t.list,function(e){return a("tr",[a("td",[a("input",{ref:"ids",refInFor:!0,attrs:{type:"checkbox",name:"ids"},domProps:{value:e.id}})]),a("td",[a("img",{staticClass:"cover-photo",attrs:{src:e.img_src}}),a("div",{staticClass:"th-name bookName",attrs:{title:e.name}},[t._v(t._s(e.name))])]),a("td",[a("div",{staticClass:"th-name",attrs:{title:e.tag}},[t._v(t._s(e.type_name))])]),a("td",[a("div",{staticClass:"th-name"},[t._v(t._s(e.status))])]),a("td",[a("div",{staticClass:"th-name"},[t._v(t._s(e.release_status_name))])]),a("td",[a("div",{staticClass:"th-name"},[t._v(t._s(e.release_time||"_"))])]),a("td",[a("div",{staticClass:"btns"},[a("span",{staticClass:"icon icon-detail",attrs:{size:"mini",title:"详情",type:"primary",plain:""},on:{click:function(a){t.opneDetailDialog("info",e)}}}),1!=e.audits_status?a("span",{staticClass:"icon icon-publish",attrs:{size:"mini",title:"审核",type:"primary",plain:""},on:{click:function(a){t.audits(e.id)}}}):t._e(),3==e.audits_status?a("span",{staticClass:"icon icon-fenfa",attrs:{size:"mini",title:"分发",type:"primary",plain:""},on:{click:function(a){t.opnePublishDialog(e)}}}):t._e(),1!=e.audits_status?a("span",{staticClass:"icon icon-delete",attrs:{size:"mini",title:"删除",type:"primary",plain:""},on:{click:function(a){t.delChoosen(e.id)}}}):t._e()])])])})):t._e()]),t.page?a("div",{staticClass:"pageWrap"},[a("el-pagination",{attrs:{small:!1,background:"","current-page":t.page.num,"page-sizes":[10,50,100],"page-size":t.page.offset,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()]),a("div",{staticClass:"gruopList"},[a("GroupList",{attrs:{groupList:t.groupList,currGroup:t.currGroup},on:{addGroup:t.addGroup,updateGroup:t.updateGroup,delGroup:t.delGroup,groupChange:t.groupChange}})],1)])])])]),a("div",{staticClass:"dialogs"},[a("el-dialog",{attrs:{center:!1,visible:t.detailDialog,"close-on-click-modal":!1,top:"50px",width:"1000px"},on:{"update:visible":function(e){t.detailDialog=e}}},[a("div",{staticClass:"content",attrs:{slot:"title"},slot:"title"},[t.detailDialog?a("Detail",{attrs:{type:t.detailDialogType,detailDialog:t.detailDialog,detailData:t.detailData,detailType:t.detailType,services:t.services,defaultData:t.resourceDate,readOnly:t.readOnly},on:{detailBack:t.detailBack,"update:detailDialog":function(e){t.detailDialog=e}}}):t._e()],1)]),a("el-dialog",{attrs:{center:!1,visible:t.addDialog,"close-on-click-modal":!1,top:"50px",width:"700px"},on:{"update:visible":function(e){t.addDialog=e}}},[a("AddResource",{on:{slecet:t.slecet}})],1),a("Examine",{attrs:{examineDialog:t.examineDialog},on:{"update:examineDialog":function(e){t.examineDialog=e},saveExamine:t.saveExamine}}),t.publishDialog?a("Dispense",{attrs:{publishDialog:t.publishDialog,item:t.detailData,is_release:!1},on:{"update:publishDialog":function(e){t.publishDialog=e},dispenseOk:t.dispenseOk}}):t._e(),a("el-dialog",{attrs:{center:!1,visible:t.moveToOtherDiaolog,"close-on-click-modal":!1,title:"移动分组",width:"500px"},on:{"update:visible":function(e){t.moveToOtherDiaolog=e}}},[a("span",{}),a("div",{staticClass:"group"},[a("div",{staticClass:"label"},[t._v("移动到")]),a("select",{ref:"moveToId",staticClass:"form-control",attrs:{placeholder:"请选择"}},t._l(t.groupList,function(e,i){return e.id!=t.currGroup&&""!=e.id?a("option",{domProps:{value:e.id,textContent:t._s(e.name)}}):t._e()}))]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.moveToSubmit}},[t._v(" 确定")]),a("el-button",{on:{click:function(e){t.moveToOtherDiaolog=!1}}},[t._v("返回")])],1)])],1)],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},1162:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[t.resourceDialog?a("SelResource",{attrs:{resourceDialog:t.resourceDialog,curSoucesList:[],type:"20-"+t.currentType,singleElection:!1},on:{"update:resourceDialog":function(e){t.resourceDialog=e},select:t.addSelcet}}):t._e(),a("div",{staticClass:"type"},[a("span",[t._v("新建类型")]),a("el-select",{model:{value:t.types.value,callback:function(e){t.$set(t.types,"value",e)},expression:"types.value"}},t._l(t.types,function(t){return a("el-option",{key:t.value,attrs:{value:t.value,label:t.name}})}))],1),a("div",{staticClass:"btn"},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.selResource}},[t._v("选择资源")])],1)],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},355:function(t,e,a){"use strict";a.r(e);var i=a(1117),n=a(815);for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);a(1107);var r=a(0),l=Object(r.a)(n.default,i.a,i.b,!1,null,"6d79123e",null);l.options.__file="index.vue",e.default=l.exports},362:function(t,e,a){"use strict";a.r(e);var i=a(363),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,function(){return i[t]})}(s);e.default=n.a},363:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["groupList","currGroup"],data:function(){return{newGroupDialogOpen:!1,updateGroupDialogOpen:!1,currEditGroup:null}},created:function(){},computed:{},methods:{groupChange:function(t){this.$emit("groupChange",t)},addGroupDialog:function(){},delGroup:function(t){var e=this;this.$confirm("是否删除分组:"+t.name).then(function(a){dir(a),e.$emit("delGroup",t.id)}).catch(function(t){dir(t)})},updateGroupDialog:function(t){this.updateGroupDialogOpen=!0,this.currEditGroup=t},addGroup:function(){if(this.$refs.addGroupForm.valiAll()){var t=document.querySelector("#addGroupForm");this.$emit("addGroup",t),this.newGroupDialogOpen=!1}},updateGroup:function(){if(this.$refs.updateGroupForm.valiAll()){var t=document.querySelector("#updateGroupForm");this.$emit("updateGroup",t),this.updateGroupDialogOpen=!1}}}}},364:function(t,e,a){},365:function(t,e,a){"use strict";a.r(e);var i=a(370),n=a(362);for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);a(366);var r=a(0),l=Object(r.a)(n.default,i.a,i.b,!1,null,"176cd962",null);l.options.__file="GroupList.vue",e.default=l.exports},366:function(t,e,a){"use strict";var i=a(364);a.n(i).a},367:function(t,e,a){"use strict";a.r(e);var i=a(368),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,function(){return i[t]})}(s);e.default=n.a},368:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(122),n=a(123);e.default={mixins:[i.getIconStyle],props:{publishDialog:{type:Boolean,default:!1},item:{type:Object,default:{}},is_release:Boolean},data:function(){return{list:null,coverDialog:!1,choiceDialog:!1,currentItem:null,currentVersion:null}},created:function(){this.getList()},methods:{getList:function(){var t=this;(0,n.getDispense)({entity_type:this.item.type_number||this.item.type,id:this.item.id}).then(function(e){t.list=e.data}).catch(function(e){var a=e.payload;for(var i in a.messages){t.$message.error(a.messages[i]);break}})},colse:function(){this.$emit("update:publishDialog",!1)},save:function(){var t=[];this.$refs.dispense.querySelectorAll("input[type=checkbox]:checked").forEach(function(e){t.push(e.value)}),t.length?this.$emit("dispenseSave",t):this.$message.error("请选择你要发布的平台")},pushTime:function(t){return t?"最近"+t+"发布过":"最近暂无分发"},push:function(t){var e=this;this.currentItem=t,this.is_release&&t.release_msg.length?this.$confirm("信息不全是否分发?").then(function(a){t.version?e.coverDialog=!0:e.dispense()},function(t){var e=t.payload;log(e.message)}).catch(function(t){log("cancel")}):t.version&&t.version.length?this.coverDialog=!0:this.dispense()},dispense:function(t,e){var a=this;(0,n.dispense)({platform_id:this.currentItem.id,audits_id:this.item.audits_id,is_cover:t,version_id:e}).then(function(t){a.$message.success("分发提交成功,请稍后查看结果!"),a.$emit("dispenseOk")}).catch(function(t){var e=t.payload;for(var i in e.messages){a.$message.error(e.messages[i]);break}})},getdefect:function(t){return"缺失字段: "+t.release_msg.join("/")},getBtnName:function(t){return this.is_release&&!t.is_release?"缺少关键信息不能分发":t.release_msg&&t.release_msg.length?"确认分发":"分发"},coverDispense:function(){var t=this;if(!this.currentVersion)return this.$message.warning("请选择你要覆盖的版本号!");var e=this.currentItem.version.find(function(e){return e.xread_book_id===t.currentVersion}).version_id;this.dispense(this.currentVersion,e)}}}},369:function(t,e,a){},370:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"div"},[a("div",{staticClass:"groupWrap"},[a("div",{staticClass:"list"},[a("ul",t._l(t.groupList,function(e){return a("li",{staticClass:"licontent",class:{red:e.id==t.currGroup}},[a("div",{staticClass:"name ellipsis",attrs:{title:e.name+"("+e.num+")"},on:{click:function(a){t.groupChange(e.id)}}},[a("span",{staticClass:"title"},[t._v(t._s(e.name))]),a("span",[t._v(t._s("("+e.num+")"))])]),""!=e.id&&"non"!=e.id?a("div",{staticClass:"btns"},[a("span",{on:{click:function(a){t.updateGroupDialog(e)}}},[a("i",{staticClass:"el-icon-edit"})]),a("span",{on:{click:function(a){t.delGroup(e)}}},[a("i",{staticClass:"el-icon-delete"})])]):t._e()])}))]),a("div",{staticClass:"addGroupBtnWrap"},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.newGroupDialogOpen=!0}}},[a("i",{staticClass:"el-icon-plus"},[t._v("新建分组")])])],1)]),a("div",{staticClass:"dialogs"},[t.newGroupDialogOpen?a("el-dialog",{attrs:{title:"新增",visible:t.newGroupDialogOpen,width:"500px"},on:{"update:visible":function(e){t.newGroupDialogOpen=e}}},[a("div",{staticClass:"formWrap"},[a("VaForm",{ref:"addGroupForm"},[a("form",{attrs:{id:"addGroupForm"}},[a("div",{staticClass:"group"},[a("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"}],staticClass:"form-control",attrs:{name:"name"}})])])])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:function(e){t.newGroupDialogOpen=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addGroup}},[t._v("确定")])],1)]):t._e(),t.updateGroupDialogOpen?a("el-dialog",{attrs:{title:"修改",visible:t.updateGroupDialogOpen,width:"500px"},on:{"update:visible":function(e){t.updateGroupDialogOpen=e}}},[a("div",{staticClass:"formWrap"},[a("VaForm",{ref:"updateGroupForm"},[t.currEditGroup?a("form",{attrs:{id:"updateGroupForm"}},[a("div",{staticClass:"group"},[a("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"}],staticClass:"form-control",attrs:{name:"name"},domProps:{value:t.currEditGroup.name}}),a("input",{staticClass:"hide",attrs:{name:"id"},domProps:{value:t.currEditGroup.id}})])]):t._e()])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:function(e){t.updateGroupDialogOpen=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.updateGroup}},[t._v("确定")])],1)]):t._e()],1)])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},371:function(t,e,a){"use strict";a.r(e);var i=a(372),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,function(){return i[t]})}(s);e.default=n.a},372:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=l(a(3)),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t},s=a(379),r=l(a(82));function l(t){return t&&t.__esModule?t:{default:t}}function o(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}e.default={props:{resourceDialog:{type:Boolean,default:!1},singleElection:{type:Boolean,default:!0},type:{type:String,default:"1"},curSoucesList:{type:Array,default:[]},isShowType:{type:Boolean,default:!1},isShowSearch:Boolean,isShowResource:Boolean,isDebris:{default:!1},parameter:Object},data:function(){return{dataList:[],page:null,currentType:null,contentType:[{name:"电子书",value:"1"},{name:"图片",value:"3"},{name:"音频",value:"4"},{name:"视频",value:"5"},{name:"3D内容",value:"6"},{name:"VR",value:"7"},{name:"AR",value:"8"}],query:{}}},created:function(){this.currentType=this.type||"1",this.isShowResource&&this.contentType.push({name:"共享资源",value:"22"}),this.type.includes("20")&&(this.contentType=[{name:"权威案例",value:"20-1"},{name:"法律法规",value:"20-2"},{name:"法律观点",value:"20-3"},{name:"裁判文书",value:"20-4"}])},methods:{getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.page&&this.page.num||1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.page&&this.page.offset||10;(0,s._addBooks)(n({pageNum:e,pageOffset:a,type:this.currentType||this.type},this.parameter,this.query)).then(function(e){t.dataList=e.data||[],t.page=e.page})},colse:function(){this.$emit("update:resourceDialog",!1)},save:function(){var t=[];this.$refs.dispense.querySelectorAll("input[type=checkbox]:checked").forEach(function(e){t.push(e.value)}),t.length?this.$emit("dispenseSave",t):this.$message.error("请选择你要发布的平台")},search:function(){this.query=(0,r.default)(document.querySelector("#detailSearchForm"),{hash:!0}),this.getList(1,this.page.offset)},addSelection:function(){var t,e=(t=i.default.mark(function t(){var e,a,s,r,l,u,c,d,p,f=this;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.querySelector(".addBookForm"),a=e.querySelectorAll('input[name="ids"]:checked'),s=[],a.length){t.next=5;break}return t.abrupt("return",this.$message.warning("请选择添加内容"));case 5:r=!0,l=!1,u=void 0,t.prev=8,c=function(){var t=p.value;if(f.curSoucesList.findIndex(function(e){return e.id==t.value})>-1)return"continue";s.push(n({},f.dataList.find(function(e){return e.id==t.value}),{action:"add"}))},d=a[Symbol.iterator]();case 11:if(r=(p=d.next()).done){t.next=18;break}if("continue"!==c()){t.next=15;break}return t.abrupt("continue",15);case 15:r=!0,t.next=11;break;case 18:t.next=24;break;case 20:t.prev=20,t.t0=t.catch(8),l=!0,u=t.t0;case 24:t.prev=24,t.prev=25,!r&&d.return&&d.return();case 27:if(t.prev=27,!l){t.next=30;break}throw u;case 30:return t.finish(27);case 31:return t.finish(24);case 32:this.$emit("select",[].concat(s,o(this.curSoucesList)));case 33:case"end":return t.stop()}},t,this,[[8,20,24,32],[25,,27,31]])}),function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(n,s){try{var r=e[n](s),l=r.value}catch(t){return void a(t)}if(!r.done)return Promise.resolve(l).then(function(t){i("next",t)},function(t){i("throw",t)});t(l)}("next")})});return function(){return e.apply(this,arguments)}}(),checkAll:function(t,e){var a=this;document.querySelector("."+e).querySelectorAll('input[name="ids"]').forEach(function(e,i){var s=a.curSoucesList.findIndex(function(t){return t.id==e.value||t.b_id==e.value});t.target.checked?-1==s&&a.curSoucesList.push(n({},a.dataList.find(function(t){return t.id==e.value}),{action:"add"})):a.curSoucesList.splice(s,1),e.checked=t.target.checked})},uncheckedAll:function(t,e){var a=this.curSoucesList.findIndex(function(t){return t.id==e.id||t.b_id==e.id});t.target.checked?-1==a&&this.curSoucesList.push(e):this.curSoucesList.splice(a,1),this.singleElection||(this.$refs.ids.forEach(function(t){return t.checked=!1}),t.target.checked=!0)},isChecked:function(t){return this.curSoucesList.findIndex(function(e){return e.id===t||e.b_id===t})>-1},handleSizeChange:function(t){this.query=(0,r.default)(document.querySelector("#detailSearchForm"),{hash:!0}),this.getList(1,t)},handleCurrentChange:function(t){this.query=(0,r.default)(document.querySelector("#detailSearchForm"),{hash:!0}),this.getList(t,this.page.offset)}},watch:{currentType:function(t){this.getList()}}}},373:function(t,e,a){},374:function(t,e,a){"use strict";a.r(e);var i=a(392),n=a(371);for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);a(389);var r=a(0),l=Object(r.a)(n.default,i.a,i.b,!1,null,"8d4001a2",null);l.options.__file="Resource.vue",e.default=l.exports},376:function(t,e,a){"use strict";a.r(e);var i=a(378),n=a(367);for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);a(377);var r=a(0),l=Object(r.a)(n.default,i.a,i.b,!1,null,"1fd5a38b",null);l.options.__file="Dispense.vue",e.default=l.exports},377:function(t,e,a){"use strict";var i=a(369);a.n(i).a},378:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{center:!1,visible:t.coverDialog,top:"50px",width:"500px","show-close":!1,title:"x-read系统中已有该产品，选择你的操作"}},[a("div",{staticClass:"coverContent"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.choiceDialog=!0}}},[t._v("覆盖原有产品")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dispense()}}},[t._v("创建新的产品版本")])],1),a("div",{staticClass:"footer dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:function(e){t.coverDialog=!1}}},[t._v("取消")])],1)]),t.choiceDialog?a("el-dialog",{attrs:{center:!1,visible:t.choiceDialog,top:"50px",width:"500px","show-close":!1,title:"选择版本号"}},[a("div",{staticClass:"coverContent"},[a("el-radio-group",{model:{value:t.currentVersion,callback:function(e){t.currentVersion=e},expression:"currentVersion"}},t._l(t.currentItem.version,function(e){return a("el-radio",{key:e.xread_book_id,attrs:{label:e.xread_book_id}},[t._v(t._s(e.version_id))])}))],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.coverDispense}},[t._v("确定")]),a("el-button",{attrs:{type:"info"},on:{click:function(e){t.choiceDialog=!1}}},[t._v("取消")])],1)]):t._e(),a("el-dialog",{attrs:{center:!1,visible:t.publishDialog,top:"50px",width:"1000px","show-close":!1}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"el-icon-close",on:{click:t.colse}}),a("el-tabs",{attrs:{value:"ff"}},[a("el-tab-pane",{attrs:{label:"分发",name:"ff"}})],1)],1),a("ul",{ref:"dispense",staticClass:"content modular"},t._l(t.list,function(e){return a("li",[a("div",{staticClass:"icon"},[a("div",{class:t.getStyle(e.type)}),a("span",{domProps:{textContent:t._s(e.name)}})]),a("ul",{staticClass:"defect"},[e.release_msg&&!e.release_msg.length?a("li",{staticClass:"pass"},[t._v("可正常分发")]):t._e(),e.release_msg&&e.release_msg.length?a("li",{domProps:{textContent:t._s(t.getdefect(e))}}):t._e()]),a("el-button",{attrs:{type:!t.is_release||e.is_release?"primary":"info",size:"mini",plain:""},domProps:{textContent:t._s(t.getBtnName(e))},on:{click:function(a){(!t.is_release||e.is_release)&&t.push(e)}}})],1)})),a("div",{staticClass:"footer dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:t.colse}},[t._v("取消")])],1)])],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},389:function(t,e,a){"use strict";var i=a(373);a.n(i).a},392:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{staticClass:"restBody2",attrs:{center:!1,visible:t.resourceDialog,width:"1200px",top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,"append-to-body":""},on:{"update:visible":function(e){t.resourceDialog=e}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"el-icon-close",on:{click:t.colse}}),a("el-tabs",{attrs:{value:"detail"}},[a("el-tab-pane",{attrs:{label:"添加",name:"detail"}})],1)],1),a("el-form",{staticClass:"addBookForm"},[t.isShowType?a("span",{staticClass:"group-inline",staticStyle:{margin:"20px","margin-top":"0"}},[a("el-radio-group",{model:{value:t.currentType,callback:function(e){t.currentType=e},expression:"currentType"}},t._l(t.contentType,function(e){return a("el-radio-button",{key:e.id,attrs:{label:e.value}},[t._v(t._s(e.name))])}))],1):t._e(),t.isShowSearch?t._e():a("div",{staticClass:"serachWrap"},[a("form",{attrs:{id:"detailSearchForm"}},[a("span",{staticClass:"group-inline"},[a("input",{staticClass:"form-control",attrs:{placeholder:"输入名称",name:"name"}})]),a("span",{staticClass:"group-inline"},[a("input",{staticClass:"form-control",attrs:{placeholder:"输入标签",name:"tag"}})]),a("span",{staticClass:"group-inline"},[a("TimePick",{attrs:{inputsName:["start_time","end_time"]}})],1),a("span",{staticClass:"group-inline right"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",plain:""},on:{click:t.search}},[t._v("搜索")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.addSelection}},[t._v("添加选中")])],1)])]),a("table",{staticClass:"table",attrs:{width:"100%"}},[a("thead",[a("tr",[a("th",{attrs:{width:"80"}},[t.singleElection?a("input",{attrs:{type:"checkbox"},on:{click:function(e){t.checkAll(e,"addBookForm")}}}):t._e(),a("span",{domProps:{textContent:t._s(t.singleElection?"全选":"选择")}})]),a("th",[t._v("名称")]),a("th",[t._v("标签")]),a("th",[t._v("类型")]),a("th",[t._v("创建时间")])])]),t.dataList.length?a("tbody",t._l(t.dataList,function(e,i){return a("tr",[a("td",[a("input",{ref:"ids",refInFor:!0,attrs:{type:"checkbox","data-type":e.status,name:"ids"},domProps:{value:e.id,checked:t.isChecked(e.id)},on:{click:function(a){t.uncheckedAll(a,e)}}})]),a("td",[t._v(t._s(e.name||e.title))]),a("td",[t._v(t._s(e.tag))]),a("td",[t._v(t._s(e.type_name))]),a("td",[t._v(t._s(e.create_time))])])})):a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"},attrs:{colspan:"5"}},[t._v("暂无数据")])])])]),t.page?a("div",{staticClass:"pageWrap"},[a("el-pagination",{attrs:{small:!1,background:"","current-page":t.page.num,"page-sizes":[10,50,100],"page-size":t.page.offset,layout:"total, sizes,prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:t.colse}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addSelection}},[t._v("确定")])],1)],1)],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},393:function(t,e,a){"use strict";a.r(e);var i=a(394),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,function(){return i[t]})}(s);e.default=n.a},394:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=c(a(3)),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t},s=a(156),r=u(a(27)),l=u(a(404)),o=a(122);c(a(1));function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}function c(t){return t&&t.__esModule?t:{default:t}}function d(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(n,s){try{var r=e[n](s),l=r.value}catch(t){return void a(t)}if(!r.done)return Promise.resolve(l).then(function(t){i("next",t)},function(t){i("throw",t)});t(l)}("next")})}}e.default={props:["type","detailData","detailDialog","detailType","defaultData","services","readOnly"],created:function(){var t=this;if(this.readOnly,this.detailType,!this.defaultData&&this.detailData)this.getDetail(),this.getMulu(this.detailData.id);else if(this.getMainList.forEach(function(e){for(var a in t.defaultData)a!==e.label&&a!==e.name||(e.value=t.defaultData[a])}),this.metadata=this.defaultData.attributes||[],this.readOnly&&this.defaultData.components){var e=(0,s.recursionTree)(this.defaultData.components,"pid","root");this.ml=e,this.currMulu=e}else this.getMulu(this.defaultData.id)},mixins:[o.getIconStyle],data:function(){return{detailDataOwn:{attributes:[]},metadata:[],ml:null,defaultProps:{children:"children",label:"chapter_name"},currMulu:null,previewImgUrl:null,file:null,viewpoint:[{label:"标题",value:""},{label:"副标题"},{label:"作者"},{label:"品类维度"},{label:"品类维度编号"},{label:"专业类别"},{label:"专业类别编号"},{label:"文集类别"},{label:"文集来源ID"},{label:"文献出处"},{label:"文献出处ID"},{label:"套系栏目"},{label:"价格"},{label:"创建时间",isDdisabled:!0,NoNeed:!0}],statute:[{label:"标题",value:""},{label:"发文字号"},{label:"发布单位"},{label:"效力状态"},{label:"品类维度"},{label:"品类维度编号"},{label:"法规类别"},{label:"法规类别编号"},{label:"学科分类"},{label:"学科分类编号"},{label:"法规来源ID"},{label:"文献出处"},{label:"法规文献出处ID"},{label:"套系栏目"},{label:"价格"},{label:"创建时间",isDdisabled:!0,NoNeed:!0}],case:[{label:"标题",value:""},{label:"主要问题(副标题)",name:"副标题"},{label:"案件类别"},{label:"案件类别编号"},{label:"案例编号"},{label:"效力状态"},{label:"品类维度"},{label:"品类维度编号"},{label:"案例来源ID"},{label:"案例(文献)出处",name:"出处"},{label:"文献出处ID"},{label:"套系栏目"},{label:"价格"},{label:"创建时间",isDdisabled:!0,NoNeed:!0}],referee:[{label:"标题",value:""},{label:"案号"},{label:"品类维度"},{label:"品类维度编号"},{label:"案件类别"},{label:"案件类别编号"},{label:"审理法院"},{label:"裁判来源ID"},{label:"裁判文献出处"},{label:"裁判文献出处ID"},{label:"套系栏目"},{label:"价格"},{label:"创建时间",isDdisabled:!0,NoNeed:!0}]}},methods:{getDetail:function(){var t=this;this.services.detailResource({id:this.detailData.id}).then(function(e){t.detailDataOwn=e.data,t.getMainList.forEach(function(t){for(var a in e.data)a!==t.label&&a!==t.name||(t.value=e.data[a])}),t.metadata=e.data.attributes||[]})},getMulu:function(t){var e=this;l.getBookCatalog({id:t}).then(function(t){var a=(0,s.recursionTree)(t.data,"pid","root");e.ml=a,e.currMulu=a})},handleClick:function(t,e){"ml"==t.name&&(this.currMulu=this.ml)},handleNodeClick:function(t,e,a){this.currMulu=e.data.children},muluSort:function(t,e,a){var i=this.currMulu;"up"===a?e>0&&(i.splice(e,1),i.splice(e-1,0,t)):(i.splice(e,1),i.splice(e+1,0,t)),l.siblingSort({id:t.id,sort:a})},submitDetail:function(){var t=d(i.default.mark(function t(e){var a,s,l=this;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.$refs.detailForm.valiAll()){t.next=3;break}return t.abrupt("return");case 3:if(a=this.$progress(),t.prev=4,!this.imgFile){t.next=8;break}return t.next=8,r.getTask(this.imgFile).then(function(t){l.detailDataOwn.img=t.data.path});case 8:return s={},this.getMainList.forEach(function(t){t.name?s[t.name]=t.value:s[t.label]=t.value}),t.next=12,this.services.save(n({id:this.detailData?this.detailData.id:null},s,{attributes:this.metadata,type:this.detailType,link_id:this.defaultData?this.defaultData.id:null}));case 12:this.$emit("detailBack"),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(4),t.t0;case 18:a.close();case 19:case"end":return t.stop()}},t,this,[[4,15]])}));return function(e){return t.apply(this,arguments)}}(),previewImg:function(t){var e=t.target.files[0];this.imgFile=e,this.previewImgUrl=URL.createObjectURL(e)},upLoadXml:function(){var t=d(i.default.mark(function t(){var e,a=this;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.file){t.next=5;break}return e=this.$progress(),t.next=4,r.getTask(this.file,{is_chunk:!0,size:1048576},function(t){e.percentage=t}).then(function(t){a.detailDataOwn.preview=t.data.path});case 4:e.close();case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),previewBook:function(t){var e=t.target.files[0];this.file=e,dir(e,"file")}},computed:{getMainList:function(){switch(Number(this.detailType)){case 1:return this.case;case 2:return this.statute;case 3:return this.viewpoint;case 4:return this.referee}}}}},395:function(t,e,a){},491:function(t,e,a){"use strict";a.r(e);var i=a(503),n=a(393);for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);a(492);var r=a(0),l=Object(r.a)(n.default,i.a,i.b,!1,null,"51535bf4",null);l.options.__file="detail.vue",e.default=l.exports},492:function(t,e,a){"use strict";var i=a(395);a.n(i).a},503:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"div"},[!t.readOnly&&t.detailReadOnly?a("el-button",{staticClass:"modifyBtn",attrs:{type:"primary",size:"small",plain:""},on:{click:function(e){t.detailReadOnly=!1}}},[t._v("修改")]):t._e(),a("el-tabs",{attrs:{value:t.type},on:{"tab-click":t.handleClick}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"info"}},[a("div",{staticClass:"div"},[a("VaForm",{ref:"detailForm"},[a("form",{ref:"detailForm",staticClass:"detailForm"},[a("fieldset",{attrs:{disabled:t.readOnly||t.detailReadOnly}},t._l(t.getMainList,function(e){return a("div",{staticClass:"group"},[a("div",{staticClass:"label"},[t._v("*"+t._s(e.label)+":")]),a("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{type:'required'}"},{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],staticClass:"form-control",attrs:{type:"text",maxlength:"20",disabled:e.isDdisabled&&e.value&&e.value.length>=10},domProps:{value:e.value},on:{input:function(a){a.target.composing||t.$set(e,"value",a.target.value)}}})])})),t.readOnly?t._e():a("div",{staticClass:"btns"},[a("el-button",{attrs:{ype:"info"},on:{click:function(e){t.$emit("update:detailDialog",!1)}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitDetail()}}},[t._v("确定")])],1)])])],1)]),a("el-tab-pane",{attrs:{label:"元数据",name:"data"}},[a("MetaData",{attrs:{metadata:t.metadata,readOnly:t.readOnly||t.detailReadOnly},on:{submit:function(e){t.submitDetail()},back:function(e){t.$emit("update:detailDialog",!1)}}})],1),a("el-tab-pane",{attrs:{label:"目录",name:"ml"}},[a("div",{staticClass:"muluWrap"},[a("div",{staticClass:"left"},[a("el-tree",{staticClass:"muluList",attrs:{data:t.ml,props:t.defaultProps,"node-key":"id"},on:{"node-click":t.handleNodeClick}})],1),a("div",{staticClass:"right"},[a("fieldset",{attrs:{disabled:t.readOnly||t.detailReadOnly}},[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{attrs:{width:"50"}},[t._v("序号")]),a("th",[t._v(" 名称")]),a("th",{attrs:{width:"110"}},[t._v(" 调序")])])]),a("tbody",t._l(t.currMulu,function(e,i){return a("tr",[a("th",{domProps:{textContent:t._s(i+1)}}),a("th",{staticClass:"th-name",domProps:{textContent:t._s(e.chapter_name)}}),a("th",[a("div",{staticClass:"div"},[a("el-button",{staticClass:"iconRotate up",attrs:{disabled:0==i,icon:"el-icon-back",size:"mini"},on:{click:function(a){0!=i&&t.muluSort(e,i,"up")}}}),a("el-button",{staticClass:"iconRotate down",attrs:{disabled:i+1==t.currMulu.length,icon:"el-icon-back",size:"mini"},on:{click:function(a){i+1!=t.currMulu.length&&t.muluSort(e,i,"down")}}})],1)])])}))])])])])])],1)],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},815:function(t,e,a){"use strict";a.r(e);var i=a(816),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,function(){return i[t]})}(s);e.default=n.a},816:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t},n=f(a(155)),s=f(a(154)),r=f(a(365)),l=f(a(491)),o=f(a(1104)),u=a(122),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}(a(1106)),d=a(582),p=f(a(376));function f(t){return t&&t.__esModule?t:{default:t}}e.default={components:{Menu:n.default,Top:s.default,GroupList:r.default,Dispense:p.default,Detail:l.default,AddResource:o.default},mixins:[u.main],data:function(){return{services:c,list:null,page:null,groupList:null,detailDialog:!1,detailDialogType:"info",detailData:null,publishDialog:!1,moveToOtherDiaolog:!1,moveIds:null,toId:null,addDialog:!1,options:[{name:"权威实务集刊",value:"0"},{name:"地方实务集刊",value:"1"}],detailType:null,resourceDate:null}},methods:{getList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.page&&this.page.num||1,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.page&&this.page.offset||10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.services.getList(i({pageNum:t,pageOffset:a,group_id:this.currGroup},n)).then(function(t){e.list=t.data,e.page=t.page})},openDetailDialogAdd:function(){this.addDialog=!0},saveok:function(t){this.getList(),this.getGroupList()},urgentDigital:function(){for(var t=this,e=this.$getChecked(),a=0,i=e.length;a<i;a++)for(var n=0,s=this.list.length;n<s;n++)if(this.list[n].id==e[a]&&1!=this.list[n].audits_status)return void this.$message.error("只能勾选待审核数据");e&&this.services.urgentDigital({id:e}).then(function(e){return t.$message.success("已提交加急审核")})},opnePublishDialog:function(t){this.detailData=t,this.publishDialog=!0},slecet:function(t,e){var a=this;(0,d.detailResource)({id:t[0].id}).then(function(t){a.addDialog=!1,a.detailType=e,a.detailData=null,a.detailDialog=!0,a.resourceDate=t.data})}}}},817:function(t,e,a){"use strict";a.r(e);var i=a(818),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,function(){return i[t]})}(s);e.default=n.a},818:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n=a(374),s=(i=n)&&i.__esModule?i:{default:i};e.default={props:["addDialog"],components:{SelResource:s.default},data:function(){return{resourceDialog:!1,types:[{name:"权威案例",value:"1"},{name:"法律法规",value:"2"},{name:"法律观点",value:"3"},{name:"裁判文书",value:"4"}],currentType:null}},methods:{selResource:function(){this.types.value?(this.currentType=this.types.value,this.resourceDialog=!0):this.$message.error("请选择类型")},addSelcet:function(t){this.curSoucesList=t,this.resourceDialog=!1,this.$emit("slecet",t,this.currentType)}}}},819:function(t,e,a){},820:function(t,e,a){}}]);