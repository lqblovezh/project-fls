(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{1098:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getAllInfo=void 0;var a,n,s=d(i(3));e.getAllInfo=(a=s.default.mark(function t(e){var i;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i={},t.next=3,h({id:e}).then(function(t){return t.data});case 3:return i=t.sent,t.next=6,(0,o.getList)({course_id:e}).then(function(t){return t.data});case 6:return i.course_period_list=t.sent,t.next=9,(0,l.getList)({id:e}).then(function(t){return t.data});case 9:return i.examination_paper_list=t.sent,t.next=12,v({id:e}).then(function(t){return t.data});case 12:return i.price=t.sent,t.abrupt("return",i);case 15:case"end":return t.stop()}},t,this)}),n=function(){var t=a.apply(this,arguments);return new Promise(function(e,i){return function a(n,s){try{var r=t[n](s),o=r.value}catch(t){return void i(t)}if(!r.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});e(o)}("next")})},function(t){return n.apply(this,arguments)});e.getList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_get)("/api/shared_course",t)},e.save=function(t){var e=t.id,i=function(t,e){var i={};for(var a in t)e.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(t,a)&&(i[a]=t[a]);return i}(t,["id"]);if(e)return(0,r.request_put)("/api/shared_course/"+e,i);return(0,r.request_post)("/api/shared_course",i).then(function(t){return(0,c.createProListener)({res_id:t.data.id,res_type:t.data.type_name,res_name:t.data.name,res_cover:t.data.img_src,res_covers:"",res_exp:t.data.abs,res_author:"",res_author_id:"",res_Interpreter:"",res_Interpreter_id:"",res_lables:"",res_money:"",res_isbn:"",res_isbn_ext:""}),t})},e.getInfo=h,e.del=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_post)("/api/shared_course/delete",t)},e.urgentDigital=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_put)("/api/shared_course/urgent",t)},e.audits=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_put)("/api/shared_course/audits",t)},e.getPrice=v,e.savePrice=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_post)("/api/shared_course/save_price",t)};var r=i(4),o=i(591),l=i(514),u=d(i(8)),c=(i(872),i(83));function d(t){return t&&t.__esModule?t:{default:t}}u.default.compile("/api/shared_course/:id/groups");var p=u.default.compile("/api/shared_course/:id"),f=u.default.compile("api/shared_course/setting_info/:id");function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_get)(p(t))}function v(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.request_get)(f(t))}},1099:function(t,e,i){"use strict";var a=i(805);i.n(a).a},1120:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"index clearfix"},[i("Top",{attrs:{currentPlant:"X-PUBLISH"}}),i("Menu"),i("div",{staticClass:"mainRight"},[i("div",{staticClass:"contentWrap"},[i("div",{staticClass:"contentLeft"},[i("div",{staticClass:"maindata"},[i("div",{staticClass:"serachWrap"},[i("div",{staticClass:"title"}),i("form",{staticClass:"clearfix",attrs:{id:"mainForm"}},[i("span",{staticClass:"group-inline"},[i("el-input",{attrs:{placeholder:"共享课程名称",name:"name",clearable:""}})],1),i("span",{staticClass:"group-inline"},[i("TimePick",{attrs:{inputsName:["start_time","end_time"]}})],1),i("span",{staticClass:"group-inline"},[i("select",{staticClass:"form-control",staticStyle:{width:"110px"},attrs:{placeholder:"状态",name:"status"}},[i("option",{attrs:{value:""}},[t._v("审核状态")]),t._l(t.status,function(e,a){return i("option",{domProps:{value:a}},[t._v(t._s(e))])})],2)]),i("span",{staticClass:"group-inline right"},[i("el-button",{attrs:{size:"mediu",type:"primary",icon:"el-icon-search",plain:""},on:{click:t.query}},[t._v("搜索")])],1)])]),i("div",{staticClass:"tableWrap"},[i("div",{staticClass:"tableTop"},[i("div",{staticClass:"title vel-line"},[i("span",[t._v("全部 "),t.page?i("span",{staticClass:"totalNum"},[t._v("("+t._s(t.page.total)+")")]):t._e()]),i("div",{staticClass:"btns"},[i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){t.audits()}}},[t._v("审核")]),i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:t.urgentDigital}},[t._v("加急审核")]),i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){t.delChoosen(!1)}}},[t._v("删除")])],1)])]),i("table",{staticClass:"table"},[i("thead",[i("tr",[i("th",{staticClass:"allBtn"},[i("input",{attrs:{type:"checkbox"},on:{click:function(e){t.checkAll(e)}}})]),i("th",[t._v("名称")]),i("th",[t._v("所属用户")]),i("th",{attrs:{width:"80"}},[t._v("审核状态")]),i("th",{attrs:{width:"70"}},[t._v("分发状态")]),i("th",{staticClass:"time"},[t._v("分发时间")]),i("th",{staticClass:"operate"},[t._v("操作")])])]),t.list?i("tbody",t._l(t.list,function(e){return i("tr",[i("td",[i("input",{ref:"ids",refInFor:!0,attrs:{type:"checkbox",name:"ids"},domProps:{value:e.id}})]),i("td",[i("img",{staticClass:"cover-photo",attrs:{src:e.img_src}}),i("div",{staticClass:"th-name bookName",attrs:{title:e.name}},[t._v(t._s(e.name))])]),i("td",[t._v(t._s(e.owner_name))]),i("td",{class:t.getColor(e.status)},[t._v(t._s(e.status))]),i("td",[t._v(t._s(e.release_status_name||"-"))]),i("td",[t._v(t._s(e.release_time||"-"))]),i("td",[i("div",{staticClass:"btns"},[i("span",{staticClass:"icon icon-detail",attrs:{size:"mini",title:"详情",type:"primary",plain:""},on:{click:function(i){t.opneDetailDialog("info",e)}}}),1!=e.audits_status?i("span",{staticClass:"icon icon-publish",attrs:{size:"mini",title:"审核",type:"primary",plain:""},on:{click:function(i){t.saveExamine("创建新版本",[e.id])}}}):t._e(),3==e.audits_status?i("span",{staticClass:"icon icon-fenfa",attrs:{size:"mini",title:"分发",type:"primary",plain:""},on:{click:function(i){t.opnePublishDialog(e)}}}):t._e(),1!=e.audits_status?i("span",{staticClass:"icon icon-delete",attrs:{size:"mini",title:"删除",type:"primary",plain:""},on:{click:function(i){t.delChoosen(e.id)}}}):t._e()])])])})):t._e()]),t.page?i("div",{staticClass:"pageWrap"},[i("el-pagination",{attrs:{small:!1,background:"","current-page":t.page.num,"page-sizes":[10,50,100],"page-size":t.page.offset,layout:"total, sizes,prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()])])])])]),i("div",{staticClass:"dialogs"},[i("Examine",{attrs:{examineDialog:t.examineDialog},on:{"update:examineDialog":function(e){t.examineDialog=e},saveExamine:t.saveExamine}}),t.publishDialog?i("Dispense",{attrs:{publishDialog:t.publishDialog,item:t.detailData},on:{"update:publishDialog":function(e){t.publishDialog=e},dispenseOk:t.dispenseOk}}):t._e(),i("el-dialog",{staticClass:"no-footer",attrs:{center:!1,visible:t.detailDialog,"close-on-click-modal":!1,top:"50px",width:"1200px"},on:{"update:visible":function(e){t.detailDialog=e}}},[i("div",{staticClass:"content",attrs:{slot:"title"},slot:"title"},[t.detailDialog?i("Detail",{attrs:{type:t.detailDialoaType,detailDialog:t.detailDialog,detailData:t.detailData,services:t.services,hourSever:t.hourSever,exerciseSever:t.exerciseSever,media:2,readOnly:t.readOnly},on:{saveok:t.saveOk,Knowledgeclick:t.KnowledgeClick,"update:detailDialog":function(e){t.detailDialog=e}}}):t._e()],1)])],1)],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},352:function(t,e,i){"use strict";i.r(e);var a=i(1120),n=i(803);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i(1099);var r=i(0),o=Object(r.a)(n.default,a.a,a.b,!1,null,"32abdfbc",null);o.options.__file="pubcourse.vue",e.default=o.exports},803:function(t,e,i){"use strict";i.r(e);var a=i(804),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);e.default=n.a},804:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=g(i(3)),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t},s=g(i(82)),r=g(i(376)),o=g(i(155)),l=g(i(154)),u=g(i(507)),c=g(i(403)),d=i(122),p=v(i(1098)),f=v(i(591)),h=v(i(514));function v(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function g(t){return t&&t.__esModule?t:{default:t}}e.default={mixins:[d.main],components:{Menu:o.default,Top:l.default,Detail:u.default,Dispense:r.default},data:function(){return{services:p,hourSever:f,exerciseSever:h,list:null,page:null,detailDialog:!1,detailDialoaType:"info",detailData:{},publishDialog:!1,status:c.default}},methods:{getList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.page&&this.page.num||1,e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.page&&this.page.offset||10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;p.getList(n({pageNum:t,pageOffset:i,group_id:this.currGroup},a)).then(function(t){e.list=t.data,e.page=t.page})},urgentDigital:function(){for(var t=this,e=this.getChecked(),i=0,a=e.length;i<a;i++)for(var n=0,s=this.list.length;n<s;n++)if(this.list[n].id==e[i]&&1!=this.list[n].audits_status)return void this.$message.error("只能勾选待审核数据");e&&this.services.urgentDigital({id:e}).then(function(e){return t.$message.success("已提交加急审核")})},opnePublishDialog:function(t){this.detailData=t,this.publishDialog=!0},delChoosens:function(t){var e=this,i=[];if(t)i.push(t);else{var a=Array.from(document.querySelectorAll('input[name="ids"]:checked'));if(a.forEach(function(t){i.push(t.value)}),!a.length)return void this.$message.error("请先选中!")}i.length>0&&this.$confirm("是否删除?").then(function(t){var a=(0,s.default)(document.querySelector("#mainForm"),{hash:!0});e.services.del({id:i}).then(function(t){e.getList(e.page.num,e.page.offset,a),e.getGroupList()}).catch(function(t){var i=t.payload;for(var a in i.messages){e.$message.error(i.messages[a]);break}})}).catch(function(t){})},KnowledgeClick:function(t){this.detailDialoaType=t},saveOk:function(t){this.detailData.id||(this.detailData=t),this.getList(),this.getGroupList()},clear:function(){document.getElementById("text").value=""},opneDetailDialog:function(){var t,e=(t=a.default.mark(function t(e,i){var n=this;return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.detailData={},!i){t.next=4;break}return t.next=4,p.getAllInfo(i.id).then(function(t){n.readOnly=!(!i||1!=i.audits_status),n.detailData=t});case 4:this.detailDialog=!0;case 5:case"end":return t.stop()}},t,this)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function a(n,s){try{var r=e[n](s),o=r.value}catch(t){return void i(t)}if(!r.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}("next")})});return function(t,i){return e.apply(this,arguments)}}()}}},805:function(t,e,i){}}]);