(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1178:function(e,t,r){"use strict";var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-dialog",{staticClass:"restBody",attrs:{center:!1,visible:this.readerDialog,top:"50px",width:"1000px","show-close":!1,"append-to-body":""}},[t("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[t("i",{staticClass:"el-icon-close",on:{click:this.colse}}),t("el-tabs",{attrs:{value:"reader"}},[t("el-tab-pane",{attrs:{label:this.title,name:"reader"}})],1)],1),t("div",{ref:"readerIframe",staticClass:"content"},[t("div",{attrs:{id:"readerIframe"}})]),t("div",{staticClass:"footer dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"info"},on:{click:this.colse}},[this._v("关闭")])],1)])],1)},a=[];r.d(t,"a",function(){return n}),r.d(t,"b",function(){return a})},407:function(e,t,r){"use strict";r.r(t);var n=r(1178),a=r(608);for(var o in a)"default"!==o&&function(e){r.d(t,e,function(){return a[e]})}(o);r(880);var i=r(0),u=Object(i.a)(a.default,n.a,n.b,!1,null,"5cbfcc79",null);u.options.__file="Reader.vue",t.default=u.exports},511:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(3));t.modifyNowledges=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,o=s(t,["id"]);return(0,a.request_put)(d({id:r}),o).then((i=u(n.default.mark(function t(r){return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y({id:o.pid,type:o.type});case 2:return e.abrupt("return",r);case 3:case"end":return e.stop()}},t,e)})),function(e){return i.apply(this,arguments)}));var i},t.deleteNowledges=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/api/nowledges/delete",t).then((r=u(n.default.mark(function r(a){return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y({id:t.pid,type:t.type});case 2:return e.abrupt("return",a);case 3:case"end":return e.stop()}},r,e)})),function(e){return r.apply(this,arguments)}));var r},t.addNowledges=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/api/nowledges",t).then((r=u(n.default.mark(function r(a){return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y({id:t.pid,type:t.type});case 2:return e.abrupt("return",a);case 3:case"end":return e.stop()}},r,e)})),function(e){return r.apply(this,arguments)}));var r},t.upNowledges=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_put)("/api/nowledges",e)},t.modifyGroup=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,o=s(t,["id"]);return(0,a.request_put)(p({id:r}),o).then((i=u(n.default.mark(function t(r){return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y({id:o.pid,type:o.type});case 2:return e.abrupt("return",r);case 3:case"end":return e.stop()}},t,e)})),function(e){return i.apply(this,arguments)}));var i},t.listGroup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_get)("/api/nowledges/groups",e)},t.deleteGroup=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/api/nowledges/groups/delete",t).then((r=u(n.default.mark(function r(a){return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y({id:t.pid,type:t.type});case 2:return e.abrupt("return",a);case 3:case"end":return e.stop()}},r,e)})),function(e){return r.apply(this,arguments)}));var r},t.addGroup=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/api/nowledges/groups",t).then((r=u(n.default.mark(function r(a){return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y({id:t.pid,type:t.type});case 2:return e.abrupt("return",a);case 3:case"end":return e.stop()}},r,e)})),function(e){return r.apply(this,arguments)}));var r},t.listNowledges=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=s(e,["id"]);return(0,a.request_get)(c({id:t}),r)},t.audioNowledges=_,t.searchNowledges=m,t.videoNowledges=b,t.NowledgesList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=s(e,["type"]);if("章节锚点"==t)return m(r);if("音频锚点"==t)return _(r);if("视频锚点"==t)return b(r)},t.listKnowledge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_get)("/api/nowledges",e)},t.addAnchor=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/api/nowledge_info",t).then((r=u(n.default.mark(function r(a){return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y({id:t.pid,type:t.ptype});case 2:return e.abrupt("return",a);case 3:case"end":return e.stop()}},r,e)})),function(e){return r.apply(this,arguments)}));var r},t.delAnchor=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/api/nowledge_info/delete",t).then((r=u(n.default.mark(function r(a){return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y({id:t.pid,type:t.type});case 2:return e.abrupt("return",a);case 3:case"end":return e.stop()}},r,e)})),function(e){return r.apply(this,arguments)}));var r},t.mount=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_post)("/api/nowledge_info/mount",e).then(function(t){var r=JSON.parse(window.localStorage.getItem("mounts"))||[],n=r.findIndex(function(t){return t.tid===e.id}),a={tid:e.id,id:t.data.id};n>-1&&r.splice(n,1),r.push(a),window.localStorage.setItem("mounts",JSON.stringify(r))})},t.nowledge_info=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_get)("/api/nowledge_info",e)},t.mountSchedule=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=(s(e,["id"]),arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){}),n=(JSON.parse(window.localStorage.getItem("mounts"))||[]).find(function(e){return e.tid===t});if(!n)return"";return(0,a.request_progress)(h({id:n.id}),r)},t.nowledge_btn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.request_get)("/api/nowledge_button",e)};var a=r(4),o=i(r(8));function i(e){return e&&e.__esModule?e:{default:e}}function u(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,o){try{var i=t[a](o),u=i.value}catch(e){return void r(e)}if(!i.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}function s(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}var d=o.default.compile("/api/nowledges/:id"),c=o.default.compile("/api/nowledges/book/:id"),p=o.default.compile("/api/nowledges/groups/:id"),l=o.default.compile("/api/nowledges/audio/:id"),f=o.default.compile("/api/nowledges/video/:id"),v=o.default.compile("/api/nowledges/book/catalogs/:id"),h=o.default.compile("/api/nowledge_info/:id"),g=o.default.compile("/api/nowledge_status/:id");function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=s(e,["id"]);return(0,a.request_get)(l({id:t}),r)}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=s(e,["id"]);return(0,a.request_get)(v({id:t}),r)}function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=s(e,["id"]);return(0,a.request_get)(f({id:t}),r)}function y(e){var t=e.id,r=e.type;return(0,a.request_get)(g({id:t}),{type:r})}},608:function(e,t,r){"use strict";r.r(t);var n=r(609),a=r.n(n);for(var o in n)"default"!==o&&function(e){r.d(t,e,function(){return n[e]})}(o);t.default=a.a},609:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(879)),o=r(511);t.default={props:{readerDialog:{type:Boolean,default:!1},title:{type:String,default:"阅读器"},readerId:{type:String,default:""},currId:{type:String,default:""},version:{type:String,default:"production"},markBtn:{type:String,default:""},detailData:Object},data:function(){return{}},created:function(){var e=this;this.$nextTick(function(){var t=new reader3.Desktop({markBtnText:e.markBtn,copyEnabled:!1,services:n({},a,{do_mark:e.do_mark}),labelEnabled:!1,bookmarkEnabled:!1,readModeList:[{title:"无",pageLayout:"normal",textLayout:"lr/static"},{title:"分页",pageLayout:"normal",textLayout:"lr/auto"}]});t.extraParams={version:e.version,content_version:e.version,access_code:e.access_code},t.mount(document.getElementById("readerIframe"),{bookId:e.readerId})})},methods:{colse:function(){this.$emit("update:readerDialog",!1)},do_mark:function(e){var t=this,r=e.bookId,n=e.rangeJSON,a=e.selectedText,i=e.chapterRid,u=e.chapterName,s=void 0===u?"":u;(0,o.addAnchor)({name:[s],range:n,point:a,n_id:this.currId,b_id:[i],c_id:[r],type:"内容锚点",pid:this.detailData.id,ptype:this.detailData.type_number}).then(function(e){t.$emit("addAnchorSuccess")}).catch(function(e){var r=e.payload;for(var n in r.messages){t.$message.error(r.messages[n]);break}})}}}},610:function(e,t,r){},879:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.get_book=function(e,t){var r=e.bookId,n=t.extraParams;return(0,o.request_post)(i+"/reader/books",a({book_id:r},n)).then(function(e){var t=e.data;return t})},t.get_catalogs=function(e,t){var r=e.bookId,n=e.chapterId,u=t.extraParams;return(0,o.request_post)(i+"/reader/catalogs",a({book_id:r,catalog_pid:n},u)).then(function(e){var t=e.data;return t})},t.get_chapters=function(e,t){var r=e.bookId,n=e.chapterIds,u=t.extraParams;return(0,o.request_post)(i+"/reader/chapters",a({chapter_id:n,book_id:r},u)).then(function(e){var t=e.data;return t})},t.search=function(e,t){var r=e.keyword,n=e.bookId,u=e.page,s=e.chapterRid,d=t.extraParams;return(0,o.request_post)(i+"/reader/search",a({keyword:r,book_id:n,chapter_id:s,pageStart:u.start,pageOffset:u.offset},d)).then(function(e){var t=e.data,r=e.page;return{list:t,page:r}})},t.get_labels=function(e,t){var r=e.bookId,n=t.extraParams;return(0,o.request_get)("/api/book_notes",{book_id:r,user_id:n.user_id}).then(function(e){var t=e.data;return t})},t.add_label=function(e,t){var r=e.bookId,n=e.chapterRid,i=e.chapterName,u=e.userText,s=e.rangeJSON,d=e.selectedText,c=e.status,p=t.extraParams;return(0,o.request_post)("/api/book_notes",a({book_id:r,chapter_id:n,chapter_name:i,chapter_value:d,comm_text:u,range:s,protected:c},p)).then(function(e){var t=e.data;return t})},t.get_bookmarks=function(e,t){var r=e.bookId,n=t.extraParams;return(0,o.request_get)("/api/book_marks",{book_id:r,user_id:n.user_id}).then(function(e){var t=e.data;return t})},t.add_bookmark=function(e,t){var r=e.bookId,n=e.chapterRid,i=e.chapterName,u=e.rangeJSON,s=e.text,d=t.extraParams;return(0,o.request_post)("/api/book_marks",a({book_id:r,chapter_id:n,chapter_name:i,chapter_value:s,range:u},d)).then(function(e){var t=e.data;return t})},t.remove_bookmarks=function(e,t){u(e,t)},t.remove_labels=function(e,t){u(e,t)},t.modify_label=function(e,t){t.extraParams;return e.range=JSON.stringify(e.range),e.comm_text=e.userText,delete e.userText,(0,o.request_put)("/api/book_notes",a({},e)).then(function(e){return e.data})},t.backup_setting=function(e){return(0,o.request_post)("/api/user_read_setting",{data:JSON.stringify(e)})},t.restore_setting=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,o.request_get)("/api/user_read_setting").then(function(e){var t=n(e.data,1),r=t[0];return r?JSON.parse(r):{}})},t.set_progress=function(e,t){var r=e.bookId,n=(e.chapterRid,e.progressJSON),a=e.percentJSON,i=t.extraParams;return(0,o.request_post)("/api/read_record",{data:n,proportion:a,release_id:i.release_id,book_id:r})},t.get_progress=function(e,t){var r=e.bookId,a=t.extraParams;return(0,o.request_get)("/api/read_record",{book_id:r,release_id:a.release_id}).then(function(e){var t=n(e.data,1),r=t[0];return r})};var o=r(4),i="publish"=="publish"?"/api":"/common/api";function u(e,t){var r=e.ids,n=t.extraParams;return(0,o.request_post)("/api/book_exegesis/delete",a({id:r},n)).then(function(e){return e.data})}},880:function(e,t,r){"use strict";var n=r(610);r.n(n).a}}]);