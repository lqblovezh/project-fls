(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{1159:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"index clearfix"},[a("Top",{attrs:{currentPlant:"X-PUBLISH"}}),a("Menu",{attrs:{curr:"/contentLibrary/digitalBook"}}),a("div",{staticClass:"mainRight"},[a("div",{staticClass:"contentWrap"},[a("div",{staticClass:"contentLeft"},[a("div",{staticClass:"maindata"},[a("div",{staticClass:"serachWrap",on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.query()}}},[a("div",{staticClass:"title"}),a("form",{attrs:{id:"mainForm"}},[a("span",{staticClass:"group-inline"},[a("el-input",{attrs:{placeholder:"请输入名称",name:"name",clearable:""}})],1),a("span",{staticClass:"group-inline"},[a("el-input",{attrs:{placeholder:"请输入标签",name:"author",clearable:""}})],1),a("span",{staticClass:"group-inline"},[a("TimePick",{attrs:{inputsName:["start_time","end_time"]}})],1),a("span",{staticClass:"group-inline"},[t.type?a("el-select",{attrs:{name:"status",placeholder:"类型",clearable:""},model:{value:t.type.value,callback:function(e){t.$set(t.type,"value",e)},expression:"type.value"}},t._l(t.type.list,function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})):t._e()],1),a("span",{staticClass:"group-inline float-right"},[a("el-button",{attrs:{size:"mediu",type:"primary",icon:"el-icon-search",plain:""},on:{click:t.query}},[t._v("搜索")]),a("el-button",{attrs:{size:"mediu",type:"primary",icon:"el-icon-plus"},on:{click:function(e){t.openDetailDialogAdd("xq",!0)}}},[t._v("新建重组")])],1)])]),a("div",{staticClass:"tableWrap"},[a("div",{staticClass:"tableTop"},[a("div",{staticClass:"title vel-line"},[a("span",[t._v("全部 "),t.page?a("span",{staticClass:"totalNum"},[t._v("("+t._s(t.page.total)+")")]):t._e()]),a("div",{staticClass:"btns"},[a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:t.moveToOther}},[t._v("移动分组")]),a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){t.delChoosen(!1)}}},[t._v("删除")])],1)])]),a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{staticClass:"allBtn"},[a("input",{attrs:{type:"checkbox"},on:{click:function(e){t.checkAll(e)}}})]),a("th",[t._v("名称")]),a("th",[t._v("标签")]),a("th",{staticClass:"time"},[t._v("创建时间")]),a("th",{staticClass:"operate"},[t._v("操作")])])]),t.list?a("tbody",t._l(t.list,function(e){return a("tr",[a("th",[a("input",{ref:"ids",refInFor:!0,attrs:{type:"checkbox",name:"ids"},domProps:{value:e.id}})]),a("th",[a("img",{staticClass:"cover-photo",attrs:{src:e.img_src}}),a("div",{staticClass:"th-name bookName",attrs:{title:e.name}},[t._v(t._s(e.name))])]),a("th",[a("div",{staticClass:"th-name",attrs:{title:e.tag}},[t._v(t._s(e.tag))])]),a("th",[a("div",{staticClass:"th-name"},[t._v(t._s(e.create_time))])]),a("th",[a("div",{staticClass:"btns"},[a("span",{staticClass:"icon icon-detail",attrs:{title:"详情",size:"mini",type:"primary",plain:""},on:{click:function(a){t.opneDetailDialog("xq",e)}}}),a("span",{staticClass:"icon icon-upload",attrs:{title:"发布到作品池",size:"mini",type:"primary",plain:""},on:{click:function(a){t.opnePublishDialog(e,"xq")}}}),a("span",{staticClass:"icon icon-delete",attrs:{title:"删除",size:"mini",type:"primary",plain:""},on:{click:function(a){t.delChoosen(e.id)}}})])])])})):t._e()]),t.page?a("div",{staticClass:"pageWrap"},[a("el-pagination",{attrs:{small:!1,background:"","current-page":t.page.num,"page-sizes":[10,50,100],"page-size":t.page.offset,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()]),a("div",{staticClass:"gruopList"},[a("GroupList",{attrs:{groupList:t.groupList,currGroup:t.currGroup},on:{addGroup:t.addGroup,updateGroup:t.updateGroup,delGroup:t.delGroup,groupChange:t.groupChange}})],1)])])])]),a("div",{staticClass:"dialogs"},[a("el-dialog",{attrs:{center:!1,visible:t.detailDialog,"close-on-click-modal":!1,top:"50px",width:"1000px"},on:{"update:visible":function(e){t.detailDialog=e}}},[a("div",{staticClass:"content",attrs:{slot:"title"},slot:"title"},[t.detailDialog?a("Detail",{attrs:{type:t.detailDialogType,detailDialog:t.detailDialog,detailData:t.detailData},on:{detailBack:t.detailBack,"update:detailDialog":function(e){t.detailDialog=e}}}):t._e()],1)]),t.publishDialog?a("el-dialog",{attrs:{center:!1,visible:t.publishDialog,"close-on-click-modal":!1,top:"50px",width:"1000px"},on:{"update:visible":function(e){t.publishDialog=e}}},[a("div",{staticClass:"content",attrs:{slot:"title"},slot:"title"},[t.publishDialog?a("ReleaseWork",{attrs:{type:t.detailDialogType,publishDialog:t.publishDialog,recomId:t.recomId},on:{detailBack:t.detailBack,"update:publishDialog":function(e){t.publishDialog=e}}}):t._e()],1)]):t._e(),a("el-dialog",{attrs:{center:!1,visible:t.moveToOtherDiaolog,"close-on-click-modal":!1,title:"移动分组",width:"500px"},on:{"update:visible":function(e){t.moveToOtherDiaolog=e}}},[a("span",{}),a("div",{staticClass:"group"},[a("div",{staticClass:"label"},[t._v("移动到")]),a("select",{ref:"moveToId",staticClass:"form-control",attrs:{placeholder:"请选择"}},t._l(t.groupList,function(e,i){return e.id!=t.currGroup&&""!=e.id?a("option",{domProps:{value:e.id,textContent:t._s(e.name)}}):t._e()}))]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.moveToSubmit}},[t._v(" 确定")]),a("el-button",{on:{click:function(e){t.moveToOtherDiaolog=!1}}},[t._v("返回")])],1)])],1)],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},1172:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"div"},[a("div",{staticClass:"dialogs"},[a("el-tabs",{attrs:{value:t.type},on:{"tab-click":t.handleClick}},[a("el-tab-pane",{attrs:{label:"发布到作品池",name:"xq"}},[a("div",{staticClass:"div"},[a("VaForm",{ref:"detailForm"},[a("form",{ref:"detailForm",staticClass:"detailForm"},[a("fieldset",{attrs:{disabled:t.detailReadOnly}},[a("div",{staticClass:"group"},[a("div",{staticClass:"label"},[t._v("*作品名称:")]),a("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"},{name:"model",rawName:"v-model",value:t.detailDataOwn.name,expression:"detailDataOwn.name"}],staticClass:"form-control",attrs:{type:"text",maxlength:"20"},domProps:{value:t.detailDataOwn.name},on:{input:function(e){e.target.composing||t.$set(t.detailDataOwn,"name",e.target.value)}}})]),a("div",{staticClass:"group"},[a("div",{staticClass:"label"},[t._v("*作品类型:")]),a("el-select",{attrs:{name:"type"},model:{value:t.workType.value,callback:function(e){t.$set(t.workType,"value",e)},expression:"workType.value"}},t._l(t.workType,function(t){return a("el-option",{key:t.value,attrs:{value:t.value,label:t.name}})}))],1)]),a("div",{staticClass:"btns"},[a("el-button",{attrs:{ype:"info"},on:{click:function(e){t.$emit("update:publishDialog",!1)}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitDetail("detailForm")}}},[t._v("发布")])],1)])])],1)])],1)],1)])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},1175:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[t.resourceDialog?a("Resource",{attrs:{type:t.currentType,resourceDialog:t.resourceDialog,curSoucesList:[],singleElection:t.isSingle},on:{"update:resourceDialog":function(e){t.resourceDialog=e},select:t.addSelcet}}):t._e(),a("div",{staticClass:"div"},[a("el-tabs",{attrs:{value:"ml"}},[a("el-tab-pane",{attrs:{label:"重组碎片",name:"ml"}},[a("VaForm",{ref:"detailForm"},[a("form",{ref:"detailForm",staticClass:"detailForm"},[a("fieldset",[a("div",{staticClass:"group"},[a("div",{staticClass:"label"},[t._v("*重组名称:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.recomDetailData.name,expression:"recomDetailData.name"}],staticClass:"form-control",attrs:{type:"text",maxlength:"20"},domProps:{value:t.recomDetailData.name},on:{input:function(e){e.target.composing||t.$set(t.recomDetailData,"name",e.target.value)}}})]),a("div",{staticClass:"group"},[a("div",{staticClass:"label"},[t._v("*标签:")]),a("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"},{name:"model",rawName:"v-model",value:t.recomDetailData.tag,expression:"recomDetailData.tag"}],staticClass:"form-control",attrs:{type:"text",maxlength:"10"},domProps:{value:t.recomDetailData.tag},on:{input:function(e){e.target.composing||t.$set(t.recomDetailData,"tag",e.target.value)}}})])])])]),a("div",{staticClass:"muluWrap"},[a("div",{staticClass:"left"},[a("div",{staticClass:"root"},[a("table",{ref:"table",staticClass:"table table1"},[a("thead",[a("tr",[a("th",[t._v(" 名称")]),a("th",[t._v(" 操作")])])])])]),a("el-tree",{ref:"tree",attrs:{data:t.ml,"node-key":"id","default-expand-all":"","highlight-current":!0,"expand-on-click-node":!1,draggable:"","allow-drop":t.allowDrop,"allow-drag":t.allowDrag},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node,n=e.data;return a("span",{staticClass:"custom-tree-node",on:{click:function(e){t.selectCurrent(i,n)}}},[a("input",{directives:[{name:"model",rawName:"v-model",value:n.chapter_name,expression:"data.chapter_name"}],staticClass:"form-control",domProps:{value:n.chapter_name},on:{input:function(e){e.target.composing||t.$set(n,"chapter_name",e.target.value)}}}),a("span",{staticClass:"options",staticStyle:{float:"right"}},[a("div",{staticClass:"icon el-icon-upload",attrs:{title:"导入"},on:{click:function(e){return e.stopPropagation(),t.Import(n)}}}),a("div",{staticClass:"icon el-icon-plus",attrs:{title:"添加"},on:{click:function(e){return e.stopPropagation(),t.append(n)}}}),a("div",{staticClass:"icon icon-delete",attrs:{title:"删除"},on:{click:function(e){return e.stopPropagation(),t.remove(i,n)}}})])])}}])}),a("div",{staticClass:"btn"},[a("el-button",{staticClass:"el-icon-plus",attrs:{type:"primary",plain:""},on:{click:function(e){t.renderContent()}}},[t._v("添加顶级")]),a("el-button",{staticClass:"el-icon-upload",attrs:{type:"primary",plain:""},on:{click:function(e){t.Import()}}},[t._v("导入顶级")])],1)],1),a("div",{staticClass:"right"},[a("fieldset",[a("table",{ref:"table",staticClass:"table"},[a("thead",[a("tr",[a("th",{attrs:{width:"50"}},[t._v(" 序号")]),a("th",[t._v(" 名称")]),a("th",[t._v(" 调序")]),a("th",{attrs:{width:"70"}},[t._v(" 操作")])])]),t.currMulu?a("tbody",{ref:"tbody",attrs:{id:"tbody"}},t._l(t.currMulu,function(e,i){return a("tr",{attrs:{id:"tr"}},[a("td",{attrs:{id:"number"}},[a("el-input",{domProps:{textContent:t._s(i+1)}})],1),a("td",{staticClass:"th-name",attrs:{id:"name"}},[a("span",{domProps:{textContent:t._s(e.name)}})]),a("td",{attrs:{id:"btns"}},[a("div",{ref:"btns",refInFor:!0,staticClass:"div"},[a("el-button",{staticClass:"iconRotate up",attrs:{icon:"el-icon-back",size:"mini",disabled:0==i},on:{click:function(a){0!=i&&t.muluSort(e,i,"up")}}}),a("el-button",{staticClass:"iconRotate down",attrs:{icon:"el-icon-back",size:"mini",disabled:i+1==t.currMulu.length},on:{click:function(a){i+1!=t.currMulu.length&&t.muluSort(e,i,"down")}}})],1)]),a("td",[a("div",{staticClass:"div"},[a("div",{staticClass:"icon icon-delete",attrs:{title:"删除"},on:{click:function(a){t.del(e)}}})])])])})):t._e()]),t.ml.length?a("div",{staticClass:"btn"},[a("el-button",{staticClass:"el-icon-plus",attrs:{type:"primary",plain:""},on:{click:function(e){t.addShow("9")}}},[t._v("添加内容")])],1):t._e()])]),a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"info"},on:{click:function(e){t.$emit("update:detailDialog",!1)}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitDetail()}}},[t._v("确定")])],1)])],1),a("el-tab-pane",{attrs:{label:"元数据",name:"data"}},[a("MetaData",{attrs:{metadata:t.metadata},on:{submit:t.submitDetail,back:function(e){t.$emit("update:detailDialog",!1)}}})],1)],1)],1)],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},333:function(t,e,a){"use strict";a.r(e);var i=a(1159),n=a(702);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a(936);var s=a(0),o=Object(s.a)(n.default,i.a,i.b,!1,null,"3ab799ef",null);o.options.__file="index.vue",e.default=o.exports},362:function(t,e,a){"use strict";a.r(e);var i=a(363),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e.default=n.a},363:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["groupList","currGroup"],data:function(){return{newGroupDialogOpen:!1,updateGroupDialogOpen:!1,currEditGroup:null}},created:function(){},computed:{},methods:{groupChange:function(t){this.$emit("groupChange",t)},addGroupDialog:function(){},delGroup:function(t){var e=this;this.$confirm("是否删除分组:"+t.name).then(function(a){dir(a),e.$emit("delGroup",t.id)}).catch(function(t){dir(t)})},updateGroupDialog:function(t){this.updateGroupDialogOpen=!0,this.currEditGroup=t},addGroup:function(){if(this.$refs.addGroupForm.valiAll()){var t=document.querySelector("#addGroupForm");this.$emit("addGroup",t),this.newGroupDialogOpen=!1}},updateGroup:function(){if(this.$refs.updateGroupForm.valiAll()){var t=document.querySelector("#updateGroupForm");this.$emit("updateGroup",t),this.updateGroupDialogOpen=!1}}}}},364:function(t,e,a){},365:function(t,e,a){"use strict";a.r(e);var i=a(370),n=a(362);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a(366);var s=a(0),o=Object(s.a)(n.default,i.a,i.b,!1,null,"176cd962",null);o.options.__file="GroupList.vue",e.default=o.exports},366:function(t,e,a){"use strict";var i=a(364);a.n(i).a},370:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"div"},[a("div",{staticClass:"groupWrap"},[a("div",{staticClass:"list"},[a("ul",t._l(t.groupList,function(e){return a("li",{staticClass:"licontent",class:{red:e.id==t.currGroup}},[a("div",{staticClass:"name ellipsis",attrs:{title:e.name+"("+e.num+")"},on:{click:function(a){t.groupChange(e.id)}}},[a("span",{staticClass:"title"},[t._v(t._s(e.name))]),a("span",[t._v(t._s("("+e.num+")"))])]),""!=e.id&&"non"!=e.id?a("div",{staticClass:"btns"},[a("span",{on:{click:function(a){t.updateGroupDialog(e)}}},[a("i",{staticClass:"el-icon-edit"})]),a("span",{on:{click:function(a){t.delGroup(e)}}},[a("i",{staticClass:"el-icon-delete"})])]):t._e()])}))]),a("div",{staticClass:"addGroupBtnWrap"},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.newGroupDialogOpen=!0}}},[a("i",{staticClass:"el-icon-plus"},[t._v("新建分组")])])],1)]),a("div",{staticClass:"dialogs"},[t.newGroupDialogOpen?a("el-dialog",{attrs:{title:"新增",visible:t.newGroupDialogOpen,width:"500px"},on:{"update:visible":function(e){t.newGroupDialogOpen=e}}},[a("div",{staticClass:"formWrap"},[a("VaForm",{ref:"addGroupForm"},[a("form",{attrs:{id:"addGroupForm"}},[a("div",{staticClass:"group"},[a("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"}],staticClass:"form-control",attrs:{name:"name"}})])])])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:function(e){t.newGroupDialogOpen=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addGroup}},[t._v("确定")])],1)]):t._e(),t.updateGroupDialogOpen?a("el-dialog",{attrs:{title:"修改",visible:t.updateGroupDialogOpen,width:"500px"},on:{"update:visible":function(e){t.updateGroupDialogOpen=e}}},[a("div",{staticClass:"formWrap"},[a("VaForm",{ref:"updateGroupForm"},[t.currEditGroup?a("form",{attrs:{id:"updateGroupForm"}},[a("div",{staticClass:"group"},[a("input",{directives:[{name:"va",rawName:"v-va",value:{type:"required"},expression:"{ type:'required' }"}],staticClass:"form-control",attrs:{name:"name"},domProps:{value:t.currEditGroup.name}}),a("input",{staticClass:"hide",attrs:{name:"id"},domProps:{value:t.currEditGroup.id}})])]):t._e()])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:function(e){t.updateGroupDialogOpen=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.updateGroup}},[t._v("确定")])],1)]):t._e()],1)])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},371:function(t,e,a){"use strict";a.r(e);var i=a(372),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e.default=n.a},372:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(a(3)),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t},r=a(379),s=o(a(82));function o(t){return t&&t.__esModule?t:{default:t}}function l(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}e.default={props:{resourceDialog:{type:Boolean,default:!1},singleElection:{type:Boolean,default:!0},type:{type:String,default:"1"},curSoucesList:{type:Array,default:[]},isShowType:{type:Boolean,default:!1},isShowSearch:Boolean,isShowResource:Boolean,isDebris:{default:!1},parameter:Object},data:function(){return{dataList:[],page:null,currentType:null,contentType:[{name:"电子书",value:"1"},{name:"图片",value:"3"},{name:"音频",value:"4"},{name:"视频",value:"5"},{name:"3D内容",value:"6"},{name:"VR",value:"7"},{name:"AR",value:"8"}],query:{}}},created:function(){this.currentType=this.type||"1",this.isShowResource&&this.contentType.push({name:"共享资源",value:"22"}),this.type.includes("20")&&(this.contentType=[{name:"权威案例",value:"20-1"},{name:"法律法规",value:"20-2"},{name:"法律观点",value:"20-3"},{name:"裁判文书",value:"20-4"}])},methods:{getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.page&&this.page.num||1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.page&&this.page.offset||10;(0,r._addBooks)(n({pageNum:e,pageOffset:a,type:this.currentType||this.type},this.parameter,this.query)).then(function(e){t.dataList=e.data||[],t.page=e.page})},colse:function(){this.$emit("update:resourceDialog",!1)},save:function(){var t=[];this.$refs.dispense.querySelectorAll("input[type=checkbox]:checked").forEach(function(e){t.push(e.value)}),t.length?this.$emit("dispenseSave",t):this.$message.error("请选择你要发布的平台")},search:function(){this.query=(0,s.default)(document.querySelector("#detailSearchForm"),{hash:!0}),this.getList(1,this.page.offset)},addSelection:function(){var t,e=(t=i.default.mark(function t(){var e,a,r,s,o,u,c,d,p,f=this;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.querySelector(".addBookForm"),a=e.querySelectorAll('input[name="ids"]:checked'),r=[],a.length){t.next=5;break}return t.abrupt("return",this.$message.warning("请选择添加内容"));case 5:s=!0,o=!1,u=void 0,t.prev=8,c=function(){var t=p.value;if(f.curSoucesList.findIndex(function(e){return e.id==t.value})>-1)return"continue";r.push(n({},f.dataList.find(function(e){return e.id==t.value}),{action:"add"}))},d=a[Symbol.iterator]();case 11:if(s=(p=d.next()).done){t.next=18;break}if("continue"!==c()){t.next=15;break}return t.abrupt("continue",15);case 15:s=!0,t.next=11;break;case 18:t.next=24;break;case 20:t.prev=20,t.t0=t.catch(8),o=!0,u=t.t0;case 24:t.prev=24,t.prev=25,!s&&d.return&&d.return();case 27:if(t.prev=27,!o){t.next=30;break}throw u;case 30:return t.finish(27);case 31:return t.finish(24);case 32:this.$emit("select",[].concat(r,l(this.curSoucesList)));case 33:case"end":return t.stop()}},t,this,[[8,20,24,32],[25,,27,31]])}),function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(n,r){try{var s=e[n](r),o=s.value}catch(t){return void a(t)}if(!s.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})});return function(){return e.apply(this,arguments)}}(),checkAll:function(t,e){var a=this;document.querySelector("."+e).querySelectorAll('input[name="ids"]').forEach(function(e,i){var r=a.curSoucesList.findIndex(function(t){return t.id==e.value||t.b_id==e.value});t.target.checked?-1==r&&a.curSoucesList.push(n({},a.dataList.find(function(t){return t.id==e.value}),{action:"add"})):a.curSoucesList.splice(r,1),e.checked=t.target.checked})},uncheckedAll:function(t,e){var a=this.curSoucesList.findIndex(function(t){return t.id==e.id||t.b_id==e.id});t.target.checked?-1==a&&this.curSoucesList.push(e):this.curSoucesList.splice(a,1),this.singleElection||(this.$refs.ids.forEach(function(t){return t.checked=!1}),t.target.checked=!0)},isChecked:function(t){return this.curSoucesList.findIndex(function(e){return e.id===t||e.b_id===t})>-1},handleSizeChange:function(t){this.query=(0,s.default)(document.querySelector("#detailSearchForm"),{hash:!0}),this.getList(1,t)},handleCurrentChange:function(t){this.query=(0,s.default)(document.querySelector("#detailSearchForm"),{hash:!0}),this.getList(t,this.page.offset)}},watch:{currentType:function(t){this.getList()}}}},373:function(t,e,a){},374:function(t,e,a){"use strict";a.r(e);var i=a(392),n=a(371);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a(389);var s=a(0),o=Object(s.a)(n.default,i.a,i.b,!1,null,"8d4001a2",null);o.options.__file="Resource.vue",e.default=o.exports},389:function(t,e,a){"use strict";var i=a(373);a.n(i).a},392:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{staticClass:"restBody2",attrs:{center:!1,visible:t.resourceDialog,width:"1200px",top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,"append-to-body":""},on:{"update:visible":function(e){t.resourceDialog=e}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"el-icon-close",on:{click:t.colse}}),a("el-tabs",{attrs:{value:"detail"}},[a("el-tab-pane",{attrs:{label:"添加",name:"detail"}})],1)],1),a("el-form",{staticClass:"addBookForm"},[t.isShowType?a("span",{staticClass:"group-inline",staticStyle:{margin:"20px","margin-top":"0"}},[a("el-radio-group",{model:{value:t.currentType,callback:function(e){t.currentType=e},expression:"currentType"}},t._l(t.contentType,function(e){return a("el-radio-button",{key:e.id,attrs:{label:e.value}},[t._v(t._s(e.name))])}))],1):t._e(),t.isShowSearch?t._e():a("div",{staticClass:"serachWrap"},[a("form",{attrs:{id:"detailSearchForm"}},[a("span",{staticClass:"group-inline"},[a("input",{staticClass:"form-control",attrs:{placeholder:"输入名称",name:"name"}})]),a("span",{staticClass:"group-inline"},[a("input",{staticClass:"form-control",attrs:{placeholder:"输入标签",name:"tag"}})]),a("span",{staticClass:"group-inline"},[a("TimePick",{attrs:{inputsName:["start_time","end_time"]}})],1),a("span",{staticClass:"group-inline right"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",plain:""},on:{click:t.search}},[t._v("搜索")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.addSelection}},[t._v("添加选中")])],1)])]),a("table",{staticClass:"table",attrs:{width:"100%"}},[a("thead",[a("tr",[a("th",{attrs:{width:"80"}},[t.singleElection?a("input",{attrs:{type:"checkbox"},on:{click:function(e){t.checkAll(e,"addBookForm")}}}):t._e(),a("span",{domProps:{textContent:t._s(t.singleElection?"全选":"选择")}})]),a("th",[t._v("名称")]),a("th",[t._v("标签")]),a("th",[t._v("类型")]),a("th",[t._v("创建时间")])])]),t.dataList.length?a("tbody",t._l(t.dataList,function(e,i){return a("tr",[a("td",[a("input",{ref:"ids",refInFor:!0,attrs:{type:"checkbox","data-type":e.status,name:"ids"},domProps:{value:e.id,checked:t.isChecked(e.id)},on:{click:function(a){t.uncheckedAll(a,e)}}})]),a("td",[t._v(t._s(e.name||e.title))]),a("td",[t._v(t._s(e.tag))]),a("td",[t._v(t._s(e.type_name))]),a("td",[t._v(t._s(e.create_time))])])})):a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"},attrs:{colspan:"5"}},[t._v("暂无数据")])])])]),t.page?a("div",{staticClass:"pageWrap"},[a("el-pagination",{attrs:{small:!1,background:"","current-page":t.page.num,"page-sizes":[10,50,100],"page-size":t.page.offset,layout:"total, sizes,prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"info"},on:{click:t.colse}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addSelection}},[t._v("确定")])],1)],1)],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},702:function(t,e,a){"use strict";a.r(e);var i=a(703),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e.default=n.a},703:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=v(a(3)),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t},r=v(a(82)),s=(m(a(20)),v(a(155))),o=v(a(154)),l=v(a(157)),u=v(a(407)),c=v(a(930)),d=v(a(365)),p=v(a(932)),f=a(122),h=m(a(709));function m(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}function v(t){return t&&t.__esModule?t:{default:t}}function g(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(n,r){try{var s=e[n](r),o=s.value}catch(t){return void a(t)}if(!s.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})}}e.default={components:{Menu:s.default,Top:o.default,Detail:p.default,GroupList:d.default,ReleaseWork:c.default,Reader:u.default,UploadAll:l.default},mixins:[f.main],data:function(){return{services:h,list:null,readerDialog:!1,readerId:"",page:null,recomId:null,groupList:null,uploadDialog:!1,detailDialog:!1,detailDialogType:"xq",detailData:null,timePick:null,imgLinkDialog:!1,publishDialog:!1,moveToOtherDiaolog:!1,moveIds:null,toId:null,fabuIds:[],recomResource:!1,type:{list:[{name:"全部",value:"0"},{name:"文本",value:"1"},{name:"图片",value:"2"}]},detailType:{list:[{name:"文本",value:"0"},{name:"图片",value:"1"}]}}},methods:{getList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.page&&this.page.num||1,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.page&&this.page.offset||10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.services.recomList(n({pageNum:t,pageOffset:a,group_id:this.currGroup},i)).then(function(t){e.list=t.data,e.page=t.page})},opneDetailDialog:function(t,e){this.detailData=e,this.detailDialogType=t,this.detailDialog=!0},openDetailDialogAdd:function(t){this.detailDialogType=t,this.detailDialog=!0,this.detailData=null,this.metadata=null},opnePublishDialog:function(t,e){this.recomId=t.id,this.publishDialog=!0,this.detailDialogType=e,this.metadata=null},delGroup:function(t){var e=this;log("删除分组",t),this.services.deleteGroup({id:t}).then(function(a){t===e.currGroup&&e.$router.push({path:e.$route.path,query:{id:"non"}}),e.getGroupList()})},saveok:function(t){this.getList(),this.getGroupList()},releaseBack:function(t){this.publishDialog=!1},openReader:function(t){this.readerId=t.id,this.readerDialog=!0},del:function(){var t=g(i.default.mark(function t(e){return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.services.deleteRecom(e));case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),delChoosen:function(){var t=g(i.default.mark(function t(e){var a,n,s=this;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=[],e){t.next=9;break}if((n=Array.from(document.querySelectorAll('input[name="ids"]:checked'))).forEach(function(t){a.push(t.value)}),n.length){t.next=7;break}return this.$message.error("请先选中!"),t.abrupt("return");case 7:t.next=10;break;case 9:a.push(e);case 10:a.length>0&&this.$confirm("是否删除?").then(function(t){(s.services.del?s.services.del:s.del)({id:a,confirm:"1"}).then(function(t){var e=(0,r.default)(document.querySelector("#mainForm"),{hash:!0}),i=s.page,n=i.total,o=i.start,l=i.num;n-a.length==o&&(s.page.num=o?l-1:1),void 0!==s.getList&&s.getList(s.page.num,s.page.offset,e),s.getGroupList()})}).catch(function(t){});case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),recomVis:function(){this.recomResource=!0},products:function(t){var e=this;this.services.products({id:t}).then(function(t){e.$message.success("生成成功!")}).catch(function(t){var a=t.payload;for(var i in a.messages){e.$message.error(a.messages[i]);break}})}}}},704:function(t,e,a){"use strict";a.r(e);var i=a(705),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e.default=n.a},705:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n=a(3),r=(i=n)&&i.__esModule?i:{default:i},s=(a(156),l(a(27)),a(122)),o=l(a(513));function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}e.default={props:["type","detailData","publishDialog","recomId"],created:function(){this.detailData&&this.getDetail()},mixins:[s.getIconStyle],data:function(){return{ml:null,currMulu:null,optional:Array,detailDataOwn:{},workType:[{name:"电子书",value:"1"},{name:"权威案例",value:"2"},{name:"法律法规",value:"3"},{name:"法律文献",value:"4"},{name:"裁判文书",value:"5"}]}},methods:{getDetail:function(){var t=this;o.detailDebris({id:this.detailData.id}).then(function(e){t.detailDataOwn=e.data,e.data.attributes||(e.data.attributes=[])})},handleClick:function(t,e){"ml"==t.name&&(this.currMulu=this.ml)},submitDetail:function(){var t,e=(t=r.default.mark(function t(e){return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.$refs.detailForm.valiAll()){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,o.publishWork({id:this.recomId,name:this.detailDataOwn.name,type:this.workType.value});case 5:this.$emit("detailBack"),this.$message.success("发布重组资源成功");case 7:case"end":return t.stop()}},t,this)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(n,r){try{var s=e[n](r),o=s.value}catch(t){return void a(t)}if(!s.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})});return function(t){return e.apply(this,arguments)}}(),submitMetadata:function(){}}}},706:function(t,e,a){},707:function(t,e,a){"use strict";a.r(e);var i=a(708),n=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);e.default=n.a},708:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(a(3)),n=(s(a(404)),o(a(374))),r=s(a(709));a(933);function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}function l(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}e.default={props:["detailDialog","detailData","type"],components:{Resource:n.default},data:function(){return{ml:[],resourceDialog:!1,id:1e4,metadata:[],currMulu:[],currChild:{},recomDetailData:{name:"",tag:"",catalogs:[]},currentType:null,isSingle:!1,defaultProps:{children:"children",chapters:"chapters",chapter_name:"chapter_name"}}},created:function(){this.detailData&&this.detailData.id&&this.getRecomDbris()},methods:{getRecomDbris:function(){var t=this;r.detailRecom({id:this.detailData.id}).then(function(e){t.recomDetailData=e.data,t.metadata=e.data.attributes,t.ml=e.data.catalogs,t.currMulu=e.data.catalogs[0]?e.data.catalogs[0].chapters:[]})},renderContent:function(){this.ml.push({chapters:[],children:[],chapter_name:""}),1==this.ml.length&&(this.ml[0].chapters=this.currMulu)},selectCurrent:function(t,e){this.currMulu=e.chapters},muluSort:function(t,e,a){var i=this.currMulu.findIndex(function(e){return e.id==t.id})||e,n="up"==a?-1:1,r=this.currMulu;r.splice.apply(r,[i,1].concat(l(r.splice(i+n,1,r[i]))))},submitDetail:function(){var t,e=(t=i.default.mark(function t(){var e,a,n,s,o=this;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=[].concat(l(this.ml)),e=this.filterDate(e),a={name:this.recomDetailData.name,tag:this.recomDetailData.tag,id:this.detailData?this.detailData.id:null,attributes:this.metadata,catalogs:e},t.prev=3,t.next=6,r.save(a).then(function(t){o.$emit("saveok",t.data)});case 6:this.$emit("detailBack"),t.next=19;break;case 9:t.prev=9,t.t0=t.catch(3),n=t.t0.payload,t.t1=i.default.keys(n.messages);case 13:if((t.t2=t.t1()).done){t.next=19;break}return s=t.t2.value,this.$message.error(n.messages[s]),t.abrupt("break",19);case 19:case"end":return t.stop()}},t,this,[[3,9]])}),function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function i(n,r){try{var s=e[n](r),o=s.value}catch(t){return void a(t)}if(!s.done)return Promise.resolve(o).then(function(t){i("next",t)},function(t){i("throw",t)});t(o)}("next")})});return function(){return e.apply(this,arguments)}}(),filterDate:function(t){var e=this;return t.forEach(function(t){t.chapters=t.chapters.map(function(t){return t.id}),t.children&&e.filterDate(t.children)}),t},append:function(t){t.children||this.$set(t,"children",[]),t.children.push({chapter_name:"",children:[],chapters:[]})},remove:function(t,e){var a=t.parent,i=a.data.children||a.data,n=i.findIndex(function(t){return t.id===e.id});i.splice(n,1)},addSelcet:function(t){var e=this;"9"==this.currentType?t.map(function(t){return e.currMulu.push(t)}):r.detailRecom({id:t[0].id}).then(function(t){e.currChild.chapter_name?e.currChild.children?t.data.catalogs.map(function(t){return e.currChild.children.push(t)}):e.$set(e.currChild,"children",t.data.catalogs):t.data.catalogs.map(function(t){return e.ml.push(t)})}),this.resourceDialog=!1},del:function(t){var e=this.currMulu.findIndex(function(e){return t.id===e.id});this.currMulu.splice(e,1)},allowDrop:function(t,e,a){return"二级 3-1"!==e.data.chapter_name||"inner"!==a},Import:function(t){this.currChild={},t&&(this.currChild=t),this.addShow()},allowDrag:function(t){return-1===t.data.chapter_name.indexOf("三级 3-2-2")},addShow:function(t){t?(this.currentType=t,this.isSingle=!0):(this.currentType="10",this.isSingle=!1),this.resourceDialog=!0}},watch:{ml:{handler:function(t,e){},immediate:!0,deep:!0}}}},710:function(t,e,a){},711:function(t,e,a){},930:function(t,e,a){"use strict";a.r(e);var i=a(1172),n=a(704);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a(931);var s=a(0),o=Object(s.a)(n.default,i.a,i.b,!1,null,"28924631",null);o.options.__file="releaseWork.vue",e.default=o.exports},931:function(t,e,a){"use strict";var i=a(706);a.n(i).a},932:function(t,e,a){"use strict";a.r(e);var i=a(1175),n=a(707);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);a(935);var s=a(0),o=Object(s.a)(n.default,i.a,i.b,!1,null,"81983e70",null);o.options.__file="detail.vue",e.default=o.exports},933:function(t,e,a){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function r(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new r(n.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new r(n.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},a(934),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,a(5))},934:function(t,e,a){(function(t,e){!function(t,a){"use strict";if(!t.setImmediate){var i,n,r,s,o,l=1,u={},c=!1,d=t.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(t);p=p&&p.setTimeout?p:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick(function(){h(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,a=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=a,e}}()?t.MessageChannel?((r=new MessageChannel).port1.onmessage=function(t){h(t.data)},i=function(t){r.port2.postMessage(t)}):d&&"onreadystatechange"in d.createElement("script")?(n=d.documentElement,i=function(t){var e=d.createElement("script");e.onreadystatechange=function(){h(t),e.onreadystatechange=null,n.removeChild(e),e=null},n.appendChild(e)}):i=function(t){setTimeout(h,0,t)}:(s="setImmediate$"+Math.random()+"$",o=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&h(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",o,!1):t.attachEvent("onmessage",o),i=function(e){t.postMessage(s+e,"*")}),p.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),a=0;a<e.length;a++)e[a]=arguments[a+1];var n={callback:t,args:e};return u[l]=n,i(l),l++},p.clearImmediate=f}function f(t){delete u[t]}function h(t){if(c)setTimeout(h,0,t);else{var e=u[t];if(e){c=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(a,i)}}(e)}finally{f(t),c=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,a(5),a(129))},935:function(t,e,a){"use strict";var i=a(710);a.n(i).a},936:function(t,e,a){"use strict";var i=a(711);a.n(i).a}}]);