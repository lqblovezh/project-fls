(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{1038:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetDefaultAudio=void 0;var n,r,a=c(i(15)),o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,r=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(i.push(o.value),!t||i.length!==t);n=!0);}catch(e){r=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw a}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.resetDefaultAudio=(n=a.default.mark(function e(t,i){var n=o(t,2),r=n[0],c=n[1],l=o(i,2),d=l[0],f=l[1];return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=4;break}return e.next=3,(0,s.getTask)(r,{is_chunk:!0,size:1048576});case 3:d=e.sent.data.path;case 4:if(!c){e.next=8;break}return e.next=7,(0,s.getTask)(c,{is_chunk:!0,size:1048576});case 7:f=e.sent.data.path;case 8:return e.abrupt("return",(0,u.request_post)("/api/audio_product",{preview:d,img:f}));case 9:case"end":return e.stop()}},e,this)}),r=function(){var e=n.apply(this,arguments);return new Promise(function(t,i){return function n(r,a){try{var o=e[r](a),u=o.value}catch(e){return void i(e)}if(!o.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});t(u)}("next")})},function(e,t){return r.apply(this,arguments)});t.getDefaultInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,u.request_get)("/api/audio_product/default_audio",e)};var u=i(48),s=(c(i(81)),i(82));function c(e){return e&&e.__esModule?e:{default:e}}},1039:function(e,t,i){"use strict";var n=i(536);i.n(n).a},1083:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mainRight"},[i("div",{staticClass:"contentWrap"},[i("div",{staticClass:"contentLeft"},[i("div",{staticClass:"maindata"},[i("div",{staticClass:"box"},[e._m(0),i("div",{staticClass:"AudioInfo"},[i("div",{staticClass:"videoAddr"},[i("p",[e._v("默认音频:")]),i("audio",{ref:"media",attrs:{src:e.previewMediaUrl,controls:""}})]),i("div",{staticClass:"select"},[i("el-button",{staticStyle:{"margin-top":"20px"},attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){e.$refs.meidaFile.click()}}},[e._v("音频上传")]),i("input",{ref:"meidaFile",staticClass:"hide",attrs:{type:"file",accept:e.mediaType&&"voice"==e.mediaType?e.$config.voiceAccept:e.$config.videoAccept},on:{change:e.previewMedia}})],1),i("div",{staticClass:"imgAddr"},[i("p",[e._v("默认封面:")]),i("img",{staticClass:"coverImg",attrs:{src:e.previewImgUrl}})]),i("div",{staticClass:"select"},[i("el-button",{staticStyle:{"margin-top":"20px"},attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){e.$refs.coverInput.click()}}},[e._v("图片上传")]),i("input",{ref:"coverInput",staticClass:"hide",attrs:{type:"file",accept:e.$config.imgAccept},on:{change:e.previewImg}}),i("div",{staticClass:"submit"},[i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){e.submit()}}},[e._v("确定")])],1)],1)])])])])])])},r=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tableWrap"},[t("div",{staticClass:"tableTop"},[t("div",{staticClass:"title vel-line"},[t("span",[this._v("默认音频(默认为用户打开任何音频是播放音频，建议上传出版社介绍音频)")])])])])}];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return r})},272:function(e,t,i){"use strict";i.r(t);var n=i(1083),r=i(534);for(var a in r)"default"!==a&&function(e){i.d(t,e,function(){return r[e]})}(a);i(1039);var o=i(0),u=Object(o.a)(r.default,n.a,n.b,!1,null,"448594fe",null);u.options.__file="index.vue",t.default=u.exports},328:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTask=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2];return e.size,e.size>=1048576?(t.is_chunk=!0,(0,n.request_post)("/common/api/files/upload_task?r="+Math.random(5)).then(function(r){if(r.status)return t.task_id=r.data.task_id,(0,n.request_file)("/common/api/files/upload",{file:e,data:t},i);throw new Error(r.messages)}).catch(function(e){throw new Error("上传失败")})):(t.is_chunk=!1,(0,n.request_file)("/common/api/files/upload",{file:e,data:t}))},t.getAppId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/common/api/app/search_name",e).then(function(e){return r.default.app_id=e.data.id,sessionStorage.app_id=e.data.id,e})},t.getClientToken=function(){return(0,n.request_post)("/common/api/auth/token/pcclient")},t.platInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)(u(e)).then(function(e){return r.default.app_id=e.data.id,sessionStorage.app_id=e.data.id,document.title=e.data.name,e})},t.commonPreview=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)(c(e))},t.commonPreviewCode=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/api/preview",e)},t.getQrcode=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/common/api/get_qrcode",e)},t.synchronization=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)(s(e)).then(function(e){return e})},t.getAuthor=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_get)("/api/ecommerce/author",e)},t.addAuthor=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.request_post)("/api/ecommerce/author",e)},t.getWeixinConfig=function(e){return(0,n.request_get)("/common/api/third/wx_js_sdk/config",e)};o(i(50));var n=i(48),r=o(i(51)),a=o(i(81));function o(e){return e&&e.__esModule?e:{default:e}}a.default.compile("/common/api/files/upload_task/:id"),a.default.compile("/common/api/manager/managers/:id"),a.default.compile("/common/api/manager/roles/:id");var u=a.default.compile("/common/api/app/apps/:id"),s=a.default.compile("/common/api/dragon_infos/:id");var c=a.default.compile("/api/preview/:id")},534:function(e,t,i){"use strict";i.r(t);var n=i(535),r=i.n(n);for(var a in n)"default"!==a&&function(e){i.d(t,e,function(){return n[e]})}(a);t.default=r.a},535:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(i(15)),r=(a(i(114)),i(1038));i(328);function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(r,a){try{var o=t[r](a),u=o.value}catch(e){return void i(e)}if(!o.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}("next")})}}t.default={data:function(){return{defaultAudioInfo:"",mediaFile:null,coverFile:null,previewImgUrl:null,previewMediaUrl:null,mediaType:"voice",mediaTypeName:"音频"}},mounted:function(){this.getAudioInfo()},methods:{getAudioInfo:function(){var e=o(n.default.mark(function e(){var t=this;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.getDefaultInfo)().then(function(e){t.previewImgUrl=e.data.img_src,t.previewMediaUrl=e.data.preview_src});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),previewImg:function(e){var t=e.target.files[0];this.coverFile=t,this.previewImgUrl=URL.createObjectURL(t)},previewMedia:function(e){var t=e.target.files[0];this.mediaFile=t,dir(t),this.previewMediaUrl=URL.createObjectURL(t)},submit:function(){var e=o(n.default.mark(function e(){return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,r.resetDefaultAudio)([this.mediaFile,this.coverFile],[this.previewMediaUrl,this.previewImgUrl]).then(function(e){return e.data.path});case 3:this.$message.success("媒体文件上传成功!"),e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(0),console.error(e.t0),this.$message.error("媒体文件上传失败!"),e.abrupt("return");case 11:case"end":return e.stop()}},e,this,[[0,6]])}));return function(){return e.apply(this,arguments)}}()}}},536:function(e,t,i){}}]);